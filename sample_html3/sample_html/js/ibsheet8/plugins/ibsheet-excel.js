/**
 * 제 품: IBSheet8 - Excel Plugin
 * 버 전: v1.0.2 (20230215-08)
 * 회 사: (주)아이비리더스
 * 주 소: https://www.ibsheet.com
 * 전 화: 1644-5615
 */
p6okS[367258]=(function(){var q1h=2;for(;q1h !== 9;){switch(q1h){case 1:return globalThis;break;case 5:var I7S;try{var v_K=2;for(;v_K !== 6;){switch(v_K){case 4:v_K=typeof n2TU4 === '\x75\u006e\x64\u0065\u0066\x69\x6e\u0065\x64'?3:9;break;case 3:throw "";v_K=9;break;case 9:delete I7S['\x6e\x32\u0054\u0055\x34'];var W9_=Object['\u0070\u0072\x6f\x74\u006f\x74\x79\u0070\x65'];delete W9_['\u004f\u005f\u0057\u005a\u004b'];v_K=6;break;case 2:Object['\x64\x65\u0066\x69\x6e\x65\x50\x72\x6f\u0070\x65\u0072\x74\x79'](Object['\u0070\x72\u006f\x74\u006f\x74\x79\x70\u0065'],'\x4f\x5f\u0057\x5a\u004b',{'\x67\x65\x74':function(){var J03=2;for(;J03 !== 1;){switch(J03){case 2:return this;break;}}},'\x63\x6f\x6e\x66\x69\x67\x75\x72\x61\x62\x6c\x65':true});I7S=O_WZK;I7S['\u006e\u0032\u0054\u0055\u0034']=I7S;v_K=4;break;}}}catch(k9T){I7S=window;}return I7S;break;case 2:q1h=typeof globalThis === '\u006f\x62\x6a\u0065\x63\u0074'?1:5;break;}}})();p6okS[86995]="gxU";p6okS[328090]=928;p6okS[161893]=p6okS[367258];p6okS[601214]=p6okS[367258];p6okS[175882]=485;p6okS[367258].O544=p6okS;p6okS[495996]=p6okS[367258];function p6okS(){}p6okS[573121]=p6okS[367258];p6okS[407507]=757;!(function(F,W){var d3h="directDown2Excel";var O3Y="<br>";var c9P="IBSheetLoadTextFrame";var f51="GetDown2TextConfig";var X_b=">";var U_v="getNextColA";var l7i="Append";var b2Z="down2Excel";var e0s=3;var R1F="Float";var p12="0";var d9K="GetColIndexInfo";var r8j="url";var Y94="GetLoadExcelUrl";var t2v="Color";var R9M="LoadFile";var h5Q="getLoadExcelConfig";var H_Q="_ConstWidth";var C7$="setDown2TextUrl";var f$d="SetLoadExcelUrl";var b0V="ibsheet";var J4P="GetHeaderBackColor";var n4n="iframe";var z30="fontTo";var h3t="EmptyChar";var Q1E="Header";var I$1="\r\n";var j95="display:none;";var y6A="";var H4w="xlsx";var J2y='="';var j9F="getDown2PdfUrl";var v$b="Format";var W8l="GetSumBackColor";var d9h="getRHeight";var h_i="Index";var R6I="{";var t7X="txt";var m5p="CumulateRow";var T83="loadExcelBuffer";var i42="GetDown2ExcelUrl";var R3U="setLoadTextUrl";var J9T="ExtendParam";var W7F="GetLoadTextConfig";var N8F="RecordFormat";var W36="StartRow";var l6e="getColName";var x$4='lang="ko"';var I2q="\n";var C4c="Sheet";var k3z="TEXT";var G2Y="getDown2TextUrl";var C65="csv";var s2l=2;var S0H="GetDataRowHeight";var u8D="Down2ExcelBuffer";var W_8="doSearchScript";var b3s="TitleAlign";var y6n="DirectDown2Excel";var w1l="LoadExcel";var u2L="#ffffff";var j$6=1024;var p0I="GetAutoSumPosition";var m4n="H";var v1Z="Down2Excel";var Y4d="pdf";var M3J="number";var U0T="IBSheetLoadExcelFileFinder";var c4D=".";var U4D="none";var A2s="0px";var h$0="HmFormat";var g_q="^";var J1T="GetExcelRowHeight";var P31="Panel";var a6N="message";var n9D="ExpandLeft";var q$Y=10;var x1W="Malgun Gothic";var A9f="setDown2ExcelUrl";var D60=5;var m_z="fileDownloadToken";var g2X="map";var E6L="_RowSpan";var n6c="=";var t1F="*";var H8F="OrgTextHidden";var e4z="down2Text";var o_F="HeaderRows";var N1D="Status";var Y_t="a";var A7c="StatusCol";var L2l="#800080";var U1$="Visible";var B5m="RecordType";var W_q="UnMatchColHidden";var i5X="get";var Y3Y="GetDown2HmlUrl";var y9e="?";var Q6a=/^\s+/;var Q6G="\t";var v88="#000000";var v11="Url";var O_p="downloadTokenValue";var F_s="setLoadExcelUrl";var E4o="<";var U$$="#808080";var H8v="DatePattern";var b$n="getDown2TextConfig";var B5N="FillRight";var N$H="left";var U8L="MdFormat";var g$B='<style type="text/css">* { font-family: ';var d4K=/^[^\<\{]*\{/;var g1K=0;var h_W=";";var P_a="SheetID";var v_1=16;var C_U="TitleText";var a1N="SetDown2ExcelUrl";var W0W="#ffff00";var m3h="attrs";var Y6D="DateStrictMode";var N2X="dir";var g2u="#c0c0c0";var Y9g="post";var q3X="Enum";var Q46="SheetWork=";var K9Y="YmFormat";var L1l="SEQ";var u5Y="LoadExcelBuffer";var W8Z="HmsFormat";var T6f="GetFirstColA";var B_b="GetDown2PdfUrl";var S9y="loadExcelError";var p3M="}";var T8d="width:0px;";var S5o="Filter";var i8p="class";var V$R="toLower";var F$s="setDown2ExcelConfig";var n0f="Int";var L7U="SubSum";var L2s="getFirstColA";var k12="SearchMode";var C5X="WorkbookPassword";var u6T="U";var p9D="onmessage";var d_k="GetSheetFontSize";var T9S=null;var b_q="getExcelRowHeight";var b3j="LoadText";var H8X="loadExcel";var u3l="Combo";var k9f="RecordTypes";var o1o="LegacyFormat";var x4x="Radio";var v8G="GetSheetFontName";var Q_u="BaseDir";var m_7="[object Array]";var k9L="html";var V7R="HML";var z8c="RecordOrgFormats";var E0d="GetRHeight";var z9y="-";var d6w="FileName";var u_j="InvalidTextFileExtension";var k5H="EnumKeys";var p7C="getHeaderBackColor";var n1q="DataFormat";var z$A="WordWrap";var r8a="div";var T85="getSumBackColor";var P8V="<br/>";var H$P="#";var z0e=4;var u87="includes";var l7A=" ";var J4s="Down2Text";var C2Q="loadFile";var l0F="#008080";var o9z="ColWidths";var A_D="[ibsheet-excel] undefined global object: IBSheet";var R2l="#00ff00";var W_e="Encoding";var d6K="SkipEmptyRow";var m9a="boolean";var E74="setLoadExcelConfig";var h_0="loadText";var O1U="SaveName";var n5F="/";var Q3V="setLoadTextConfig";var g3X="_GroupTree";var X2L="SaveNames";var W1U="&#160;";var w4_="LoadText.jsp";var F3l="IBSheetLoadTextFileFinder";var Y86="ibexcel";var g7w="DoSearchScript";var D7L="LoadExcelError";var H98="ColLength";var k$7="columnTag";var u7v="YmdHmsFormat";var O2B="ExceedFileSize";var I_E="IBSheetLoadExcelFrame";var N7A="//";var a_X="Link";var X_v=" !important }</style>";var i4N="getSheetFontName";var m2$="WorkSheetName";var p1z="Foot";var j7Q="SetLoadTextUrl";var S1L="getDataRowHeight";var p9d="Down2Hml";var y5Y="head";var L0K="Deli";var D5v="setDown2PdfUrl";var r4q="CutText";var s2L="YmdFormat";var M3Y="&";var w_F="isNumeric";var X4q="getColIndexInfo";var b6K="SetLoadTextConfig";var S2y="SetLoadExcelConfig";var W4i="GetOrgType";var M$c="getLoadTextConfig";var F9f="ColAlign";var k1Z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var e7V="CellHeader";var j_h="RecordFormats";var g$4=/\s+$/;var K0C="#0000ff";var J8N="Baekmuk Gulim";var F0U="GetColName";var q8b="#fffffe";var m$4="center";var v9M="OrgCol";var T_W="ANY";var a2W="directLoadExcel";var d0Q="C";var r7t="#ff0000";var U4e="isString";var G41="getDown2ExcelUrl";var b8x="undefined";var B4i=",";var S_V="setDown2TextConfig";var U2P="blob";var Q7S="SetDown2HmlUrl";var O7H="DownHeader";var g2s="HH:mm:ss";var m51="||";var E$J="GetDown2ExcelConfig";var p2C="GetDown2TextUrl";var f3X="POST";var u$L="down2ExcelBuffer";var F4u="YmdHmFormat";var a2f="RowSpan";var x9t="getLoadTextUrl";var l5l="RowHeights";var J0z="center|";var w77="forEach";var i1J="Mode";var d3o="file";function B(n){var a96="IBSheetOnLoadExcel";var t3P="\\$1";var x7V=/(Code( )?:)/;var W3K="IBSheetLoadFileSelect";var A3P="IBSheetLoadExcelError";var M3w="IBSheetOnLoadFullExcel";var Y44='"Message":';var n8S='"Code":';var Z1O=/(Result( )?:)/;var x1T="\\\\t";var s9l=/(Message( )?:)/;var t_N="UploadFile";var k7R="IBSheetLoadFileExtError";var O8p="IBSheetLoadExcelShowProcessDlg";var i2q=/(data( )?:( )?\[\[)/;var L4A='"Result":';var Q8G='"data":[[';try{var J,Z,K,Q=n.data.split(y6A),w=Q[g1K].split(g_q),z={};if(e0s == w.length && A3P == w[g1K])return (IBSheet[w[X2M]].LoadExcelError(JSON.parse(w[s2l])),!X2M);if(F[w[X2M]].HasLoadedExcelData)return !X2M;if((D60 == w.length && (Q[X2M]=F[w[X2M]].ConvertAscNumbertoChar(Q[X2M])),D60 == w.length && a96 == w[g1K]))return ((J=JSON.parse(Q[X2M].replace(Z1O,L4A).replace(x7V,n8S).replace(s9l,Y44).replace(i2q,Q8G).replace(/	/g,x1T).replace(/\\(n|'|"|&|r|t|b|f)?/g,t3P).replace(/([\u0000-\u0019]+)/g,N9A).replace(/([\u001A-\u001F]+)/g,N9A)).data).length && X2M === J.length && J[g1K].length && (J=J[g1K]),K=s2l == (Z=w[z0e].split(n6c)).length?IBSheet[w[X2M]]._getBooleanValue(Z[X2M],g1K):N9A,z.append=K,F[w[X2M]].CheckLoadExcel=w[e0s],void F[w[X2M]].loadSearchData({data:J,append:z.append}));(D60 == w.length && M3w == w[g1K] && (K=s2l == (Z=w[z0e].split(n6c)).length?IBSheet[w[X2M]]._getBooleanValue(Z[X2M],g1K):N9A,Q[X2M],z.type=w[e0s],z.append=K,z.dialogType=IBSheet[w[X2M]]._uploadDialogLoadType,IBSheet[w[X2M]].hideMessage(),IBSheet[w[X2M]].uploadDialogLoad && IBSheet[w[X2M]].uploadDialogLoad(Q[X2M],z)),X2M == w.length && (U0T == w[g1K] || F3l == w[g1K]?W.getElementById(w[g1K]).click():O8p == w[g1K] && this.showMessage(this.getMessage(t_N))),e0s == w.length && (W3K == w[g1K]?IBSheet.OnLoadFileSelect && IBSheet.OnLoadFileSelect(IBSheet[w[s2l]],w[X2M],Q[X2M]):k7R == w[g1K] && (C0Q == w[X2M]?IBSheet[w[s2l]].ShowAlert(IBSheet[w[s2l]].getMessage(C8M,i9V),u6T):k3z == w[X2M] && IBSheet[w[s2l]].ShowAlert(IBSheet[w[s2l]].getMessage(u_j,i9V),u6T))));}catch(Y){}}var i8B="float";var v8v="GetStatusValue";var G8D="SetDown2TextConfig";var G16="function";var c_$="UseDOM";var p9I="absolute";var o_5="getLoadExcelUrl";var V5n="IBSheetID";var n5R="1";var l39="SetDown2TextUrl";var X2M=1;var q$u="UserSaveName";var b50="ColLength2Byte";var R2U="getDown2HmlUrl";var g92="Img";var S_$="input";var w$c="LoadExcel.jsp";var D2n="DirectLoadExcel.jsp";var C8M="InvalidExcelFileExtension";var i33='"';var y3x=8;var d5r="Merge";var H6s="Down2Pdf";var E2O="ExportFile";var X0J="getSheetFontSize";var K45="extendParam";var j6f="ServerFile";var I8E="form";var i9K="ColumnMapping";var s38="object";var z6O="getAutoSumPosition";var s7M="#00ffff";var t1v="down2Hml";var L9d="Html";var H08=100;var M4P="GetLoadExcelConfig";var j9M="GetTheme";var I45="DelCheck";var i9V="Alert";var o44="getDown2ExcelConfig";var a93="#808000";var X8g="#ff00ff";var o2H="Text";var s2_="GetLoadTextUrl";var s3Y="StartCol";var Y1D="_Span";var v6d="isArray";var x6K="DateFormat";var X9j="CollapseLeft";var W0D="Type";var N6F="multipart/form-data";var W2f="MaxCols";var u3Q="keys";var I5p="Span";var O7m="return ";var y2_="1|";var K2V="getTheme";var Q9R=", ";var a64="#800000";var T5k="SetDown2ExcelConfig";var S$i="string";var b_V="1.0.2-20230215-08";var A1m="hidden";var M7Y="body";var Z3$="FormulaRow";var V1N="Date";var J_4="PDF";var z2s="EndRow";var B$k="HeaderMatch";var h3a="UseJsonAttribute";var e2b="set";var M12="HeaderText";var Q2c="className";var a9S="LegacyType";var N9A="";var S_A="down2Pdf";var O6H="WorkSheetNo";var D2H="DirectLoadExcel";var o5Q="Data";var Y46="#008000";var p_y="getStatusValue";var K9q="GetNextColA";var U0z="LoadExcelUrl";var Y9E="has";var R_2="#000080";var q$J="MB";var h5X="debugMode";var z8G="setDown2HmlUrl";var q41="Bool";var A$g="portrait";var Q1_="Background";var C0Q="EXCEL";var O0r="</";var J2s="SetDown2PdfUrl";var m3N="Pass";var x2V="|";var X1O="getOrgType";var t$7="gi";var L=F.IBSheet;if(T9S == L)throw new Error(A_D);var G,E,N,M,A=L.Plugins;(A.PluginVers || (A.PluginVers={}),A.PluginVers.ibexcel={name:Y86,version:b_V},G=k1Z,F.btoa=F.btoa || (function(s){var e9$=6;var B91=64;var l1Z=63;var a2w=/[^\x00-\xFF]/;var g15="InvalidCharacterError";var O1Z=15;s=String(s);var q,X,o,u,d=g1K,O=[];if(a2w.test(s))throw new Error(g15);for(;d < s.length;)(X=(e0s & (q=s.charCodeAt(d++))) << z0e | (u=s.charCodeAt(d++)) >> z0e,o=(O1Z & u) << s2l | (u=s.charCodeAt(d++)) >> e9$,u=l1Z & u,d === s.length + s2l?u=o=B91:d === s.length + X2M && (u=B91),O.push(G.charAt(q >> s2l),G.charAt(X),G.charAt(o),G.charAt(u)));return O.join(N9A);}),F.addEventListener?F.addEventListener(a6N,B,!X2M):F.attachEvent && F.attachEvent(p9D,B),A.GetFnLib=function(P){return L.__[P] || void g1K;},L.g_isDown2ExcelBuffer=!X2M,L.g_down2ExcelSheetID=[],L.g_down2ExcelBuffer=N9A,L.g_isDirectDown2Excel=!X2M,L.g_isLoadExcelBuffer=!X2M,L.g_isDirectLoadExcel=!X2M,L.g_targetExcelSheetID=N9A,L.g_LoadExcelSheetID=[],L.g_LoadExcelBuffer=[],L.g_LoadExcelBufferExt=N9A,L.g_targetTextSheetID=N9A,L.g_Multipart=!g1K,L._ibsUtil=(E={},N={transparent:u2L,black:v88,silver:g2u,gray:U$$,white:q8b,maroon:a64,red:r7t,purple:L2l,fuchsia:X8g,green:Y46,lime:R2l,olive:a93,yellow:W0W,navy:R_2,blue:K0C,teal:l0F,aqua:s7M},({init:function(){var M79="init";return ((this.elem.parent=this).delProperty(this,M79),this);},trim:function(V){return V=(V+=N9A).replace(Q6a,N9A).replace(g$4,N9A);},delProperty:function(h$,L8){try{delete h$[L8];}catch(g1){h$[L8]=void g1K;}},isEmpty:function(f0){return f0 || g1K === f0?g1K:X2M;},isZero:function(g3){return g1K !== g3 && p12 !== g3?g1K:X2M;},isNumberValue:function(V4){var F1=g1K;return (V4=this.trim(V4),this.isEmpty(V4)?F1=g1K:+V4 + N9A != V4 + N9A && isNaN(+V4) || (F1=X2M),F1);},getCacheGroup:function(b0){return (void g1K === E[b0] && (E[b0]={}),E[b0]);},getCache:function(w6,G7){var u3=N9A;return u3=this.isEmpty(w6) || this.isEmpty(G7)?u3:this.getCacheGroup(w6)[G7];},setCache:function(q7,F8,d$){this.isEmpty(q7) || this.isEmpty(F8) || this.isEmpty(d$) || (this.getCacheGroup(q7)[F8]=d$);},padLeft:function(H$,z2,v0){var G0=g1K,B0=N9A,x1=(B0=H$=this.isEmpty(H$)?N9A:H$ + N9A).length;if(this.isEmpty(v0))return H$;for((v0=(v0 + N9A).substring(g1K,X2M),G0=x1);G0 < z2;G0++)B0=v0 + B0;return B0;},padRight:function(u1,G_,m9){var R2=g1K,B6=N9A,U$=(B6=u1=this.isEmpty(u1)?N9A:u1 + N9A).length;if(this.isEmpty(m9))return u1;for((m9=(m9 + N9A).substring(g1K,X2M),R2=U$);R2 < G_;R2++)B6+=m9;return B6;},getWebColor:function(y4,j0){var Y8S=7;var J6w="WebColors";var T7=-X2M,i4=y4,Y0=g1K,l2=g1K,K1=g1K;return j0 && N9A === i4?N9A:void g1K !== (j0=this.getCache(J6w,y4))?j0:(i4=(i4 + N9A).toLowerCase(),N[i4]?T7=N[i4]:(g1K < i4.indexOf(B4i)?e0s <= (i4=(i4=i4.replace(/[^\d\,\-]/g,N9A)).split(B4i)).length && (Y0=+i4[g1K],l2=+i4[X2M],K1=+i4[s2l],T7=isNaN(Y0) || isNaN(l2) || isNaN(K1)?-X2M:(T7=H$P,(T7=(T7+=this.padLeft(Y0.toString(v_1),s2l,p12)) + this.padLeft(l2.toString(v_1),s2l,p12)) + this.padLeft(K1.toString(v_1),s2l,p12))):H$P === i4.charAt(g1K)?T7=i4:i4.search(/[^0-9a-f]/gi) < g1K && (T7=H$P + i4),-X2M !== T7 && z0e !== (j0=T7.length) && Y8S !== j0 && (T7=-X2M)),this.setCache(J6w,y4,T7),T7);},elem:{setValue:function(Q5,f2){void g1K !== Q5 && (void g1K !== Q5.value?Q5.value=f2:void g1K !== Q5.textContent?Q5.textContent=f2:Q5.innerText=f2);},select:function(i$){var h3Y=9999;i$ && (L.BIPAD && !L.BAndroid?i$.setSelectionRange(g1K,h3Y):i$.select());}},isArray:function(R$){return Array.isArray?Array.isArray(R$):m_7 === Object.prototype.toString.call(R$);},distinctArray:function(p8){var S1,i_=g1K,y1=N9A,g9={},A9=[];if(!this.isArray(p8))return p8;for((i_=g1K,S1=p8.length);i_ < S1;i_++)g9[y1=this.isArray(p8[i_])?p8[i_].join(g_q):p8[i_]] || (g9[y1]=X2M,A9.push(p8[i_]));return A9;},cloneArray:function(g4){var t7,s_=this.isArray(g4)?[]:{};for(t7 in g4)g4[t7] && s38 == typeof g4[t7]?s_[t7]=this.cloneArray(g4[t7]):s_[t7]=g4[t7];return s_;},getFullPath:function(a5){var Z3J="<a></a>";var W$=W.createElement(r8a);return (W$.innerHTML=Z3J,W$.firstChild.href=a5,W$.innerHTML=W$.innerHTML,W$.firstChild.href);},getDomain:function(){var P0=W.location,q1=N9A;return (q1+=P0.protocol + N7A) + P0.host;},escapeRegExp:function(a_){var Z1X="\\$&";var k_=N9A;return k_=this.isEmpty(a_)?k_:(a_ + N9A).replace(/[\^\$\.\*\+\?\=\!\:\|\\\/\(\)\[\]\{\}\/]/g,Z1X);},jsonStringify:function(H4){var h1Z='\\"';var T48="\\b";var C8y="\\f";var T1E="\\r";var V_x="\\\\";var I3s="\\t";var G_P="\\n";var c2,N$=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s6={"\b":T48,"\t":I3s,"\n":G_P,"\f":C8y,"\r":T1E,'"':h1Z,"\\":V_x};return (function W3(P3,S_){var a4A="[]";var o6k="{\n";var m0p=",\n";var f$C="[\n";var g7J="null";var E3F=":";var K5q=": ";function j_(l9){return (N$.lastIndex=g1K,N$.test(l9)?i33 + l9.replace(N$,function(h5){var p2k="\\u";var V82="0000";var A4=s6[h5];return S$i == typeof A4?A4:p2k + (V82 + h5.charCodeAt(g1K).toString(v_1)).slice(-z0e);}) + i33:i33 + l9 + i33);}var m3y="{}";var E2C="]";var Q2r="[";var B3,f6,q9,d1,A8,p2=c2,T4=S_[P3];switch(typeof (T4=T4 && s38 == typeof T4 && G16 == typeof T4.toJSON?T4.toJSON(P3):T4)){case S$i:return j_(T4);case M3J:return isFinite(T4)?String(T4):g7J;case m9a:case g7J:return String(T4);case s38:if(!T4)return g7J;if((c2+=void g1K,A8=[],m_7 === Object.prototype.toString.apply(T4))){for((d1=T4.length,B3=g1K);B3 < d1;B3+=X2M)A8[B3]=W3(B3,T4) || g7J;return (q9=g1K === A8.length?a4A:c2?f$C + c2 + A8.join(m0p + c2) + I2q + p2 + E2C:Q2r + A8.join(B4i) + E2C,c2=p2,q9);}for(f6 in T4)Object.prototype.hasOwnProperty.call(T4,f6) && (q9=W3(f6,T4)) && A8.push(j_(f6) + (c2?K5q:E3F) + q9);return (q9=g1K === A8.length?m3y:c2?o6k + c2 + A8.join(m0p + c2) + I2q + p2 + p3M:R6I + A8.join(B4i) + p3M,c2=p2,q9);}})(N9A,{"":H4});},toJson:function(b8){var Q3=T9S;if(S$i == typeof b8 && g1K <= b8.search(d4K))try{try{Q3=JSON.parse(b8);}catch(z$){Q3=(Q3=new Function(O7m + b8))();}}catch(k$){Q3=T9S;}else Q3=s38 == typeof b8?b8:T9S;return Q3;},toObject:function(c8){var y6Q=/\}[^\}]*$/;var x$=T9S;if(S$i == typeof c8 && g1K <= c8.search(d4K))try{x$=(x$=new Function(O7m + c8.replace(d4K,R6I).replace(y6Q,p3M)))();}catch(B$){x$=T9S;}else x$=s38 == typeof c8?c8:T9S;return x$;},exponentToNumberString:function(z6){var b6w="0.";var T0U=/[eE]/;var x2x=/^\-/;var y2=(z6 + N9A).split(T0U),R1=N9A,X$=N9A,g$=N9A;if(X2M == y2.length)return y2[g1K];if((z6=z6 < g1K?z9y:N9A,X$=y2[g1K].replace(c4D,N9A),(g$=+y2[X2M] + X2M) < g1K)){for(R1=z6 + b6w;g$++;)R1+=p12;return R1 + X$.replace(x2x,N9A);}for(g$-=X$.length;g$--;)R1+=p12;return X$ + R1;},getFileName:function(N0,J_){return N0=(N0 + N9A).indexOf(c4D) < g1K?N0 + c4D + J_:N0;},getTableBody:function(Z6){var j83="table";var L2X="tbody";var n$,B4,d3=T9S,q2=g1K;if(s38 != typeof Z6)return T9S;if(j83 !== Z6.tagName.toLowerCase())return Z6.firstChild;for((d3=(n$=Z6.getElementsByTagName(L2X))[g1K],q2=g1K,B4=n$.length);q2 < B4;q2++)if(g1K < n$[q2].childNodes.length){d3=n$[q2];break;}return d3;},removeHTMLTag:function(Q0,E8){if(T9S == Q0 || S$i != typeof Q0)return N9A;switch(E8){case X2M:return Q0.replace(/<([^>]*)>/gi,N9A);case s2l:return Q0.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*[^>]*)?(\s)*(\/)?>/gi,N9A);default:return Q0.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*=[^>]*)?(\s)*(\/)?>/gi,N9A);}},convert2ByteChar2:function(h0){var P4W=65248;var L33=65290;var S1P=65305;for(var w$=new String(),F_=h0.length,m1=g1K;m1 < F_;m1++){var d4=h0.charCodeAt(m1);w$+=L33 <= d4 && d4 <= S1P?String.fromCharCode(d4 - P4W):h0.charAt(m1);}return w$;},wrapUp:function(s7,C3){return C3 + s7 + C3;},getElementsByClassName:function(J2,H_){var y8v="( |$)";var K11="(^| )";if((H_=H_ || W).getElementsByClassName)return H_.getElementsByClassName(J2);if(H_.querySelectorAll)return H_.querySelectorAll(c4D + J2);for(var k4=new RegExp(K11 + J2 + y8v),w1=new Array(),v7=H_.body.getElementsByTagName(t1F),Z4=v7.length,z3=g1K;z3 < Z4;z3++)k4.test(v7[z3].className) && w1.push(v7[z3]);return (v7=T9S,w1);}}).init()),A.Down2Hml=function(b5){var o7S="Down2Hml.jsp";var a_r="landscape";var z0N="_IBSheet";var s3,Z9=this,K$=N9A,t$=N9A,Z1=m$4;return (this.showMessage(this.getMessage(E2O)),b5=L._ibsUtil.cloneArray(b5),s3=this.Down2HmlConfig || ({}),this._prepareExportSetting(),s38 == typeof b5.title && (t$=b5.title.text,Z1=b5.title.align),b5.title || s38 != typeof b5.Title || (t$=b5.Title.Text,Z1=b5.Title.Align),b5.docOrientation=this._getDefault(b5.docOrientation || b5.DocOrientation,s3.docOrientation || A$g),b5.downCols=this._getDefault(b5.downCols || b5.DownCols,s3.downCols || N9A),b5.downSum=this._getDefault(b5.downSum || b5.DownSum,s3.downSum || X2M),b5.extendParam=this._getDefault(b5.extendParam || b5.ExtendParam,s3.extendParam || N9A),b5.fileName=this._getDefault(b5.fileName || b5.FileName,s3.fileName || z0N),b5.titleAlign=this._getDefault(Z1,s3.titleAlign || m$4),b5.titleText=this._getDefault(t$,s3.titleText || N9A),a_r !== b5.docOrientation.toLowerCase() && (b5.docOrientation=A$g),b5.downTreeHide=!X2M,K$=void g1K !== this.Source.Down2Hml.Url?this.Source.Down2Hml.Url:o7S,this._getDown2Hml(b5,function(T3){Z9._sendDown(T3,K$,b5.extendParam,Y9g,X2M,V7R);}));},A.GetDown2HmlUrl=function(){var T0=N9A;return T0=this.Source.Down2Hml.Url?this.Source.Down2Hml.Url:T0;},A.SetDown2HmlUrl=function(K6){(this.Source.Down2Hml || (this.Source.Down2Hml={}),this.Source.Down2Hml.Url=K6);},A._getDown2Hml=function(n5,V6){var L_h="DocOrientation";var n_Y="hml";var a3,m_,e9,c$,s8,E4,L$=[],v9=[],r9=N9A,r_=N9A,c6=this,u_={};return g1K == (E4=(s8=this._getDownColNames(n5)).length)?(this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,V7R,!X2M),-X2M):(E4=this._getHeaderData(u_={from:V7R,cfg:n5,sheetDesign:g1K,isTreeLevel:g1K,isDownRows:g1K,isDownRowVisible:g1K,rowHeights:[],downColNames:s8,downColNamesLength:E4,data:L$,p:X2M,headerRows:g1K,isHeaderMerge:g1K}),u_.p=E4.p,E4.p,u_.headerRows=E4.headerRows,a3=E4.headerRows,(E4=this._getBodyData(u_)).p,L$=E4.data,v9=E4.rowHeights,E4=(u_=this._getColInfo(n5,s8,g1K)).type,s8=u_.format,m_=u_.orgFormat,c$=u_.width,e9=u_.align,u_=u_.datePattern,this.fileDownloadCheckToken=new Date().getTime(),L.fileDownloadCheckTimer=F.setInterval(function(){c6._getCookie(m_z) == c6.fileDownloadCheckToken && (c6.fileDownloadCheckToken=T9S,c6._finishDownload(V7R));},H08),r9+=this._makeColumnTag(O_p,this.fileDownloadCheckToken),(r_=location.href.substring(location.href.indexOf(N7A) + s2l).split(n5F))[g1K]=N9A,r_[r_.length - X2M]=N9A,r9=(r9=(r9=(r9=(r9=(r9=(r9=(r9=(r9=(r9=(r9=(r9=(r9=(r9=(r9+=this._makeColumnTag(Q_u,r_.join(n5F))) + this._makeColumnTag(d6w,L._ibsUtil.getFileName(n5.fileName,n_Y))) + this._makeColumnTag(J9T,n5.extendParam)) + this._makeColumnTag(o_F,a3)) + this._makeColumnTag(k9f,E4)) + this._makeColumnTag(j_h,s8)) + this._makeColumnTag(z8c,m_)) + this._makeColumnTag(H8v,u_)) + this._makeColumnTag(F9f,e9)) + this._makeColumnTag(o9z,c$)) + this._makeColumnTag(l5l,v9.join(x2V))) + this._makeColumnTag(C_U,n5.titleText.replace(/\r\n/g,this.IB_DELIMITER_TITLE_NEWLINE).replace(/\|/g,this.IB_DELIMITER_TITLE_BACKSLASH))) + this._makeColumnTag(b3s,n5.titleAlign.toLowerCase())) + this._makeColumnTag(L_h,n5.docOrientation.toLowerCase())) + this.IB_DELIMITER_ROW,L$[g1K]=r9,n5.debugMode || n5.DebugMode?(this.hideMessage(),L$.join(N9A)):void (G16 == typeof V6 && V6(L$.join(N9A))));},A.Down2Pdf=function(X7){var I91="converter";var I_a="unset";var s2A="wkhtmltopdf";var M81="clone";var U8D="itextpdf";X7=X7 || ({});var z5=this.GetFnLib(M81),Q7=this.GetFnLib(i5X),z0=this.GetFnLib(e2b),k6=this.GetFnLib(I_a),z5=z5(X7) || ({}),Q7=Q7(z5,I91) || U8D;return (k6(z5,I91),k6=s2A === Q7?this.GetWKHtml2PDF(z5):this.GetITextHtml2PDF(z5),z5.finish=k6,z0(X7=new Object(),Y4d,z5),this.doPrint(X7));},A.GetDown2PdfUrl=function(){var s2=N9A;return s2=this.Source.Down2Pdf.Url?this.Source.Down2Pdf.Url:s2;},A.GetITextHtml2PDF=function(C8){var U_7="mode";var g2$="wordWrap";var b8b="fileName";var z3L="extendParamMethod";var q7p="SendParam";var g3p="useXhr";var W4o="ExtendParamMethod";var a3i=50;function Q2(l5,g5,Q9){return s5(l5,g5)?L6(l5,g5):T9S != Q9?Q9:void g1K;}var X8U="dpi";var o4E="DownCols";var n$m="titleStyle";var V4r="ExtendParam]";var B3_="Paper";var a_3="DPI";var m1c="FontTo";var n$Z="TitleStyle";var d0J="UseXhr";var H8q="Title";var U5b="sendParam";var m1A="Dpi";var R7P="reqHeader";var O9z="ReqHeader";var E4J=2e3;var W1F="title";var V_A=32800;var a9I="downCols";var M2B="URL";var k58="paper";var v3=this,L6=this.GetFnLib(i5X),O6=this.GetFnLib(e2b),s5=this.GetFnLib(Y9E),N5=this.GetFnLib(w77),u7=this.GetFnLib(U4e),H8=this.GetFnLib(v6d),t0=this.GetFnLib(g2X),J3=this.GetFnLib(u87),h8=this.GetFnLib(u3Q),f1=this.GetFnLib(V$R);for(var D5=new Object(),H2=(v3._prepareExportSetting(),T9S == C8 && (C8={FileName:b0V,objReturn:X2M}),N5([[a9I,o4E],[U_7,i1J],[g2$,z$A],[k58,B3_],[b8b,d6w],[X8U,m1A,a_3],[z30,m1c],[W1F,H8q],[n$m,n$Z],[r8j,v11,M2B],[z3L,W4o],[K45,V4r],[g3p,d0J],[R7P,O9z],[U5b,q7p]],function(N4){for(var e8,a6=X2M;a6 < N4.length;a6+=X2M)(e8=N4[a6],s5(C8,e8) && (C8[N4[g1K]]=C8[e8]));}),s5(C8,h5X) && C8.debugMode),h7=(H2 && this.showMessage(this.getMessage(E2O)),s5(C8,U_7) || (C8.mode=g1K),s5(C8,a9I) || (C8.downCols=N9A),v3.getCols()),V9=v3._getDownColNames(C8),w5=g1K;w5 < h7.length;w5++){D5[h7[w5]]=!X2M;for(var X4=g1K;X4 < V9.length;X4++)if(h7[w5] === V9[X4]){D5[h7[w5]]=!g1K;break;}}function G$(P9){var K7=Q2(P9,m3h),S7=t0([N2X,[Q2c,i8p]],function(K3){u7(K3) && (K3=[K3,K3]);var h9=Q2(K7,K3[g1K]);return T9S == h9?N9A:(H8(h9) && (h9=h9.join(l7A)),K3[X2M] + J2y + h9 + i33);}),Z$=(function(){var X4E='style="font-family:';var m3=H3(W1F);if(T9S == m3)return N9A;var t8=H3(n$m,N9A);return w9(m3,r8a,[X4E + F4 + h_W + t8 + i33]) + P8V;})(),P9=Q2(P9,k9L,N9A);return w9(Z$+=P9=P9.length?P9.replace(new RegExp(O3Y,t$7),P8V).replace(new RegExp(W1U,t$7),l7A).replace(new RegExp(j95,t$7),T8d).replace(new RegExp(v3.Style + X9j,t$7),N9A).replace(new RegExp(v3.Style + n9D,t$7),N9A):P9,M7Y,S7);}O6(C8,a9I,D5);var N5=H3(g2$),N5=v3._getBooleanValue(N5,g1K),T8=(O6(C8,g2$,N5),v3.PdfWordWrap=N5?X2M:g1K,H3(b8b,b0V)),h6=E4J,i6=(s5(C8,X8U) && (h6=(h6=v3._getNumberValue(C8.dpi,h6)) < a3i?a3i:V_A < h6?V_A:h6),A$g),F4=(s5(C8,k58) && (i6=C8.paper?C8.paper.toLowerCase():A$g),J8N);s5(C8,z30) && (O6=F4,N5=(N5=H3(z30)) && f1(N5),h8=h8(f1={gulim:J8N,gothic:x1W}),F4=J3(h8,N5)?f1[N5]:O6);function H3(M6,N1){return Q2(C8,M6,N1);}function w9(Y_,w0,K5){return E4o + w0 + (K5=T9S != K5?l7A + (K5=H8(K5)?K5.join(l7A).replace(/\s+/g,l7A):K5):N9A) + X_b + Y_ + O0r + w0 + X_b;}return function(Z0){var I7W="Orientation";(H2 || v3.showMessage(v3.getMessage(E2O)),v3.fileDownloadCheckToken=new Date().getTime(),L.fileDownloadCheckTimer=setInterval(function(){v3._getCookie(m_z) == v3.fileDownloadCheckToken && (v3.fileDownloadCheckToken=T9S,v3._finishDownload(J_4));},H08));var e_=L._ibsUtil.getFileName,q$=v3._makeColumnTag,L0=t0([[O_p,v3.fileDownloadCheckToken],[d6w,e_(T8,Y4d)],[a_3,h6],[I7W,i6]],function(M1){return q$.apply(v3,M1);}),Z0=(L0+=v3.IB_DELIMITER_ROW,w9([(function(y5){return (y5=y5 || N9A,w9(y5+=g$B + F4 + X_v,y5Y));})(Z0.head || N9A),G$(Z0.body || T9S)].join(I2q),k9L,x$4)),L0=[L0,Z0].join(I2q);if(H2)return (v3.hideMessage(),L0);var Z0=H3(r8j,v3.Source.Down2Pdf.Url),F3=H3(K45,N9A),y6=H3(z3L,Y9g).toLowerCase(),O9=H3(g3p,!X2M),e_=e_(T8,Y4d),A3=H3(U5b,T9S),U_=H3(R7P,T9S);return v3._sendDown(L0,Z0,F3,y6,!g1K,J_4,H2,T9S,O9,e_,A3,U_);};},A.GetWKHtml2PDF=function(u6){var x9a="ibleaders/v8";var v$2="DebugMode";var p$k="https://api.ibleaders.com";var h0v="export/wkhtml2pdf.jsp";function n4(l_,t6,l6){return E4o + t6 + (l6=T9S != l6?l7A + (l6=c0(l6)?l6.join(l7A).replace(/\s+/g,l7A):l6):N9A) + X_b + l_ + O0r + t6 + X_b;}var W9=this,H7=h0v,t1=[p$k,x9a,H7].join(n5F),o3=b0V,M3=this.GetFnLib(i5X),n9=this.GetFnLib(e2b),d7=this.GetFnLib(Y9E),k3=this.GetFnLib(w77),B5=this.GetFnLib(U4e),c0=this.GetFnLib(v6d),R5=this.GetFnLib(g2X),Z2=this.GetFnLib(u87),A7=this.GetFnLib(u3Q),Q1=this.GetFnLib(V$R);(W9._prepareExportSetting(),d7(u6,h5X) || d7(u6,v$2));var q4,A6,n7=J8N;function o9(z8,H1,M7){return d7(z8,H1)?M3(z8,H1):T9S != M7?M7:void g1K;}function D_(E0,k2){return o9(u6,E0,k2);}d7(u6,z30) && (q4=n7,A6=(A6=D_(z30)) && Q1(A6),A7=A7(Q1={gulim:J8N,gothic:x1W}),n7=Z2(A7,A6)?Q1[A6]:q4);return function(l4){var o6A="PDFPageOrientation";var H2z="PrintMarginHeight";var O$J="PDFPageSize";var K9T="PrintMarginWidth";var W3R=/Down2Pdf\.jsp$/;var T3k="PDFName";var x6k=96;var s5v=40;var d0y="application/x-www-form-urlencoded";var o6v="File";var u1i="PrintDPI";var Y$Y="PDFFormat";var v5V="Content-Type";(W9.fileDownloadCheckToken=new Date().getTime(),L.fileDownloadCheckTimer=setInterval(function(){W9._getCookie(m_z) == W9.fileDownloadCheckToken && (W9.fileDownloadCheckToken=T9S,W9._finishDownload(J_4));},H08));var N6=D_(r8j),I2=(T9S == N6 && (N6=o9(W9.Source.Down2Pdf,v11,t1),W3R.test(N6) && (N6=N6.replace(W3R,H7))),D_(K45,{})),I9=(k3([{name:T3k,defaultValue:o3},{name:o6v,defaultValue:o3},{name:Y$Y,defaultValue:Y4d},{name:O$J,defaultValue:y3x},{name:o6A,defaultValue:g1K},{name:K9T,defaultValue:s5v},{name:H2z,defaultValue:s5v},{name:u1i,defaultValue:x6k}],function(c5){var R_=c5.name;d7(I2,R_) || n9(I2,R_,c5.defaultValue);}),n4([(l4.head,I9=N9A,n4(I9+=g$B + n7 + X_v,y5Y)),(function(G1){var Y6=o9(G1,m3h),W5=R5([N2X,[Q2c,i8p]],function(U1){B5(U1) && (U1=[U1,U1]);var K0=o9(Y6,U1[g1K]);return T9S == K0?N9A:(c0(K0) && (K0=K0.join(l7A)),U1[X2M] + J2y + K0 + i33);});return n4(G1=(G1=o9(G1,k9L,N9A)).length?G1.replace(new RegExp(O3Y,t$7),P8V).replace(new RegExp(W1U,t$7),l7A).replace(new RegExp(j95,t$7),T8d).replace(new RegExp(W9.Style + X9j,t$7),N9A).replace(new RegExp(W9.Style + n9D,t$7),N9A):G1,M7Y,W5);})(l4.body || T9S)].join(I2q),k9L,x$4)),U6=(I2.Data=I9,new XMLHttpRequest());(U6.open(Y9g.toUpperCase(),N6),U6.setRequestHeader(v5V,d0y),U6.responseType=U2P,U6.onload=function(){var F7Q=200;var r4Y=".pdf";var S6,C7;F7Q === U6.status && (S6=U6.response,(C7=W.createElement(Y_t)).href=F.URL.createObjectURL(S6),C7.download=I2.File + r4Y,C7.click());});try{U6.send((function(C5){var j8,C2=N9A;for(j8 in C5)C5.hasOwnProperty(j8) && (g1K < C2.length && (C2+=M3Y),C2+=encodeURI(j8 + n6c + C5[j8]));return C2;})(I2));}catch(Y8){}};},A.SetDown2PdfUrl=function(C1){(this.Source.Down2Pdf || (this.Source.Down2Pdf={}),this.Source.Down2Pdf.Url=C1);},A.DirectDown2Excel=function(f$){var I_=this.Down2Excel(f$,!g1K);if(f$ && f$.debugMode)return I_;},A.DirectLoadExcel=function(O4){return (L.g_isDirectLoadExcel=!g1K,this.LoadExcel(O4));},A.Down2Excel=function(T2,p9){var f7;if((L.g_isDown2ExcelBuffer5 || L.g_isDown2ExcelBuffer || this.showMessage(this.getMessage(E2O)),void g1K === T2 && (T2={}),L.g_isDown2ExcelBuffer || T2.debugMode))return (f7=this._delayedDown2Excel(T2,p9),T2.debugMode && this.hideMessage(),f7);setTimeout((function(){this._delayedDown2Excel(T2,p9);}).bind(this),H08);},A._delayedDown2Excel=function(V_,O0){var F6P="&lt";var U79="Down2Excel.jsp";var q6_="Excel";var q78="auto";var G61=/^\s*((http(s?))\:\/\/)/i;var k16="&gt";var a8z="-1";var v3E="Post";this._prepareExportSetting();var i3,u9,S3,X6,X9=N9A,O$=this,P6=N9A;if((L.g_isDirectDown2Excel=X2M == O0,L.g_down2ExcelBuffer || (L.g_down2ExcelSheetID=[]),L.g_down2ExcelSheetID.push(this.id),void g1K === (i3=L._ibsUtil.cloneArray(V_)) && (i3=[]),V_=this.Down2ExcelConfig,i3.downHeader=this._getDefault(void g1K !== i3.downHeader?i3.downHeader:i3.DownHeader,this._getDefault((V_=void g1K === V_?{}:V_).downHeader,!g1K)),i3.downSum=this._getDefault(void g1K !== i3.downSum?i3.downSum:i3.DownSum,this._getDefault(V_.downSum,!g1K)),i3.RequiredMark=this._getDefault((i3.RequiredMark,i3.RequiredMark),this._getDefault(V_.RequiredMark,!g1K)),i3.multipart=this._getDefault(void g1K !== i3.multipart?i3.multipart:i3.Multipart,this._getDefault(V_.multipart,!g1K)),i3.textToGeneral=this._getDefault(void g1K !== i3.textToGeneral?i3.textToGeneral:i3.TextToGeneral,this._getDefault(V_.textToGeneral,!g1K)),i3.wordWrap=this._getDefault(void g1K !== i3.wordWrap?i3.wordWrap:i3.WordWrap,this._getDefault(V_.wordWrap,!g1K)),i3.allTypeToText=this._getDefault(void g1K !== i3.allTypeToText?i3.allTypeToText:i3.AllTypeToText,this._getDefault(V_.allTypeToText,!X2M)),i3.appendPrevSheet=this._getDefault(void g1K !== i3.appendPrevSheet?i3.appendPrevSheet:i3.AppendPrevSheet,this._getDefault(V_.appendPrevSheet,!X2M)),i3.autoSizeColumn=this._getDefault(void g1K !== i3.autoSizeColumn?i3.autoSizeColumn:i3.AutoSizeColumn,this._getDefault(V_.autoSizeColumn,!X2M)),i3.checkBoxOffValue=this._getDefault(void g1K !== i3.checkBoxOffValue?i3.checkBoxOffValue:i3.CheckBoxOffValue,this._getDefault(V_.checkBoxOffValue,p12)),i3.checkBoxOnValue=this._getDefault(void g1K !== i3.checkBoxOnValue?i3.checkBoxOnValue:i3.CheckBoxOnValue,this._getDefault(V_.checkBoxOnValue,n5R)),i3.comboValidation=this._getDefault(void g1K !== i3.comboValidation?i3.comboValidation:i3.ComboValidation,this._getDefault(V_.comboValidation,!X2M)),i3.debugMode=this._getDefault(void g1K !== i3.debugMode?i3.debugMode:i3.DebugMode,this._getDefault(V_.debugMode,!X2M)),i3.downCols=this._getDefault(void g1K !== i3.downCols?i3.downCols:i3.DownCols,this._getDefault(V_.downCols,N9A)),i3.downCombo=this._getDefault(void g1K !== i3.downCombo?i3.downCombo:i3.DownCombo,this._getDefault(V_.downCombo,k3z)).toUpperCase(),i3.downRows=this._getDefault(void g1K !== i3.downRows?i3.downRows:i3.DownRows,this._getDefault(V_.downRows,N9A)),i3.downTreeHide=this._getDefault(void g1K !== i3.downTreeHide?i3.downTreeHide:i3.DownTreeHide,this._getDefault(V_.downTreeHide,!!this.ExcelTreeMode)),i3.excelFontSize=this._getDefault(void g1K !== i3.excelFontSize?i3.excelFontSize:i3.ExcelFontSize,this._getDefault(V_.excelFontSize,g1K)),i3.excelRowHeight=this._getDefault(void g1K !== i3.excelRowHeight?i3.excelRowHeight:i3.ExcelRowHeight,this._getDefault(V_.excelRowHeight,N9A)),i3.excludeSubSum=this._getDefault(void g1K !== i3.excludeSubSum?i3.excludeSubSum:i3.ExcludeSubSum,this._getDefault(V_.excludeSubSum,g1K)),i3.extendParam=this._getDefault(void g1K !== i3.extendParam?i3.extendParam:i3.ExtendParam,this._getDefault(V_.extendParam,N9A)),i3.extendParamMethod=this._getDefault(void g1K !== i3.extendParamMethod?i3.extendParamMethod:i3.ExtendParamMethod,this._getDefault(V_.extendParamMethod,N9A)),i3.fileName=this._getDefault(void g1K !== i3.fileName?i3.fileName:i3.FileName,this._getDefault(V_.fileName,q6_)),i3.hiddenColumn=this._getDefault(void g1K !== i3.hiddenColumn?i3.hiddenColumn:i3.HiddenColumn,this._getDefault(V_.hiddenColumn,!X2M)),i3.merge=this._getDefault(void g1K !== i3.merge?i3.merge:i3.Merge,this._getDefault(V_.merge,this.MultiRecord && X2M & this.MultiRecordShape?X2M:g1K)),i3.mode=this._getDefault(void g1K !== i3.mode?i3.mode:i3.Mode,p12),i3.numberFormatMode=this._getDefault(void g1K !== i3.numberFormatMode?i3.numberFormatMode:i3.NumberFormatMode,this._getDefault(V_.numberFormatMode,g1K)),i3.numberTypeToText=this._getDefault(void g1K !== i3.numberTypeToText?i3.numberTypeToText:i3.NumberTypeToText,this._getDefault(V_.numberTypeToText,!X2M)),i3.onlyHeaderMerge=this._getDefault(void g1K !== i3.onlyHeaderMerge?i3.onlyHeaderMerge:i3.OnlyHeaderMerge,this._getDefault(V_.onlyHeaderMerge,!X2M)),i3.reportXML=this._getDefault(void g1K !== i3.reportXML?i3.reportXML:i3.ReportXML,this._getDefault(V_.reportXML,N9A)),i3.reportXMLURL=this._getDefault(void g1K !== i3.reportXMLURL?i3.reportXMLURL:i3.ReportXMLURL,this._getDefault(V_.reportXMLURL,N9A)),i3.sheetDesign=this._getDefault(void g1K !== i3.sheetDesign?i3.sheetDesign:i3.SheetDesign,this._getDefault(V_.sheetDesign,X2M)),i3.sheetName=this._getDefault(void g1K !== i3.sheetName?i3.sheetName:i3.SheetName,this._getDefault(V_.sheetName,C4c)),i3.sheetNo=this._getDefault(void g1K !== i3.sheetNo?i3.sheetNo:i3.SheetNo,this._getDefault(V_.sheetNo,g1K)),i3.startCol=this._getDefault(void g1K !== i3.startCol?i3.startCol:i3.StartCol,this._getDefault(V_.startCol,g1K)),i3.startRow=this._getDefault(void g1K !== i3.startRow?i3.startRow:i3.StartRow,this._getDefault(V_.startRow,g1K)),i3.tempFile=this._getDefault(void g1K !== i3.tempFile?i3.tempFile:i3.TempFile,this._getDefault(V_.tempFile,N9A)),i3.titleAlign=this._getDefault(void g1K !== i3.titleAlign?i3.titleAlign:i3.TitleAlign,this._getDefault(V_.titleAlign,m$4)),i3.titleText=this._getDefault(void g1K !== i3.titleText?i3.titleText:i3.TitleText,this._getDefault(V_.titleText,N9A)),i3.treeLevel=this._getDefault(void g1K !== i3.treeLevel?i3.treeLevel:i3.TreeLevel,this._getDefault(V_.treeLevel,!X2M)),i3.url=this._getDefault(void g1K !== i3.url?i3.url:i3.URL,this._getDefault(V_.url,N9A)),i3.userMerge=this._getDefault(void g1K !== i3.userMerge?i3.userMerge:i3.UserMerge,this._getDefault(V_.userMerge,N9A)),i3.workbookPassword=this._getDefault(void g1K !== i3.workbookPassword?i3.workbookPassword:i3.WorkbookPassword,this._getDefault(V_.workbookPassword,N9A)),i3.numberExMode=this._getDefault(void g1K !== i3.numberExMode?i3.numberExMode:i3.NumberExMode,this._getDefault(V_.numberExMode,!X2M)),i3.useFormula=this._getDefault(void g1K !== i3.useFormula?i3.useFormula:i3.UseFormula,this._getDefault(V_.useFormula,!X2M)),i3.excelHeaderRowHeight=this._getDefault(void g1K !== i3.excelHeaderRowHeight?i3.excelHeaderRowHeight:i3.ExcelHeaderRowHeight,this._getDefault(V_.excelHeaderRowHeight,N9A)),i3.imageProcessType=this._getDefault(void g1K !== i3.imageProcessType?i3.imageProcessType:i3.ImageProcessType,this._getDefault(V_.imageProcessType,g1K)),i3.excludeFooterRow=this._getDefault(void g1K !== i3.excludeFooterRow?i3.excludeFooterRow:i3.ExcludeFooterRow,this._getDefault(V_.excludeFooterRow,!X2M)),i3.timeout=this._getDefault(void g1K !== i3.timeout?i3.timeout:i3.Timeout,this._getDefault(V_.timeout,g1K)),i3.useXhr=this._getDefault((i3.useXhr,i3.useXhr),this._getDefault(V_.useXhr,!X2M)),i3.reqHeader=i3.reqHeader || V_.reqHeader,i3.sendParam=i3.sendParam || V_.sendParam,i3.downRowSpan=i3.downRowSpan || g1K,void g1K === i3.header && (i3.header=V_.header),void g1K === i3.footer && (i3.footer=V_.footer),this._autoExcelModeCheck(i3,this.AutoExcelMode,C0Q,!g1K,O0)))return ((i3.tempFile || i3.TempFile) && (i3.sheetDesign=g1K),i3.sheetName=i3.sheetName.replace(/\//gi,N9A).replace(/\?/gi,N9A).replace(/\\/gi,N9A).replace(/\*/gi,N9A).replace(/\[/gi,N9A).replace(/\]/gi,N9A).replace(/\:/gi,N9A),N9A == i3.sheetName && (i3.sheetName=C4c),i3.reportXML?X9=i3.reportXML:N9A != i3.reportXMLURL && ((i3.reportXMLURL + N9A).toLowerCase().search(G61) < g1K && (i3.reportXMLURL=L._ibsUtil.getFullPath(i3.reportXMLURL)),S$i == typeof (V_=AjaxCall({Url:i3.reportXMLURL,Method:v3E})) && (X9=V_)),i3.reportXML=X9.replace(/\</gi,F6P).replace(/\>/gi,k16),q78 == (i3.excelRowHeight + N9A).toLowerCase() && (i3.excelRowHeight=a8z),N9A == i3.excelHeaderRowHeight?i3.excelHeaderRowHeight=i3.excelRowHeight:q78 == (i3.excelHeaderRowHeight + N9A).toLowerCase() && (i3.excelHeaderRowHeight=a8z),N9A != i3.downRows && i3.downTreeHide && (i3.downTreeHide=g1K),I$1 == i3.titleText.substring(i3.titleText.length - s2l) && (i3.titleText+=l7A),i3.downRows=x2V + i3.downRows + x2V,i3.merge=this._getNumberValue(i3.merge,g1K,g1K,g1K,s2l),m51 != (O0=i3.downCols) && (x2V == (O0=x2V == O0.substring(g1K,X2M)?O0.substring(X2M):O0).substring(O0.length - X2M) && (O0=O0.substring(g1K,O0.length - X2M)),i3.downCols=O0),X2M == L.g_isDirectDown2Excel?(i3.downSum=g1K,i3.onlyHeaderMerge=g1K,i3.treeLevel=g1K,L.g_DirectDownUrl=this.Source.DirectDown2Excel.Url):(void g1K !== this.Source.Down2Excel.Url && N9A != this.Source.Down2Excel.Url || (this.Source.Down2Excel.Url=U79),P6=this.Source.Down2Excel.Url),N9A != i3.url && (P6=i3.url,L.g_isDown2ExcelBuffer && (L.g_DirectDownUrl=P6)),u9=i3.extendParam,S3=i3.extendParamMethod,X6=L._ibsUtil.getFileName(i3.fileName,H4w),this.Down2ExcelBufferInfo.extendParam=u9,this.Down2ExcelBufferInfo.extendParamMethod=S3,this.Down2ExcelBufferInfo.timeout=i3.timeout,this.Down2ExcelBufferInfo.useXhr=i3.useXhr,this.Down2ExcelBufferInfo.fileName=X6,this.Down2ExcelBufferInfo.sendParam=i3.sendParam,this.Down2ExcelBufferInfo.reqHeader=i3.reqHeader,this._getDown2Excel(i3,function(k1){O$._sendDown(k1,P6,u9,S3,i3.multipart,C0Q,i3.debugMode,i3.timeout,i3.useXhr,X6,i3.sendParam,i3.reqHeader);}));void g1K === L.g_isDown2ExcelBuffer5 && setTimeout(function(){O$.hideMessage();},q$Y);},A.Down2ExcelBuffer=function(s4,N_){this._prepareExportSetting();var x7,e6=N9A,m8=this.IB_DELIMITER_SHEET.length,X5=this._autoExcelModeCheck(N9A,this.AutoExcelMode,C0Q,!g1K,!X2M,s4);if(X5)return s4?(L.g_isDown2ExcelBuffer=s4,this.showMessage(this.getMessage(E2O)),void (L.g_isDown2ExcelBufferQueue=!g1K)):!s4 && this.Source.Down2Excel && N9A != L.g_down2ExcelBuffer?(L.g_isDown2ExcelBuffer=s4,this.fileDownloadCheckToken=L.g_isDown2ExcelBufferToken,L.g_isDown2ExcelBufferToken=T9S,x7=this,L.fileDownloadCheckTimer=F.setInterval(function(){x7._getCookie(m_z) == x7.fileDownloadCheckToken && (x7.fileDownloadCheckToken=T9S,x7._finishDownload());},H08),e6=L.g_isDirectDown2Excel?L.g_DirectDownUrl:this.Source.Down2Excel.Url,this._sendDown(L.g_down2ExcelBuffer.substring(g1K,L.g_down2ExcelBuffer.length - m8),e6,this.Down2ExcelBufferInfo.extendParam,this.Down2ExcelBufferInfo.extendParamMethod,L.g_Multipart,C0Q,N_,this.Down2ExcelBufferInfo.timeout,this.Down2ExcelBufferInfo.useXhr,this.Down2ExcelBufferInfo.fileName,this.Down2ExcelBufferInfo.sendParam,this.Down2ExcelBufferInfo.reqHeader)):void g1K;},A.GetDown2ExcelConfig=function(){return this.Down2ExcelConfig || ({});},A.GetDown2ExcelUrl=function(){var n_=N9A;return n_=this.Source.Down2Excel.Url?this.Source.Down2Excel.Url:n_;},A.GetLoadExcelConfig=function(){return this.LoadExcelConfig || ({});},A.GetLoadExcelUrl=function(){var p7=N9A;return p7=this.Source.LoadExcel.Url?this.Source.LoadExcel.Url:p7;},A.LoadExcel=function(d5){var U50="FormatCellValue";this.LoadFileType=C0Q;var o7,A5,Y$,Y9,X_,j9,R3=(this.LoadExcelExecute=X2M) & this.MultiRecordShape,d5=(this.MultiRecordShape=g1K,this.HasLoadedExcelData && delete this.HasLoadedExcelData,this._prepareExportSetting(),L._ibsUtil.cloneArray(d5)),j2={},D6=N9A,B8=[],g0=N9A;if((L.g_targetExcelSheetID=this.id,L.g_isLoadExcelBuffer || (L.g_LoadExcelSheetID=[]),L.g_LoadExcelSheetID.push(this.id),void g1K !== this.LoadExcelConfig && (j2=this.LoadExcelConfig),(d5=void g1K === d5?[]:d5).append=this._getDefault(void g1K !== d5.append?d5.append:d5.Append,this._getDefault(j2.append,!X2M)),d5.columnMapping=this._getDefault(void g1K !== d5.columnMapping?d5.columnMapping:d5.ColumnMapping,this._getDefault(j2.columnMapping,N9A)),d5.debugMode=this._getDefault(void g1K !== d5.debugMode?d5.debugMode:d5.DebugMode,this._getDefault(j2.debugMode,!X2M)),d5.endRow=this._getDefault(void g1K !== d5.endRow?d5.endRow:d5.EndRow,this._getDefault(j2.endRow,g1K)),d5.extendParam=this._getDefault(void g1K !== d5.extendParam?d5.extendParam:d5.ExtendParam,this._getDefault(j2.extendParam,N9A)),d5.fileExt=this._getDefault(void g1K !== d5.fileExt?d5.fileExt:d5.FileExt,this._getDefault(j2.fileExt,N9A)),d5.maxFileSize=this._getDefault(void g1K !== d5.maxFileSize?d5.maxFileSize:d5.MaxFileSize,this._getDefault(j2.maxFileSize,g1K,i8B),i8B),d5.merge=this._getDefault(void g1K !== d5.merge?d5.merge:d5.Merge,this._getDefault(j2.merge,X2M)),d5.mode=this._getDefault(void g1K !== d5.mode?d5.mode:d5.Mode,this._getDefault(j2.mode,B$k)),d5.serverFile=this._getDefault(void g1K !== d5.serverFile?d5.serverFile:d5.ServerFile,this._getDefault(j2.serverFile,N9A)),d5.startCol=this._getDefault(void g1K !== d5.startCol?d5.startCol:d5.StartCol,this._getDefault(j2.startCol,X2M)),d5.startRow=this._getDefault(void g1K !== d5.startRow?d5.startRow:d5.StartRow,this._getDefault(j2.startRow,X2M)),d5.unMatchColHidden=this._getDefault(void g1K !== d5.unMatchColHidden?d5.unMatchColHidden:d5.UnMatchColHidden,this._getDefault(j2.unMatchColHidden,N9A)),d5.useDOM=this._getDefault(void g1K !== d5.useDOM?d5.useDOM:d5.UseDOM,this._getDefault(j2.useDOM,!X2M)),d5.workSheetName=this._getDefault(void g1K !== d5.workSheetName?d5.workSheetName:d5.WorkSheetName,this._getDefault(j2.workSheetName,N9A)),d5.workSheetNo=this._getDefault(void g1K !== d5.workSheetNo?d5.workSheetNo:d5.WorkSheetNo,this._getDefault(j2.workSheetNo,X2M)),d5.skipEmptyRow=this._getDefault(void g1K !== d5.skipEmptyRow?d5.skipEmptyRow:d5.SkipEmptyRow,this._getDefault(j2.skipEmptyRow,!g1K)),d5.useXhr=this._getDefault((d5.useXhr,d5.useXhr),this._getDefault(j2.useXhr,!X2M)),d5.reqHeader=d5.reqHeader || j2.reqHeader,d5.sendParam=d5.sendParam || j2.sendParam,d5.workbookPassword=this._getDefault((d5.workbookPassword,d5.workbookPassword),this._getDefault(j2.workbookPassword,N9A)),d5.formatCellValue=this._getDefault((d5.formatCellValue,d5.formatCellValue),this._getDefault(j2.formatCellValue,g1K)),this._uploadDialogLoadType=d5.dialogType || d5.DialogType,this._autoExcelModeCheck(d5,this.AutoExcelMode,C0Q,!X2M,!X2M)))return (this.GetLoadColNames(B8,d5),j2=this._getHeaderText(B8),o7=(j9=this._getColInfo(d5,B8,!X2M)).name,A5=j9.saveName,Y$=j9.type,Y9=j9.format,X_=j9.datePattern,dataFormat=j9.dataFormat,D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6=(D6+=this._makeColumnTag(Y6D,d5.DateStrictMode?X2M:g1K)) + this._makeColumnTag(l7i,d5.append?X2M:g1K)) + this._makeColumnTag(W_q,d5.unMatchColHidden)) + this._makeColumnTag(k12,this.SearchMode)) + this._makeColumnTag(J9T,d5.extendParam)) + this._makeColumnTag(W2f,B8.length)) + this._makeColumnTag(n1q,dataFormat)) + this._makeColumnTag(o_F,this.getHeaderRows().length)) + this._makeColumnTag(W36,d5.startRow)) + this._makeColumnTag(z2s,d5.endRow)) + this._makeColumnTag(s3Y,d5.startCol)) + this._makeColumnTag(O6H,d5.workSheetNo)) + this._makeColumnTag(m2$,d5.workSheetName)) + this._makeColumnTag(i1J,d5.mode.replace(/ /g,N9A).toUpperCase())) + this._makeColumnTag(A7c,void g1K !== this.StatusCol?this.StatusCol:N9A)) + this._makeColumnTag(i9K,d5.columnMapping)) + this._makeColumnTag(X2L,o7)) + this._makeColumnTag(q$u,A5)) + this._makeColumnTag(M12,j2)) + this._makeColumnTag(O1U,o7)) + this._makeColumnTag(B5m,Y$)) + this._makeColumnTag(N8F,Y9)) + this._makeColumnTag(H8v,X_)) + this._makeColumnTag(V5n,this.id)) + this._makeColumnTag(d5r,d5.merge)) + this._makeColumnTag(h3a,this.UseJsonAttribute)) + this._makeColumnTag(j6f,d5.serverFile)) + this._makeColumnTag(d6K,d5.skipEmptyRow?X2M:g1K)) + this._makeColumnTag(C5X,this._encodeBase64(d5.workbookPassword))) + (g1K < d5.formatCellValue?this._makeColumnTag(U50,d5.formatCellValue):N9A),g0=L.g_isDirectLoadExcel?this._getDefault(this.Source.DirectLoadExcel.Url,D2n):this._getDefault(this.Source.LoadExcel.Url,w$c),g0=L._ibsUtil.getFullPath(g0),D6+=this._makeColumnTag(U0z,g0),G16 != typeof F.postMessage && s38 != typeof F.postMessage || (D6+=this._makeColumnTag(P_a,this.id)),D6+=this._makeColumnTag(c_$,d5.useDOM?X2M:g1K),L.g_isLoadExcelBuffer?(L.g_LoadExcelBuffer.push(D6),L.g_LoadExcelBufferExt=d5.fileExt,L.g_LoadExcelBufferMaxFileSize=d5.maxFileSize,this.g_LoadExcelBufferCfg.useXhr=d5.useXhr,this.g_LoadExcelBufferCfg.sendParam=d5.sendParam,void (this.g_LoadExcelBufferCfg.reqHeader=d5.reqHeader)):d5.debugMode?D6:(d5.useXhr || d5.reqHeader && s38 == typeof d5.reqHeader?this._makeLoadXhr(C0Q,D6,d5.maxFileSize,d5.sendParam,d5.fileExt,d5.reqHeader):this._makeLoadForm(C0Q,L.g_isDirectLoadExcel,d5.fileExt,D6,d5.maxFileSize,d5.serverFile,d5.sendParam),void (R3 && (this.MultiRecordShape=R3))));},A.LoadExcelBuffer=function(b4,Y2){(this.HasLoadedExcelData && delete this.HasLoadedExcelData,this._prepareExportSetting());var b4=this._getBooleanValue(b4,g1K),u5=this.g_LoadExcelBufferCfg && this.g_LoadExcelBufferCfg.useXhr,d9=this.g_LoadExcelBufferCfg && this.g_LoadExcelBufferCfg.sendParam,V$=this.g_LoadExcelBufferCfg && this.g_LoadExcelBufferCfg.reqHeader;if(this._autoExcelModeCheck({},this.AutoExcelMode,C0Q,!X2M,!X2M,b4)){if((L.g_isLoadExcelBuffer=b4,Y2))return L.g_LoadExcelBuffer.join(this.IB_DELIMITER_SHEET);!b4 && g1K < L.g_LoadExcelBuffer.length?(u5 || V$ && s38 == typeof V$?this._makeLoadXhr(C0Q,L.g_LoadExcelBuffer.join(this.IB_DELIMITER_SHEET),L.g_LoadExcelBufferMaxFileSize,d9,L.g_LoadExcelBufferExt,V$,!g1K):this._makeLoadForm(C0Q,L.g_isDirectLoadExcel,L.g_LoadExcelBufferExt,L.g_LoadExcelBuffer.join(this.IB_DELIMITER_SHEET),L.g_LoadExcelBufferMaxFileSize),L.g_LoadExcelBuffer=[]):L.g_LoadExcelSheetID=[];}},A.LoadExcelError=function(X3){this._prepareExportSetting();var A_=g1K,S8=L.g_LoadExcelSheetID.length,U0=(this.getMessage(D7L,i9V),g1K),P8=N9A;if(!(S8 < X2M))for((void g1K !== X3 && (U0=X3.result || g1K,(P8=X3.message || N9A) && g1K),A_=g1K);A_ < S8;A_++)(L[L.g_LoadExcelSheetID[A_]].hideMessage(),L.OnImportFinish && L.OnImportFinish(this,this.LoadFileType,T9S,U0,P8));},A.SetDown2ExcelConfig=function(Y7){(this.Down2ExcelConfig=L._ibsUtil.cloneArray(Y7),void g1K !== this.Down2ExcelConfig.appendPrevSheet && (n5R === this.Down2ExcelConfig.appendPrevSheet?this.Down2ExcelConfig.appendPrevSheet=!g1K:p12 === this.Down2ExcelConfig.appendPrevSheet && (this.Down2ExcelConfig.appendPrevSheet=!X2M)),void g1K !== this.Down2ExcelConfig.autoSizeColumn && (n5R === this.Down2ExcelConfig.autoSizeColumn?this.Down2ExcelConfig.autoSizeColumn=!g1K:p12 === this.Down2ExcelConfig.autoSizeColumn && (this.Down2ExcelConfig.autoSizeColumn=!X2M)),void g1K !== this.Down2ExcelConfig.comboValidation && (n5R === this.Down2ExcelConfig.comboValidation?this.Down2ExcelConfig.comboValidation=!g1K:p12 === this.Down2ExcelConfig.comboValidation && (this.Down2ExcelConfig.comboValidation=!X2M)),void g1K !== this.Down2ExcelConfig.downHeader && (n5R === this.Down2ExcelConfig.downHeader?this.Down2ExcelConfig.downHeader=!g1K:p12 === this.Down2ExcelConfig.downHeader && (this.Down2ExcelConfig.downHeader=!X2M)),void g1K !== this.Down2ExcelConfig.downSum && (n5R === this.Down2ExcelConfig.downSum?this.Down2ExcelConfig.downSum=!g1K:p12 === this.Down2ExcelConfig.downSum && (this.Down2ExcelConfig.downSum=!X2M)),void g1K !== this.Down2ExcelConfig.hiddenColumn && (n5R === this.Down2ExcelConfig.hiddenColumn?this.Down2ExcelConfig.hiddenColumn=!g1K:p12 === this.Down2ExcelConfig.hiddenColumn && (this.Down2ExcelConfig.hiddenColumn=!X2M)),void g1K !== this.Down2ExcelConfig.RequiredMark && (n5R === this.Down2ExcelConfig.RequiredMark?this.Down2ExcelConfig.RequiredMark=!g1K:p12 === this.Down2ExcelConfig.RequiredMark && (this.Down2ExcelConfig.RequiredMark=!X2M)),void g1K !== this.Down2ExcelConfig.multipart && (n5R === this.Down2ExcelConfig.multipart?this.Down2ExcelConfig.multipart=!g1K:p12 === this.Down2ExcelConfig.multipart && (this.Down2ExcelConfig.multipart=!X2M)),void g1K !== this.Down2ExcelConfig.numberTypeToText && (n5R === this.Down2ExcelConfig.numberTypeToText?this.Down2ExcelConfig.numberTypeToText=!g1K:p12 === this.Down2ExcelConfig.numberTypeToText && (this.Down2ExcelConfig.numberTypeToText=!X2M)),void g1K !== this.Down2ExcelConfig.onlyHeaderMerge && (n5R === this.Down2ExcelConfig.onlyHeaderMerge?this.Down2ExcelConfig.onlyHeaderMerge=!g1K:p12 === this.Down2ExcelConfig.onlyHeaderMerge && (this.Down2ExcelConfig.onlyHeaderMerge=!X2M)),void g1K !== this.Down2ExcelConfig.textToGeneral && (n5R === this.Down2ExcelConfig.textToGeneral?this.Down2ExcelConfig.textToGeneral=!g1K:p12 === this.Down2ExcelConfig.textToGeneral && (this.Down2ExcelConfig.textToGeneral=!X2M)),void g1K !== this.Down2ExcelConfig.treeLevel && (n5R === this.Down2ExcelConfig.treeLevel?this.Down2ExcelConfig.treeLevel=!g1K:p12 === this.Down2ExcelConfig.treeLevel && (this.Down2ExcelConfig.treeLevel=!X2M)),void g1K !== this.Down2ExcelConfig.wordWrap && (n5R === this.Down2ExcelConfig.wordWrap?this.Down2ExcelConfig.wordWrap=!g1K:p12 === this.Down2ExcelConfig.wordWrap && (this.Down2ExcelConfig.wordWrap=!X2M)),void g1K !== this.Down2ExcelConfig.numberExMode && (n5R === this.Down2ExcelConfig.numberExMode?this.Down2ExcelConfig.numberExMode=!g1K:p12 === this.Down2ExcelConfig.numberExMode && (this.Down2ExcelConfig.numberExMode=!X2M)),void g1K !== this.Down2ExcelConfig.useFormula && (n5R === this.Down2ExcelConfig.useFormula?this.Down2ExcelConfig.useFormula=!g1K:p12 === this.Down2ExcelConfig.useFormula && (this.Down2ExcelConfig.useFormula=!X2M)),void g1K !== this.Down2ExcelConfig.excludeFooterRow && (n5R === this.Down2ExcelConfig.excludeFooterRow?this.Down2ExcelConfig.excludeFooterRow=!g1K:p12 === this.Down2ExcelConfig.excludeFooterRow && (this.Down2ExcelConfig.excludeFooterRow=!X2M)),void g1K !== this.Down2ExcelConfig.allTypeToText && (n5R === this.Down2ExcelConfig.allTypeToText?this.Down2ExcelConfig.allTypeToText=!g1K:p12 === this.Down2ExcelConfig.allTypeToText && (this.Down2ExcelConfig.allTypeToText=!X2M)),void g1K !== this.Down2ExcelConfig.downTreeHide && (n5R === this.Down2ExcelConfig.downTreeHide?this.Down2ExcelConfig.downTreeHide=!g1K:p12 === this.Down2ExcelConfig.downTreeHide && (this.Down2ExcelConfig.downTreeHide=!X2M)));},A.SetDown2ExcelUrl=function(b1){(this.Source.Down2Excel || (this.Source.Down2Excel={}),this.Source.Down2Excel.Url=b1);},A.SetLoadExcelConfig=function(G6){(this.LoadExcelConfig=L._ibsUtil.cloneArray(G6),void g1K !== this.LoadExcelConfig.append && (n5R === this.LoadExcelConfig.append?this.LoadExcelConfig.append=!g1K:p12 === this.LoadExcelConfig.append && (this.LoadExcelConfig.append=!X2M)),void g1K !== this.LoadExcelConfig.useDOM && (n5R === this.LoadExcelConfig.useDOM?this.LoadExcelConfig.useDOM=!g1K:p12 === this.LoadExcelConfig.useDOM && (this.LoadExcelConfig.useDOM=!X2M)),void g1K !== this.LoadExcelConfig.skipEmptyRow && (n5R === this.LoadExcelConfig.skipEmptyRow?this.LoadExcelConfig.skipEmptyRow=!g1K:p12 === this.LoadExcelConfig.skipEmptyRow && (this.LoadExcelConfig.skipEmptyRow=!X2M)));},A.SetLoadExcelUrl=function(i5){(this.Source.LoadExcel || (this.Source.LoadExcel={}),this.Source.LoadExcel.Url=i5);},A._addCellColor=function(V7,Q_,T$){var x5;if(!V7)return N9A;if((T$ && o5Q == Q_.Kind && Z3$ !== Q_.id && (this.Cols[T$].Background || this.Cols[T$].Color) && (x5=this.Cols[T$].Background || this.Cols[T$].Color),(Q_.Background || Q_.Color || Q_.Def && Q_.Def.Color) && (x5=Q_.Background || Q_.Color || Q_.Def && Q_.Def.Color),(Q_[T$ + Q1_] || Q_[T$ + t2v]) && (x5=Q_[T$ + Q1_] || Q_[T$ + t2v]),Z3$ === Q_.id && void g1K === x5 && (x5=this.GetSumBackColor(T$)),(x5=o5Q == Q_.Kind && L7U === Q_.Name?Q_.Background || Q_.Color || Q_.Def.Color:x5) && -X2M !== x5)){if(-X2M < (x5+=N9A).indexOf(H$P))e0s == (x5=x5.replace(H$P,N9A)).length && (r=x5.substr(g1K,X2M),g=x5.substr(X2M,X2M),b=x5.substr(s2l,X2M),x5=r + r + g + g + b + b);else {if(-X2M == (x5=L._ibsUtil.getWebColor(x5)))return N9A;-X2M < x5.indexOf(H$P) && (x5=x5.replace(H$P,N9A));}return (this._addExcelPaletteList(x5),this.IB_DELIMITER_COLOR + x5);}return N9A;},A._addCellFontColor=function(F7,x0,L5){var o0g="TextColor";var T5;if(!F7)return N9A;if((L5 && o5Q == x0.Kind && Z3$ != x0.id && this.Cols[L5].TextColor && (T5=this.Cols[L5].TextColor),(x0.TextColor || x0.Def && x0.Def.TextColor) && (T5=x0.TextColor || x0.Def && x0.Def.TextColor),(T5=x0[L5 + o0g]?x0[L5 + o0g]:T5) && -X2M !== T5)){if(-X2M < (T5+=N9A).indexOf(H$P))e0s == (T5=T5.replace(H$P,N9A)).length && (r=T5.substr(g1K,X2M),g=T5.substr(X2M,X2M),b=T5.substr(s2l,X2M),T5=r + r + g + g + b + b);else {if(-X2M == (T5=L._ibsUtil.getWebColor(T5)))return N9A;-X2M < T5.indexOf(H$P) && (T5=T5.replace(H$P,N9A));}return (this._addExcelPaletteList(T5),this.IB_DELIMITER_COLOR + T5);}return N9A;},A._addExcelPaletteList=function(B7){(B7=l7A + B7.toLowerCase(),-X2M == this.g_excelPaletteList.indexOf(B7) && (this.g_excelPaletteList+=B7));},A._excelDataFixedMergeRange=function(){var L4,R7,r7=g1K,i8=g1K,t9=g1K,i0=g1K;for((void g1K === this.FixedMergeTemplate && this._setFixedMergeTemplate(),L4=this.FixedMergeTemplate,i8=g1K);i8 < this.ExcelXB.length;i8++){for((this.ExcelXB[i8],i0=g1K,R7=L4.length);i0 < R7;i0++)r7 == L4[i0][g1K] && (t9=L4[i0][s2l]?i8 + L4[i0][s2l] - X2M:i8,this.ExcelColsMap[L4[i0][X2M]] && this.ExcelColsMap[L4[i0][e0s]] && this._excelSpanRange(this.ExcelXB,i8,this.ExcelColsMap[L4[i0][X2M]],this.ExcelXB[t9],this.ExcelColsMap[L4[i0][e0s]],g1K));++r7 == this.DataRows && (r7=g1K);}},A._excelDataMergeRange=function(){var f8,b$,G8,P$,x9,l3,X1,c9,d0,n2,u0;if(!this.MainCol){if(X2M < this.DataRows)for((f8=g1K,P$=this.ExcelXB.length);f8 < P$;f8++)for((X1=this.ExcelXB[f8],b$=g1K,G8=this.ExcelCol.length);b$ < G8;b$++)(d0=X1) != (d0=(X1[(n2=c9=this.ExcelCol[b$]) + a2f] || g1K == X1[c9 + a2f]) && X2M != X1[c9 + a2f]?d0:this._excelMergeTypeExtendBottom(X1,c9,this.XB,f8)) && this._excelSpanRange(this.ExcelXB,f8,c9,d0,c9,g1K);if(this.DataMergeAction){for((u0=[],b$=g1K,G8=this.ExcelCol.length);b$ < G8;b$++)(c9=this.ExcelCol[b$],this.ExcelColMerge[b$] && u0.push(c9));for(f8=g1K;f8 < this.ExcelXB.length;f8++)for((X1=this.ExcelXB[f8],x9=-X2M,b$=g1K,l3=this.ExcelCol.length);b$ < l3;b$++)(d0=X1,n2=c9=this.ExcelCol[b$],this.ExcelColMerge[b$] && x9++,g1K == X1[c9 + I5p] || (X1[c9 + a2f] || g1K == X1[c9 + a2f]) && X2M != X1[c9 + a2f] || (d0=this._excelMergeExtendBottom(X1,c9,this.ExcelXB,x9,u0,f8)),!this.DataRowMerge && !X1.RowMerge || g1K === X1[c9 + a2f] || g1K == X1[c9 + a2f] || (X1[c9 + I5p] || g1K == X1[c9 + I5p]) && X2M != X1[c9 + I5p] || (n2=this._excelMergeExtendRight(X1,c9,d0,T9S,this.ExcelXB,f8)),X1 == d0 && c9 == n2 || this._excelSpanRange(this.ExcelXB,f8,c9,d0,n2,g1K));}}},A._excelHeaderMergeRange=function(){var k0,v8,R0,N2,z9,E7,x_;if(this.HeaderMergeAction)for(k0=g1K;k0 < this.ExcelXH.length;k0++)for((N2=this.ExcelXH[k0],v8=g1K,R0=this.ExcelCol.length);v8 < R0;v8++)(E7=this.ExcelCol[v8],g1K == (z9=N2)[(x_=this.ExcelCol[v8]) + I5p] || (N2[x_ + a2f] || g1K == N2[x_ + a2f]) && X2M != N2[x_ + a2f] || (z9=this._excelMergeExtendBottom(N2,x_,this.ExcelXH,g1K,g1K,k0)),g1K == N2[x_ + a2f] || (N2[x_ + I5p] || g1K == N2[x_ + I5p]) && X2M != N2[x_ + I5p] || (E7=this._excelMergeExtendRight(N2,x_,z9,this.ExcelXH,this.ExcelXH,k0)),N2 == z9 && x_ == E7 || this._excelSpanRange(this.ExcelXH,k0,x_,z9,E7,g1K));},A._excelMergeExtendBottom=function(h2,S9,y0,v5,a1,G2){var m0,r2,w4,u$,r0=h2,o$=(h2[S9],s2l),U5=this.DataMergeAction;if((s2l !== U5 && z0e !== U5 || this.PreColumnMergeMode || (o$=X2M),!this.Cols[h2[S9 + v9M]].ColMerge && (y0 != this.ExcelXH || X2M == this.HeaderMergeMode)))return r0;if(L7U === h2.Name || h2.CumulateRow)return r0;for((w4=(m0=this.GetSheetPageLength()) && s2l == o$?parseInt(G2 / m0) * m0 + m0:y0.length,r2=G2 + X2M);r2 < w4 && (h2=y0[r2]);r2++)if(Z3$ !== h2.id){if(L7U === h2.Name || h2.CumulateRow)break;if(X2M < this.DataRows && y0 != this.ExcelXH && !h2.UnitPos)break;if((h2[S9],s2l !== U5 && z0e !== U5 || o5Q != h2.Kind))break;if((u$=T9S,a1?g1K < v5 && (u$=s2l === U5?a1[v5 - X2M]:a1[g1K]):X2M < (v5=parseInt(S9.substring(X2M))) && (u$=d0Q + (v5 - X2M)),u$)){if(!h2[u$ + a2f] && g1K != h2[u$ + a2f])break;if(h2[u$ + a2f] && X2M < h2[u$ + a2f])break;}}return r0;},A._excelMergeExtendRight=function(H0,g_,A0,J8,o5,p5){var Q_9="I";for(var h_,j7,M5,x4=g_,A2=H0[g_],D7=N9A,y8=H0[g_ + v9M],c1=this.Cols[y8].Section,M_=X2M,M2=this.getType(H0,g_),i1=[N1D,I45],E5=g1K;E5 < i1.length;E5++)if(M2 == i1[E5])return x4;if((!this.DataRowMerge || o5) && !H0.RowMerge)return x4;if(!this.Cols[y8].RowMerge && !o5)return x4;if(Q_9 == H0.Status)return x4;for((h_=g_.substr(X2M,g_.length),j7=this.ExcelCol.length);h_ <= j7;h_++){if((y8=H0[(g_=d0Q + h_) + v9M],M_=X2M,c1 != this.Cols[y8].Section)){M_=g1K;break;}if(!this.Cols[y8].RowMerge && !o5){M_=g1K;break;}if(H0 != A0)for(E5=p5;;E5++){if(A2 != (D7=(M5=o5[E5])[g_])){M_=g1K;break;}if(M5 == A0)break;}else (D7=H0[g_],g1K != H0[g_ + a2f] && A2 == D7 || (M_=g1K));if(!M_)break;(x4=g_,c1=this.Cols[y8].Section);}return x4;},A._excelMergeTypeExtendBottom=function(Q4,m4,L_,t_){var i7,Q$,Z5=Q4,C4=g1K,d_=this.getType(Q4,Q4[m4 + v9M]);if(!({Status:X2M,Seq:X2M,DelCheck:X2M,Result:X2M})[d_])return Z5;for((i7=d_,C4=t_ + X2M,Q$=this.ExcelXB.length);C4 < Q$ && (Q4=this.ExcelXB[C4]).UnitPos;C4++)if(Z3$ !== Q4.id){if(i7 != this.getType(Q4,Q4[m4 + v9M]))break;Z5=Q4;}return Z5;},A._excelSpanRange=function(l8,k5,T_,m7,h3){var W1,P_,A1,B1,I6,Q8=g1K,T9=g1K,q3=g1K,q_=parseInt(T_.substring(X2M)),N9=parseInt(h3.substring(X2M));if(void g1K !== l8[k5][T_] && void g1K !== l8[k5][h3]){if(X2M == l8[k5][T_ + a2f] && g1K == l8[k5][T_ + I5p])for(P_=q_;g1K <= P_;P_--)if(X2M < l8[k5][d0Q + P_ + I5p]){l8[k5][d0Q + P_ + I5p]=l8[k5][d0Q + P_ + I5p] - X2M;break;}for(P_=q_;P_ <= N9;P_++)if(g1K == l8[I6=k5][d0Q + P_ + a2f]){for((Q8=g1K,A1=I6 - X2M);g1K <= A1;A1--)if((Q8++,g1K < l8[A1][d0Q + P_ + a2f])){l8[A1][d0Q + P_ + a2f]=Q8;break;}if(g1K == l8[I6 + X2M][d0Q + P_ + a2f])for((Q8=g1K,A1=I6 + X2M,B1=l8.length);A1 < B1 && g1K == l8[A1][d0Q + P_ + a2f];A1++)(this.DelProperty(l8[A1],[d0Q + P_ + a2f]),this.DelProperty(l8[A1],[d0Q + P_ + I5p]));}for((q3=g1K,W1=k5);;W1++){for((q3++,P_=q_);P_ <= N9;P_++)(T9=P_ == q_?N9 - q_ + X2M:g1K,l8[W1][d0Q + P_ + a2f]=g1K,l8[W1][d0Q + P_ + I5p]=T9);if(l8[W1] == m7)break;}for(P_=q_;P_ <= N9;P_++)l8[k5][d0Q + P_ + a2f]=q3;}},A._getDown2Excel=function(h4,p$){var M7E="TopFontUnder";var W5u="Palette";var g6D="ExcelFontSize";var J0j="SumBackColor";var R9r="TopAlign";var m_3="TopText";var A0A="ColVisibles";var N1P=" .";var u1q="BottomFontName";var k$$="_IBCT";var M86=255;var O6Y="SheetNo";var K1X="BottomBackColor";var n2Q="color";var a8W="ReportXML";var e$4="DownRowSpan";var d$d="TextToGeneral";var m9f="DownCombo";var a_d="ColMerge";var y1B="FootRow";var n08="SheetFontName";var s6k="SumEndRow";var Y8b="ImageProcessType";var g2w="16777215";var Q2m="ImageList";var R2h="BottomFontSize";var a_0="BottomText";var F9d="background-color";var x0L="SheetFontSize";var Q87="ExcelHeaderRowHeight";var H0z="AppendPrevSheet";var c_r="ComboValidation";var U9Q="TopBorder";var T8_="SubSumRow";var q6J="SheetName";var X2i="BottomFontUnder";var f6G="HeaderBackColor";var k93="BottomAlign";var k0a="SumRow";var L5x="|visible|";var K41="HeaderFontColor";var l7x="BottomFontBold";var q9H="UseFormula";var M_x="SumCell";var j6S="NumberFormatMode";var e3p="SheetDesign";var e90="TopBackColor";var f5V="BottomFontColor";var c7$="TopFontColor";var c3h="CellFormula";var O5R="MergeMode";var X3b="ExcelRowHeight";var C8Y="AutoSizeColumn";var p$A="TopFontName";var o_p="TopHeight";var h4X="TopFontSize";var p3_="BottomBorder";var V31="_IBCC";var q$o="TopFontBold";var K6s="NumberExMode";var X2T="UserMerge";var y_F="BottomHeight";var B1h="PrintSetup";var u0d="TempFile";var L3m="SumStartRow";var j1,v$,N8,r$,K4,c7,g6,V3,v6,O5,W8,t4,D9=[],V0=N9A,C9=[],e4=X2M,B9=N9A,r8=N9A,m5=!X2M,D8=this,S0=g1K,X0=!X2M,I8=N9A,u8=N9A,N7=[],b_=g1K,s0=g1K,O2=g1K,p4=m51 != h4.downRows,O8=L5x == (h4.downRows + N9A).toLowerCase(),G3=h4.downHeader && h4.merge,g7=!h4.onlyHeaderMerge,U7=h4.treeLevel,o4=g1K,c_=g1K,L7=g1K,j5=[],e0=[],k9=[],n1=[],d2=N9A,F6=N9A,j6=N9A,v4=N9A,Y4=(this.Cols,this.ImageList),I4=[],l1={},r3=N9A,z1=N9A,Z8=N9A,t2=N9A,L1=N9A,T1=N9A,P1=N9A,m6=N9A,d2=N9A,X8=N9A,R8=N9A,f9=N9A,S$=N9A,f4=N9A,x6=N9A,p3=N9A,g8=N9A,b7=N9A,D1=N9A,D1=N9A,D2=N9A,J4=g1K,D3=g1K,L3=[],a7=this.hasFilter();for((this.g_excelPaletteList=N9A,X2M != h4.sheetDesign && s2l != h4.sheetDesign || (m5=!g1K),v$=(N7=this.MultiRecord && X2M & this.MultiRecordShape?this._DownMultiMap[g1K]:this._getDownColNames(h4)).length,o4=g1K);o4 < this.DataRows;o4++)for((c7=this.Cols,c_=g1K);c_ < v$;c_++)(I8=(j1=(this.MultiRecord && X2M & this.MultiRecordShape?this._DownMultiMap[o4]:N7)[c_]) && c7[j1] && c7[j1].EnumKeys?(N9A + c7[j1].EnumKeys).substring(X2M):void g1K,u8+=this._makeColumnTag(S0 + V31,void g1K !== I8?I8:N9A),void g1K !== I8 && M86 < I8.length && (L7=X2M),I8=j1 && c7[j1] && c7[j1].Enum?(N9A + c7[j1].Enum).substring(X2M):void g1K,u8+=this._makeColumnTag(S0 + k$$,void g1K !== I8?I8:N9A),S0++,void g1K !== I8 && M86 < I8.length && (L7=X2M));if((B9+=u8,X2M === L7 && (h4.comboValidation=g1K),g1K == v$))return (this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,C0Q,!X2M),-X2M);if((d2=this.GetHeaderBackColor(),F6=this.GetSumBackColor(),L1=this.GetHeaderFontColor(),N9A == d2 && (d2=-X2M == (d2=L._ibsUtil.getWebColor(this._getCCSStylesheetRuleStyle(N1P + this.GetTheme() + e7V,F9d)))?N9A:d2),N9A == F6 && (F6=-X2M == (F6=L._ibsUtil.getWebColor(this._getCCSStylesheetRuleStyle(N1P + this.GetTheme() + M_x,F9d)))?N9A:F6),N9A == L1 && (L1=-X2M == (L1=L._ibsUtil.getWebColor(this._getCCSStylesheetRuleStyle(N1P + this.GetTheme() + e7V,n2Q)))?N9A:L1),d2=d2.replace(/#/g,N9A),F6=F6.replace(/#/g,N9A),L1=L1.replace(/#/g,N9A),j6=parseInt(d2,v_1),v4=parseInt(F6,v_1),headerFontColorInt=parseInt(L1,v_1),j6=isNaN(j6)?g2w:j6,v4=isNaN(v4)?g2w:v4,headerFontColorInt=isNaN(headerFontColorInt)?g2w:headerFontColorInt,this._addExcelPaletteList(F6),this._addExcelPaletteList(d2),this._addExcelPaletteList(L1),this.ExcelXH=[],this.ExcelXB=[],this.ExcelXF=[],this.ExcelColsMap={},F6={from:C0Q,cfg:h4,sheetDesign:m5,isTreeLevel:U7,isDownRows:p4,isDownRowVisible:O8,rowHeights:C9,downColNames:N7,downColNamesLength:v$,data:D9,p:e4,headerRows:s0,isHeaderMerge:G3},h4.merge)){for((o4=g1K,L7=this.getCols().length);o4 < L7;o4++){if((X0=!X2M,j1=this.getCols()[o4],this.Cols[j1].Visible))for(c_=g1K;c_ < v$;c_++)j1 == N7[c_] && (X0=!g1K);else for((X0=!g1K,c_=g1K);c_ < v$;c_++)if(j1 == N7[c_]){X0=!X2M;break;}if(!(g6=X0))break;}if(((L.g_isDirectDown2Excel || p4 && !O8 || h4.downRowSpan) && (g7=!X2M),g3X == this.MainCol && (g7=!X2M),b_=g1K,h4.downHeader || (b_=this.getHeaderRows().length),this.Rows.FormulaRow && p1z == this.Rows.FormulaRow.Fixed && this.Rows.FormulaRow.Visible && !h4.downSum && b_++,this.Rows.Filter && this.Rows.Filter.Visible && b_++,(F6.isSameDownColAndVisible=g6) && (this.ExLoad || !a7) && (!this.ExLoad || p4 && !O8 || !this.MergeVisibleDom && (g1K != this.RowIndexMap.length || this.MainTag.offsetHeight && this.MainTag.offsetWidth)) || (this.MergeAllRanges=!g1K),G3 && this.MergeAllRanges))for(var d8=this.getHeaderRows(),o4=g1K;o4 < d8.length;o4++)this.SetRowAutoMerge(d8[o4],this.HeaderMerge,N7);if(!L.g_isDirectDown2Excel && this.MergeAllRanges){if((!this.ExLoad || !this.CalcMergeMode && (g1K != this.RowIndexMap.length || this.MainTag.offsetHeight && this.MainTag.offsetWidth) || (t4=this.RowIndexMap,this.UpdateRowIndex()),g7)){(this.ExLoad && !this.MergeVisibleDom && this.SplitDataAutoMerge(),this.MergeAllRanges && !p4 && (this.RowsMergeRow=this.getDataRows()));for(var e5=O8?this.getFirstVisibleRow():this.getFirstRow(T9S,y3x);e5;e5=O8?this.getNextVisibleRow(e5):this.getNextRow(e5))this.SetRowAutoMerge(e5,this.DataMerge,N7);this.ExLoad && !this.MergeVisibleDom && (D8=this,setTimeout(function(){(this.MergeAllRanges=!g1K,D8.SetDataAutoMerge(),delete this.MergeAllRanges);},H08));}(T9S != t4 && (this.RowIndexMap=t4),delete this.RowsMergeRow);}}for((h4.downHeader && (N8=this._getHeaderData(F6),F6.p=N8.p,e4=N8.p,F6.headerRows=N8.headerRows,O2=N8.headerRows),X2M != L.g_isDirectDown2Excel && (e4=(N8=this._getBodyData(F6)).p,D9=N8.data,s0=N8.headerRows,C9=N8.rowHeights,j5=N8.sumRow,e0=N8.subSumRow,k9=N8.cumulateRow,n1=N8.footRow,L3=N8.formulas),a7=(m5=this._getColInfo(h4,N7,U7)).saveName,p4=m5.align,t4=m5.type,F6=m5.format,N8=m5.orgFormat,U7=m5.width,r$=m5.visible,K4=m5.datePattern,W8=m5.formulaRow,m5=m5.colMerge,h4.merge && (V0=this._getExcelMergeInfo(N7,G3,g7,s0,g6,b_,h4.downSum)),o4=g1K,V3=Y4.length);o4 < V3;o4++)(v6=o4,-X2M != (O5=this.GetImageList(v6)) && (O5=L._ibsUtil.getFullPath(O5),I4.push(v6 + n6c + O5)));(h4.header && s38 == typeof h4.header && (r3=(l1=this._getTitleConfig(h4.header)).text,z1=l1.align,Z8=l1.height,t2=l1.fontBold,L1=l1.fontColor,T1=l1.fontName,P1=l1.fontSize,m6=l1.fontUnderline,d2=l1.backColor,X8=l1.border,J4=!g1K),h4.footer && s38 == typeof h4.footer && (R8=(l1=this._getTitleConfig(h4.footer)).text,f9=l1.align,S$=l1.height,f4=l1.fontBold,x6=l1.fontColor,p3=l1.fontName,g8=l1.fontSize,b7=l1.fontUnderline,D1=l1.backColor,D2=l1.border,D3=!g1K),this.ExcelXH=T9S,this.ExcelXB=T9S,this.ExcelXF=T9S,this.fileDownloadCheckToken=new Date().getTime(),L.g_isDown2ExcelBuffer?L.g_isDown2ExcelBufferToken?this.fileDownloadCheckToken=L.g_isDown2ExcelBufferToken:L.g_isDown2ExcelBufferToken=this.fileDownloadCheckToken:L.fileDownloadCheckTimer=F.setInterval(function(){D8._getCookie(m_z) == D8.fileDownloadCheckToken && (D8.fileDownloadCheckToken=T9S,D8._finishDownload());},H08),B9+=this._makeColumnTag(O_p,this.fileDownloadCheckToken),(r8=location.href.substring(location.href.indexOf(N7A) + s2l).split(n5F))[g1K]=N9A,r8[r8.length - X2M]=N9A,g1K < h4.excelFontSize && (B9+=this._makeColumnTag(g6D,h4.excelFontSize)),X2M != h4.sheetDesign && s2l != h4.sheetDesign || (B9=(B9=(B9=(B9=(B9+=this._makeColumnTag(n08,this.GetSheetFontName())) + this._makeColumnTag(x0L,this.GetSheetFontSize())) + this._makeColumnTag(f6G,j6)) + this._makeColumnTag(J0j,v4)) + this._makeColumnTag(K41,headerFontColorInt)),B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9+=this._makeColumnTag(Q_u,r8.join(n5F))) + this._makeColumnTag(d6w,L._ibsUtil.getFileName(h4.fileName,H4w))) + this._makeColumnTag(J9T,h4.extendParam)) + this._makeColumnTag(X3b,h4.excelRowHeight)) + this._makeColumnTag(q6J,h4.sheetName)) + this._makeColumnTag(m9f,h4.downCombo)) + this._makeColumnTag(a8W,h4.reportXML)) + this._makeColumnTag(d$d,h4.textToGeneral?X2M:g1K)) + this._makeColumnTag(z$A,h4.wordWrap?X2M:g1K)) + this._makeColumnTag(C8Y,h4.autoSizeColumn?X2M:g1K)) + this._makeColumnTag(F9f,p4)) + this._makeColumnTag(d5r,V0)) + this._makeColumnTag(O5R,h4.merge)) + this._makeColumnTag(X2L,a7)) + this._makeColumnTag(W5u,this.g_excelPaletteList)) + this._makeColumnTag(o_F,O2)) + this._makeColumnTag(k9f,t4)) + this._makeColumnTag(j_h,F6)) + this._makeColumnTag(z8c,N8)) + this._makeColumnTag(H8v,K4)) + this._makeColumnTag(Z3$,W8)) + this._makeColumnTag(o9z,U7)) + this._makeColumnTag(l5l,C9.join(x2V))) + this._makeColumnTag(A0A,r$)) + this._makeColumnTag(L3m,g1K)) + this._makeColumnTag(s6k,g1K)) + this._makeColumnTag(O7H,h4.downHeader?X2M:g1K)) + this._makeColumnTag(e3p,g1K < h4.sheetDesign && h4.sheetDesign < z0e?h4.sheetDesign:g1K)) + this._makeColumnTag(c_r,h4.comboValidation?X2M:g1K)) + this._makeColumnTag(k0a,j5.join(B4i))) + this._makeColumnTag(T8_,e0.join(B4i))) + this._makeColumnTag(m5p,k9.join(B4i))) + this._makeColumnTag(y1B,n1.join(B4i))) + this._makeColumnTag(u0d,h4.tempFile)) + this._makeColumnTag(e$4,h4.downRowSpan)) + this._makeColumnTag(a_d,m5),h4.tempFile && (B9=(B9=(B9+=this._makeColumnTag(O6Y,h4.sheetNo)) + this._makeColumnTag(W36,h4.startRow)) + this._makeColumnTag(s3Y,h4.startCol)),B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9+=this._makeColumnTag(C5X,this._encodeBase64(h4.workbookPassword))) + this._makeColumnTag(H0z,h4.appendPrevSheet)) + this._makeColumnTag(j6S,h4.numberFormatMode)) + this._makeColumnTag(Q2m,I4.join(x2V))) + this._makeColumnTag(K6s,h4.numberExMode?X2M:g1K)) + this._makeColumnTag(q9H,h4.useFormula?X2M:g1K)) + this._makeColumnTag(Q87,h4.excelHeaderRowHeight)) + this._makeColumnTag(Y8b,h4.imageProcessType),J4 || D3?(J4 && (B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9+=this._makeColumnTag(m_3,r3)) + this._makeColumnTag(R9r,z1)) + this._makeColumnTag(o_p,Z8)) + this._makeColumnTag(h4X,P1)) + this._makeColumnTag(q$o,t2)) + this._makeColumnTag(M7E,m6)) + this._makeColumnTag(p$A,T1)) + this._makeColumnTag(c7$,L1 || GetStyle(this.getCell(this.Header,this.GetFirstColA())).color)) + this._makeColumnTag(e90,d2)) + this._makeColumnTag(U9Q,X8)),D3 && (B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9=(B9+=this._makeColumnTag(a_0,R8)) + this._makeColumnTag(k93,f9)) + this._makeColumnTag(y_F,S$)) + this._makeColumnTag(R2h,g8)) + this._makeColumnTag(l7x,f4)) + this._makeColumnTag(X2i,b7)) + this._makeColumnTag(u1q,p3)) + this._makeColumnTag(f5V,x6)) + this._makeColumnTag(K1X,D1)) + this._makeColumnTag(p3_,D2))):B9=(B9=(B9+=this._makeColumnTag(C_U,h4.titleText.replace(/\r\n/g,this.IB_DELIMITER_TITLE_NEWLINE).replace(/\|/g,this.IB_DELIMITER_TITLE_BACKSLASH))) + this._makeColumnTag(b3s,h4.titleAlign.toLowerCase())) + this._makeColumnTag(X2T,h4.userMerge));var b6=N9A;if(h4.printSetup && s38 == typeof h4.printSetup){var U9,n6=g1K;for(U9 in h4.printSetup)(b6+=(g1K < n6?x2V:N9A) + (U9.charAt(g1K).toUpperCase() + U9.slice(X2M,U9.length)) + n6c + h4.printSetup[U9] + N9A,n6+=X2M);}B9+=this._makeColumnTag(B1h,b6);var j4=N9A;if(h4.useFormula && g1K < L3.length)for(o4=g1K;o4 < L3.length;o4++)(g1K < o4 && (j4+=H$P),j4=(j4+=L3[o4].SaveName) + (this.IB_DELIMITER_COL + L3[o4].Formula));if((B9=(B9+=this._makeColumnTag(c3h,j4)) + this.IB_DELIMITER_ROW,D9[g1K]=B9,L.g_isDown2ExcelBuffer))(D9[e4++]=this.IB_DELIMITER_SHEET,L.g_down2ExcelBuffer+=D9.join(N9A),L.g_Multipart=h4.multipart);else {if(h4.debugMode)return D9.join(N9A);p$ && p$(D9.join(N9A));}delete this.MergeAllRanges;},A._getExcelMergeInfo=function(o6,N3,E$,S5,p6,y3,Y1){var i9,V8,C0,E1,J1,W_,E3=[],o8={},a$=g1K,n3=g1K,c3=[],v2={};(this.Rows.FormulaRow && this.Rows.FormulaRow.Visible && this.Rows.FormulaRow.Fixed,this.Rows.Filter.Visible,this.getHeaderRows().length);(this.ExcelCol=[],this.ExcelColMerge=[],c3=this.getCols(),this.Cols[this.RowIndex || L1l].Visible || c3.shift());for(a$=g1K;a$ < c3.length;a$++)v2[c3[a$]]=a$;for((i9=g1K,C0=o6.length);i9 < C0;i9++)(this.ExcelCol.push(d0Q + (i9 + X2M)),this.ExcelColMerge.push(o6[i9]?this.Cols[o6[i9]].ColMerge:void g1K),o8[o6[i9]]=i9);if(N3)for((this._excelHeaderMergeRange(),i9=g1K,C0=this.ExcelXH.length);i9 < C0;i9++)if(Z3$ !== (E1=this.ExcelXH[i9]).id && S5o != E1.id)for((V8=g1K,n3=this.ExcelCol.length);V8 < n3;V8++){var K8,b9=i9,R4=(K8=this.ExcelCol[V8]).substr(X2M,K8.length) - X2M,f5=E1[K8 + a2f],a0=E1[K8 + I5p];g1K < f5 && g1K < a0?(E3.push(b9 + B4i + R4),E3.push(b9 + f5 - X2M + B4i + (R4 + a0 - X2M) + x2V)):this.MultiRecord && X2M & this.MultiRecordShape && (X2M < E1[K8 + a2f] || X2M < E1[K8 + I5p]) && (E3.push(b9 + B4i + R4),E3.push(b9 + (X2M < E1[K8 + a2f]?E1[K8 + a2f] - X2M:g1K) + B4i + (R4 + (X2M < E1[K8 + I5p]?E1[K8 + I5p] - X2M:g1K)) + x2V));}if(E$)for((X2M < this.DataRows && e0s == this.DataMergeAction?this._excelDataFixedMergeRange():this._excelDataMergeRange(),i9=J1=g1K,C0=this.ExcelXB.length);i9 < C0;i9++)if(Z3$ !== (E1=this.ExcelXB[i9]).id && S5o != E1.id){for((V8=g1K,n3=this.ExcelCol.length);V8 < n3;V8++){(b9=J1 + S5,R4=(K8=this.ExcelCol[V8]).substr(X2M,K8.length) - X2M);(f5=E1[K8 + a2f],a0=E1[K8 + I5p]);g1K < f5 && g1K < a0?(E3.push(b9 + B4i + R4),E3.push(b9 + f5 - X2M + B4i + (R4 + a0 - X2M) + x2V)):this.MultiRecord && X2M & this.MultiRecordShape && (X2M < f5 || X2M < a0) && (E3.push(b9 + B4i + R4),E3.push(b9 + (X2M < f5?f5 - X2M:g1K) + B4i + (R4 + (X2M < a0?a0 - X2M:g1K)) + x2V));}J1++;}if(Y1)if((W_=(W_=g1K) == this.GetAutoSumPosition()?S5 - X2M:this.ExcelXB.length + S5,p6))for((i9=J1=g1K,C0=this.ExcelXF.length);i9 < C0;i9++){for((E1=this.ExcelXF[i9],V8=g1K,n3=this.ExcelCol.length);V8 < n3;V8++)if((b9=J1 + W_,R4=(K8=this.ExcelCol[V8]).substr(X2M,K8.length) - X2M,g1K < E1[K8 + a2f] && g1K < E1[K8 + I5p])){var M$=E1[K8 + I5p],W6=R4 + M$;if(g1K < E1[K8 + I5p])for(a$=s2l;a$ <= E1[K8 + I5p];a$++){var L9=E1[d0Q + (R4 + a$) + v9M];L9 && L9.substr(X2M,L9.length) > W6 && M$--;}g1K < E1[K8 + a2f] && g1K < M$?(E3.push(b9 + B4i + R4),E3.push(b9 + E1[K8 + a2f] - X2M + B4i + (R4 + M$ - X2M) + x2V)):this.MultiRecord && X2M & this.MultiRecordShape && (X2M < E1[K8 + a2f] || X2M < M$) && (E3.push(b9 + B4i + R4),E3.push(b9 + (X2M < E1[K8 + a2f]?E1[K8 + a2f] - X2M:g1K) + B4i + (R4 + (X2M < M$?M$ - X2M:g1K)) + x2V));}J1++;}else for((i9=J1=g1K,C0=this.ExcelXF.length);i9 < C0;i9++){for((E1=this.ExcelXF[i9],V8=g1K,n3=this.ExcelCol.length);V8 < n3;V8++)(b9=J1 + W_,R4=(K8=this.ExcelCol[V8]).substr(X2M,K8.length) - X2M,g1K < E1[K8 + a2f] && g1K < E1[K8 + I5p]?(E3.push(b9 + B4i + R4),E3.push(b9 + E1[K8 + a2f] - X2M + B4i + (R4 + E1[K8 + I5p] - X2M) + x2V)):this.MultiRecord && X2M & this.MultiRecordShape && (X2M < E1[K8 + a2f] || X2M < E1[K8 + I5p]) && (E3.push(b9 + B4i + R4),E3.push(b9 + (X2M < E1[K8 + a2f]?E1[K8 + a2f] - X2M:g1K) + B4i + (R4 + (X2M < E1[K8 + I5p]?E1[K8 + I5p] - X2M:g1K)) + x2V)));J1++;}for(i9=g1K;i9 < E3.length;i9+=s2l)E3[i9].replace(/\|/g,N9A) == E3[i9 + X2M].replace(/\|/g,N9A) && E3.splice(i9,s2l);return ((E3=(E3=E3.join(B4i)).replace(/\|\,/g,l7A)) && x2V == E3.substring(E3.length - X2M) && (E3=E3.substring(g1K,E3.length - X2M)),this.ExcelXH=T9S,this.ExcelXB=T9S,this.ExcelXF=T9S,this.ExcelCol=T9S,this.ExcelColMerge=T9S,E3);},A._getExcelRowHeight=function(E_,I1){E_=this.GetExcelRowHeight(E_,I1);return E_=g1K != E_ && E_ != this.InvalidValue?E_:this.GetDataRowHeight();},A._getStringExcel=function(O7,R9,I5,m$,S2){var X38="CODE";var E$8=/\:/;var P9l="GR";var o2V=/\-/;var g2d="***";var T3A=/\-|\/|\./;var m6C="BLANK";var l2_="g";var U2,q6,P7=g1K,L2=N9A,w3=N9A,D0=!X2M,l$=this.GetFnLib(U4e),F5=this.getAttribute(O7,R9,o1o) || this.getAttribute(O7,R9,v$b),O1=this.getType(O7,R9);if(V7R == S2)return B_(this._getCellText(O7,R9));if(this._isNumberType(O1) && !m$.numberTypeToText && (w3=this._getCellValue(O7,R9),R9 && R9 == (this.RowIndex || L1l) && !w3 && (!O7.Visible || O7.Hidden?w3=m6C:T9S != this.ExLoadSEQ && (w3=++this.ExLoadSEQ)),w3=B_(w3),this.MainCol !== R9))return w3;if(I5){if(m3N === (O1=x4x == O1 && (this.getAttribute(O7,R9,q3X) || this.getAttribute(O7,R9,k5H))?q3X:O1))return g2d;if((V1N == O1 && (S2=T9S,q6=w3=this._getCellValue(O7,R9),(N9A + (F5=(F5=F5 || (this.getAttribute(O7,R9,x6K) || this.DateFormat || this.getAttribute(O7,R9,n1q) || this.DataFormat)) && F5.replace(/[h]/g,m4n))).match(T3A) && (S2=F5.replace(/\-|\/|\./gi,N9A),q6=q6.replace(/\-|\/|\./gi,N9A)),q6=L.stringToDate(N9A + q6,w3.match(o2V) || !S2 && q6.match(E$8)?T9S:S2 || F5),S$i == typeof (w3=isNaN(q6)?w3:q6) && w3.match(E$8) && (q6=L.stringToDate(w3,g2s),isNaN(q6) || (w3=q6)),S$i == typeof (w3=L.dateToString(w3,F5)) && (w3=this._removeHTMLTag(w3))),q41 === O1))return this.Grouped && this.GroupTreeCols && this.GroupTreeCols[R9] && !O7.Def.Group?N9A:n5R == this.getValue(O7,R9)?m$.checkBoxOnValue:m$.checkBoxOffValue;if((q3X === O1 && (X38 == m$.downCombo?(w3=B_(this._getCellValue(O7,R9)),D0=!g1K):w3=B_(this._getCellText(O7,R9))),g92 === O1))if((w3=this._getCellText(O7,R9),!L._ibsUtil.isEmpty(w3) && l$(w3)))return (S2=w3.charAt(g1K),w3=w3.split(S2)[X2M],(w3=L._ibsUtil.getFullPath(w3)).replace(new RegExp(L._ibsUtil.escapeRegExp(L._ibsUtil.getDomain()),l2_),N9A));if(a_X === O1)return this._getCellText(O7,R9);if(L9d === O1)return this._removeHTMLTag(this._getCellText(O7,R9));}if((g1K == O7.id.indexOf(P9l) && R9 == this.GroupMain && o5Q == O7.Kind?(q6=G16 == typeof this.getSpanned?this.getSpanned(O7,R9):this.getMergeRange(O7,R9),w3=this._getCellText(q6[g1K],q6[X2M])):D0 || (w3=this._getCellText(O7,R9)),N9A == w3 && (O7.SubSumRow || O7.CumulateRow) && o2H == this.Cols[R9].Type))return B_(O7[R9]);function B_(F2){return F2=S$i == typeof F2?F2.replace(/[\x00]/g,N9A):F2;}if(I5 && this.MainCol == R9){for((P7=g1K,U2=+O7.Level);P7 <= U2;P7++)L2+=this.IB_DELIMITER_TREE_INDENT;w3=L2 + w3;}return B_(w3);},A._sendDown=function(r6,o0,P2,F9,C_,a8,v1,j3,b2,o_,K9,H5){var e9N="IBSheetDown2ExcelFrame";var f25="load";var y7W="IBSheetDown2ExcelFrm";var J5,f_,s1,D4,P4,V1=e9N,w2=g1K,u2=N9A,y9=!X2M;if((L.g_down2ExcelBuffer=N9A,v1))return (this.hideMessage(),r6 + this.IB_DELIMITER_END);if((C0Q == a8?u2=X2M == L.g_isDirectDown2Excel?y6n:v1Z:k3z == a8?u2=J4s:J_4 == a8 && (u2=H6s),b2 || H5 && s38 == typeof H5))this._xhrSendDown(r6 + this.IB_DELIMITER_END,o0,o_,a8,u2,K9,H5);else {if(((f_=W.getElementById(y7W)) && W.body.removeChild(f_),(f_=W.createElement(I8E)).id=y7W,f_.method=f3X,C_ && (f_.encoding=N6F,f_.enctype=N6F),(s1=W.createElement(S_$)).type=A1m,s1.name=o5Q,s1.value=r6 + this.IB_DELIMITER_END,f_.appendChild(s1),F9=void g1K === (F9=void g1K === P2?N9A:F9)?i5X:F9.toLowerCase(),v1=o0,v1+=(g1K <= o0.indexOf(y9e)?M3Y:y9e) + Q46 + u2,Y9g == F9)){if((f_.action=v1,P2))for((P4=P2.split(M3Y),w2=g1K);w2 < P4.length;w2++)(D4=(P4[w2] + n6c).split(n6c),(s1=W.createElement(S_$)).type=A1m,s1.name=D4[g1K],s1.value=D4[X2M],f_.appendChild(s1));}else f_.action=v1 + (N9A != P2?M3Y:N9A) + P2;((J5=W.createElement(n4n)).name=V1,J5.id=V1,J5.width=A2s,J5.height=A2s,J5.addEventListener(f25,(function(){j3 && F.setTimeout((function(){L.fileDownloadCheckTimer && (F.clearInterval(L.fileDownloadCheckTimer),L.fileDownloadCheckTimer=T9S,J5.parentNode.removeChild(J5),this.hideMessage(),this.showMessageTime(this.Lang.Alert.ResultErrUnknown));}).bind(this),j3);}).bind(this)),f_.target=V1,f_.appendChild(J5),W.body.appendChild(f_),f_.style.display=U4D,f_.style.width=A2s,f_.style.height=A2s,F.frames[V1].name=V1,b2=this._checkCrossDomain(o0),(y9=L.OnBeforeDownload?L.OnBeforeDownload(this,a8,f_):y9) || C0Q != a8 || L.OnReadyExcelDown && (y9=L.OnReadyExcelDown(this,f_)),y9 || f_.submit(),!L.fileDownloadCheckTimer || this.fileDownloadCheckToken && !b2 || (F.clearInterval(L.fileDownloadCheckTimer),L.fileDownloadCheckTimer=T9S,this.hideMessage(),!y9 && IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,a8,!g1K)));}},A._xhrSendDown=function(H9,M9,j$,C$,K2,M8,t5){var W0=new FormData(),x8=!X2M,u4=M9,J$=(u4+=(g1K <= M9.indexOf(y9e)?M3Y:y9e) + Q46 + K2,M8 && s38 == typeof M8 && Object.keys(M8).forEach(function(F0,q0){W0.append(F0,M8[F0]);}),new XMLHttpRequest());(J$.open(Y9g.toUpperCase(),u4),t5 && s38 == typeof t5 && Object.keys(t5).forEach(function(k8,V2){J$.setRequestHeader(k8,t5[k8]);}),J$.responseType=U2P,J$.onload=function(i2){var K01="#tempAnchor";var A5$="tempAnchor";var O_,E2=J$.response;IBSheet.BIEA10 || IBSheet.BIEA11?F.navigator.msSaveBlob(E2,j$):(E2=URL.createObjectURL(E2),O_=T9S,(O_=W.querySelector(K01)?W.querySelector(K01):W.createElement(Y_t)).id=A5$,O_.style.display=U4D,W.body.append(O_),O_.href=E2,O_.download=j$,O_.click(),O_.href=N9A,O_.download=N9A,URL.revokeObjectURL(u4));},J$.onerror=function(Y5){(this.hideMessage(),this.showMessageTime(this.Lang.Alert.ResultErrUnknown));},W0.append(o5Q,H9),L.OnBeforeDownload && (x8=L.OnBeforeDownload(this,C$,W0)));try{x8?this.hideMessage():J$.send(W0);}catch(I3){}},A.ExportData=function(n0){var X14="json";var d8y="xml";var C6,Z7,U4,q8,w8,M4,g2,Q6,Y3=[],z4=g1K,I0=N9A;if(T9S == n0 || void g1K === n0)return this.InvalidValue;for((C6=(n0.type || n0.Type || N9A).toLowerCase(),q8=n0.colDelim || n0.ColDelim || B4i,w8=n0.rowDelim || n0.RowDelim || I$1,M4=void g1K === n0.mode || void g1K === n0.Mode?g1K:T9S,M4=this._getNumberValue(M4,g1K),n0.Cols=n0.Cols || n0.cols,n0.Cols=void g1K === n0.Cols?[]:(n0.Cols + N9A).split(x2V),g2=this._getBooleanValue(n0.FormattedText,g1K),Q6=this._getBooleanValue(n0.StyleProperty,g1K),z4=g1K,Z7=n0.Cols.length);z4 < Z7;z4++)(C65 == C6 && X2M === M4 && N9A === n0.Cols[z4] && Y3.push({}),-X2M !== (U4=this.Cols[n0.Cols[z4]]) && Y3.push({Name:U4.Name}));if(g1K === Y3.length)for(I0 in this.Cols)P31 == I0 || H_Q == I0 || I0 == (this.RowIndex || L1l) && X2M != this.Cols[I0].Visible || Y3.push({Name:I0});return d8y == C6?this._exportXml(Y3,g2,n0.checkCol):X14 == C6?this._exportJson(Y3,g2,Q6,n0.checkCol):C65 == C6?this._exportCsv(Y3,g2,q8,w8,M4,n0.newLine || n0.NewLine,n0.checkCol):this.InvalidValue;},A.GetAutoSumPosition=function(){return this.FormulaRowPosition;},A.GetColIndexInfo=function(){var V5,J9,s9=g1K,U3=g1K,P5=this.ColNames.length;for((this.ColIndexInfo=[],s9=g1K);s9 < P5;s9++)for((U3=g1K,J9=(V5=this.ColNames[s9]).length);U3 < J9;U3++)P31 !== V5[U3] && g3X !== V5[U3] && this.ColIndexInfo.push(V5[U3]);},A.GetColName=function(e$){return this.Cols[e$]?e$:this.SaveNameInfo[e$]?this.SaveNameInfo[e$].ColName:N9A;},A.GetDataRowHeight=function(){return this.RowHeight || this.MinRowHeight;},A.GetExcelRowHeight=function(D$,y7){var J6=this._validInputRow(D$),D$=g1K;if(-X2M === J6)return this.InvalidValue;if(!J6.Visible)return D$;if(IBSheet.BIE8Strict && !IBSheet.BIE9Strict && J6.r1){if(this.MultiRecord && X2M & this.MultiRecordShape && J6.r1)for(var W2=J6.r1.firstChild.firstChild.firstChild.firstChild.firstChild.firstChild.nextSibling,H6=g1K;W2;){if(H6 == y7)return W2.offsetHeight;(W2=W2.nextSibling,H6++);}for(H6=g1K;H6 < J6.r1.childNodes.length;H6++){var t3=J6.r1.childNodes[H6].offsetHeight,a9=a9 || t3;g1K < t3 && t3 < a9 && (a9=t3);}D$=a9 || this.MinRowHeight;}else D$=(D$=this.GetRHeight(J6,y7)) || this.MinRowHeight;return D$;},A.GetFirstColA=function(q5,e7){for(var R6=[P31,H_Q],J7=this.ColNames,y$=this.Cols,m2=T9S == q5?(q5=g1K,J7.length):g1K == q5?X2M:X2M == q5?J7.length - X2M:(q5=J7.length - X2M,J7.length),c4=q5;c4 < m2;c4++){for(var U8=g1K,J0=J7[c4];J0[U8] && (-X2M < R6.indexOf(J0[U8]) || !y$[J0[U8]].Visible && s2l != e7 && (!e7 || !y$[J0[U8]].Hidden));U8++);if(J0[U8])return J0[U8];}return T9S;},A.GetHeaderBackColor=function(){var K_,a2=N9A,h1=W.createElement(r8a);return (h1.setAttribute(i8p,this.Style + e7V),h1.style.visibility=A1m,h1.style.position=p9I,W.body.appendChild(h1),K_=GetStyle(h1),a2=IBSheet._ibsUtil.getWebColor(K_.backgroundColor),h1.parentNode.removeChild(h1),a2=-X2M === a2?this.InvalidValue:a2);},A.GetHeaderFontColor=function(){var S4,z_=N9A,x3=W.createElement(r8a);return (x3.setAttribute(i8p,this.Style + e7V),x3.style.visibility=A1m,x3.style.position=p9I,W.body.appendChild(x3),S4=GetStyle(x3),z_=IBSheet._ibsUtil.getWebColor(S4.color),x3.parentNode.removeChild(x3),z_=-X2M === z_?this.InvalidValue:z_);},A.GetLoadColNames=function(p_,W7){for(col=this.GetFirstColA(T9S,s2l);col;col=this.GetNextColA(col))(W7.DateStrictMode=this.DateStrictMode || this.Cols[col].DateStrictMode || this.Rows[col + Y6D],X2M == W7.unMatchColHidden?this.Cols[col].Visible && p_.push(col):col == (this.RowIndex || L1l) && g1K == this.Cols[col].Visible && h_i == this.Cols[col].Def || H_Q != col && p_.push(col));},A.GetNextColA=function(E6){if(!E6)return T9S;var X2=this.Cols;if(!X2[E6])return T9S;for(var I7=X2[E6].Section,M0=this.ColNames,T6=X2[E6].Pos + X2M;;){for(;M0[I7][T6] && P31 == M0[I7][T6];)T6++;if(M0[I7][T6])return M0[I7][T6];if((T6=g1K,++I7 >= M0.length))return T9S;}},A.GetOrgType=function(d6,y_){if(!d6 || !y_ || d6.Page)return N9A;var O3,G5=d6[y_ + a9S];return (T9S == (G5=T9S == G5 && d6.Def?d6.Def[y_ + W0D]:G5) && ((O3=d6.Space?this.DefCols.C:this.Cols[y_]) && (G5=O3.LegacyType),S5o != d6.Kind || CEditTypes[G5] || P31 == G5 || H_Q == y_ || (G5=o2H)),G5);},A.GetRHeight=function(a4,F$){if(!a4)return g1K;if(this.MultiRecord && X2M & this.MultiRecordShape && a4.r1)for(var n8=a4.r1.firstChild.firstChild.firstChild.firstChild.firstChild.firstChild.nextSibling,l0=g1K;n8;){if(l0 == F$)return n8.offsetHeight;(n8=n8.nextSibling,l0++);}if(IBSheet.BIE8Strict && !IBSheet.BIE9Strict){if(Q1E != a4.Kind)return a4.Height || this.RowHeight;if(a4.r1 && a4.r1.offsetHeight - this.HeaderRowHeight >= this.HeaderRowHeight)return this.HeaderRowHeight;}if(a4.r1)return a4.r1.offsetHeight;var G9=a4.Height;return T9S != G9?G9:a4.Page?this.GetPageHeight(a4):T9S != (G9=a4.Def?a4.Def.Height:G9)?G9:this.RowHeight;},A.GetSheetFontName=function(){var b06="Dotum";var x2,B2=b06;return (this.SheetFontName?B2=this.SheetFontName:(x2=this.XH.firstChild) && x2.r1 && (B2=GetStyle(x2.r1).fontFamily.replace(/\"/gi,N9A).split(B4i)[g1K]),B2);},A.GetSheetFontSize=function(){var P9d="px";var P3z=12;var z7,G4=P3z;return (this.SheetFontSize?G4=this.SheetFontSize:(z7=this.XH.firstChild) && z7.r1 && (G4=GetStyle(z7.r1).fontSize.replace(P9d,N9A)),parseInt(G4,q$Y));},A.GetSheetPageLength=function(){var I$=g1K;return I$=this.Paging?this.PageLength:I$;},A.GetStatusValue=function(v_){var r4=N9A,w7=this.StatusCol,s$=this.DataRows;if(!w7)return r4;if(X2M < s$){for(var A$=this.GetUnitBaseRow(v_);A$;A$=this.getNextRow(A$))if(N1D == this.getAttribute(A$,w7,W0D)){r4=A$[w7];break;}}else r4=v_[w7] || N9A;return r4;},A.GetSumBackColor=function(E9){var r5=N9A,w_=this.Rows.FormulaRow;return ((r5=w_ && w_.Background || this.SumBackColor) || (w_=this.getCell(w_,E9 || this.GetFirstColA())) && (r5=GetStyle(w_).backgroundColor),IBSheet._ibsUtil.getWebColor(r5));},A.GetTheme=function(){return this.Style;},A.LoadFile=function(W4){(this.HasLoadedExcelData && delete this.HasLoadedExcelData,this._prepareExportSetting());var Z3,Z_,p0,D7H,W4=L._ibsUtil.cloneArray(W4),f3={},k7={},b3=N9A,l7=[],f3=(L.g_targetExcelSheetID=this.id,L.g_isLoadExcelBuffer || (L.g_LoadExcelSheetID=[]),L.g_LoadExcelSheetID.push(this.id),void g1K !== this.LoadExcelConfig && (f3=this.LoadExcelConfig),void g1K !== this.LoadTextConfig && (k7=this.LoadTextConfig),(W4=void g1K === W4?[]:W4).append=this._getDefault(void g1K !== W4.append?W4.append:W4.Append,this._getDefault(f3.append,!X2M)),W4.columnMapping=this._getDefault(void g1K !== W4.columnMapping?W4.columnMapping:W4.ColumnMapping,this._getDefault(f3.columnMapping,N9A)),W4.debugMode=this._getDefault(void g1K !== W4.debugMode?W4.debugMode:W4.DebugMode,this._getDefault(f3.debugMode,!X2M)),W4.endRow=this._getDefault(void g1K !== W4.endRow?W4.endRow:W4.EndRow,this._getDefault(f3.endRow,g1K)),W4.extendParam=this._getDefault(void g1K !== W4.extendParam?W4.extendParam:W4.ExtendParam,this._getDefault(f3.extendParam,N9A)),W4.fileExt=this._getDefault(void g1K !== W4.fileExt?W4.fileExt:W4.FileExt,this._getDefault(f3.fileExt,N9A)),W4.maxFileSize=this._getDefault(void g1K !== W4.maxFileSize?W4.maxFileSize:W4.MaxFileSize,this._getDefault(f3.maxFileSize,g1K,i8B),i8B),W4.merge=this._getDefault(void g1K !== W4.merge?W4.merge:W4.Merge,this._getDefault(f3.merge,X2M)),W4.mode=this._getDefault(void g1K !== W4.mode?W4.mode:W4.Mode,this._getDefault(f3.mode,B$k)),W4.serverFile=this._getDefault(void g1K !== W4.serverFile?W4.serverFile:W4.ServerFile,this._getDefault(f3.serverFile,N9A)),W4.startCol=this._getDefault(void g1K !== W4.startCol?W4.startCol:W4.StartCol,this._getDefault(f3.startCol,X2M)),W4.startRow=this._getDefault(void g1K !== W4.startRow?W4.startRow:W4.StartRow,this._getDefault(f3.startRow,X2M)),W4.unMatchColHidden=this._getDefault(void g1K !== W4.unMatchColHidden?W4.unMatchColHidden:W4.UnMatchColHidden,this._getDefault(f3.unMatchColHidden,N9A)),W4.useDOM=this._getDefault(void g1K !== W4.useDOM?W4.useDOM:W4.UseDOM,this._getDefault(f3.useDOM,!X2M)),W4.workSheetName=this._getDefault(void g1K !== W4.workSheetName?W4.workSheetName:W4.WorkSheetName,this._getDefault(f3.workSheetName,N9A)),W4.workSheetNo=this._getDefault(void g1K !== W4.workSheetNo?W4.workSheetNo:W4.WorkSheetNo,this._getDefault(f3.workSheetNo,X2M)),W4.encoding=this._getDefault(void g1K !== W4.encoding?W4.encoding:W4.Encoding,this._getDefault(k7.encoding,N9A)),W4.deli=this._getDefault(void g1K !== W4.deli?W4.deli:W4.Deli,this._getDefault(k7.deli,Q6G)),W4.colSeparator=this._getDefault(void g1K !== W4.colSeparator?W4.colSeparator:W4.ColSeparator,this._getDefault(k7.colSeparator,Q6G)),Q6G !== W4.colSeparator && W4.colSeparator !== W4.deli && (W4.deli=W4.colSeparator),W4.skipEmptyRow=this._getDefault(void g1K !== W4.skipEmptyRow?W4.skipEmptyRow:W4.SkipEmptyRow,this._getDefault(f3.skipEmptyRow,!g1K)),W4.colLength=this._getDefault(void g1K !== W4.colLength?W4.colLength:W4.ColLength,this._getDefault(k7.colLength,N9A)),W4.colLength2Byte=this._getDefault(void g1K !== W4.colLength2Byte?W4.colLength2Byte:W4.ColLength2Byte,this._getDefault(k7.colLength2Byte,!g1K)),W4.emptyChar=this._getDefault(void g1K !== W4.emptyChar?W4.emptyChar:W4.EmptyChar,this._getDefault(k7.emptyChar,l7A)),W4.fillRight=this._getDefault(void g1K !== W4.fillRight?W4.fillRight:W4.FillRight,this._getDefault(k7.fillRight,!g1K)),W4.colLength);if((N9A != f3 && m51 != f3 && (x2V == (f3=x2V == f3.substring(g1K,X2M)?f3.substring(X2M):f3).substring(f3.length - X2M) && (f3=f3.substring(g1K,f3.length - X2M)),W4.colLength=f3),void g1K !== W4.DialogType && (W4.dialogType=W4.DialogType),void g1K !== W4.Action && (W4.action=W4.Action),void g1K !== W4.LoadAction && (W4.loadAction=W4.LoadAction),void g1K !== W4.DialogTheme && (W4.dialogTheme=W4.DialogTheme),void g1K !== W4.DialogSheetTheme && (W4.dialogSheetTheme=W4.DialogSheetTheme),void g1K !== W4.DisableSheet && (W4.disableSheet=W4.DisableSheet),void g1K !== W4.CallBack && (W4.callBack=W4.CallBack),this._uploadDialogDelim=W4.deli,this._uploadDialogLoadType=W4.dialogType,W4.action && G16 == typeof W4.action?this._uploadDialogAction=W4.action:this._uploadDialogAction=T9S,W4.loadAction && G16 == typeof W4.loadAction?this._uploadDialogLoadFile=W4.loadAction:this._uploadDialogLoadFile=T9S,W4.dialogTheme?this._uploadDialogTheme=W4.dialogTheme:this._uploadDialogTheme=T9S,W4.dialogSheetTheme?this._uploadDialogSheetTheme=W4.dialogSheetTheme:this._uploadDialogSheetTheme=T9S,W4.disableSheet?this._uploadDisableSheet=X2M:this._uploadDisableSheet=T9S,W4.callBack && G16 == typeof W4.callBack?this._uploadCallBack=W4.callBack:this._uploadCallBack=T9S,this._autoExcelModeCheck(W4,this.AutoExcelMode,T_W,!X2M,!X2M))){if((this.GetLoadColNames(l7,W4),k7=this._getHeaderText(l7),Z3=(f3=this._getColInfo(W4,l7,!X2M)).name,Z_=f3.saveName,p0=f3.type,D7H=f3.format,f3=f3.datePattern,b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3=(b3+=this._makeColumnTag(Y6D,W4.DateStrictMode?X2M:g1K)) + this._makeColumnTag(l7i,W4.append?X2M:g1K)) + this._makeColumnTag(W_q,W4.unMatchColHidden)) + this._makeColumnTag(k12,this.SearchMode)) + this._makeColumnTag(J9T,W4.extendParam)) + this._makeColumnTag(W2f,l7.length)) + this._makeColumnTag(o_F,this.getHeaderRows().length)) + this._makeColumnTag(W36,W4.startRow)) + this._makeColumnTag(z2s,W4.endRow)) + this._makeColumnTag(s3Y,W4.startCol)) + this._makeColumnTag(O6H,W4.workSheetNo)) + this._makeColumnTag(m2$,W4.workSheetName)) + this._makeColumnTag(i1J,W4.mode.replace(/ /g,N9A).toUpperCase())) + this._makeColumnTag(A7c,void g1K !== this.StatusCol?this.StatusCol:N9A)) + this._makeColumnTag(i9K,W4.columnMapping)) + this._makeColumnTag(X2L,Z3)) + this._makeColumnTag(q$u,Z_)) + this._makeColumnTag(M12,k7)) + this._makeColumnTag(O1U,Z3)) + this._makeColumnTag(B5m,p0)) + this._makeColumnTag(N8F,D7H)) + this._makeColumnTag(H8v,f3)) + this._makeColumnTag(V5n,this.id)) + this._makeColumnTag(L0K,W4.deli)) + this._makeColumnTag(W_e,W4.encoding)) + this._makeColumnTag(d5r,W4.merge)) + this._makeColumnTag(h3a,this.UseJsonAttribute)) + this._makeColumnTag(j6f,W4.serverFile),l7=this._getDefault(this.Source.LoadExcel.Url,w$c),l7=L._ibsUtil.getFullPath(l7),b3+=this._makeColumnTag(U0z,l7),G16 != typeof F.postMessage && s38 != typeof F.postMessage || (b3+=this._makeColumnTag(P_a,this.id)),b3=(b3=(b3=(b3=(b3=(b3=(b3+=this._makeColumnTag(c_$,W4.useDOM?X2M:g1K)) + this._makeColumnTag(H98,W4.colLength)) + this._makeColumnTag(b50,W4.colLength2Byte?X2M:g1K)) + this._makeColumnTag(h3t,W4.emptyChar)) + this._makeColumnTag(B5N,W4.fillRight?X2M:g1K)) + this._makeColumnTag(r4q,W4.cutText?X2M:g1K)) + this._makeColumnTag(d6K,W4.skipEmptyRow?X2M:g1K),W4.debugMode || W4.DebugMode))return b3;this._makeLoadForm(T_W,!X2M,W4.fileExt,b3,W4.maxFileSize,W4.serverFile,W4.sendParam);}},A.mUnMatchColHidden=function(e6M){for(var t$p=e6M.split(x2V),O7C=X2M;O7C < t$p.length;O7C++)g1K == this.GetColHidden(t$p[O7C]) && this.SetColHidden(t$p[O7C],!g1K);},A.ShowAlert=function(S2o,U46,C9W,j7J){var b5b="Ok";var v72=this;return this.MessageShowLevel && u6T !== this.MessageShowLevel || u6T === U46?(this.AlertProgress=X2M,u6T != U46 && IBSheet.OnDebugMsg && IBSheet.OnDebugMsg(this,S2o,U46),this.ShowMsgMode?C9W?confirm(S2o)?(this.AlertProgress=g1K,!(this._invalidInputActionProc=g1K)):(this.AlertProgress=g1K,this._invalidInputActionProc=g1K,!X2M):void setTimeout(function(){(alert(S2o),G16 == typeof j7J && j7J(v72),v72.AlertProgress=g1K);},D60):(IBSheet.OnMessage?IBSheet.OnMessage(this,S2o,U46,C9W):this.showMessageTime(S2o,g1K,T9S,[b5b]),this.ConfirmInfo?(this.ConfirmInfo=g1K,this.AlertProgress=g1K,!(this._invalidInputActionProc=g1K)):(this.AlertProgress=g1K,this._invalidInputActionProc=g1K,!X2M))):-X2M;},A._autoExcelModeCheck=function(o2o,V2X,V6e,c2G,j$p,R$q){var j7x="xls|xlsx|txt|csv";var w5m=".csv";var s45=".txt";var i4h="xls|xlsx";var a7y="txt|csv";var T$n=!X2M;if((X2M == (V2X=this._getNumberValue(V2X,X2M,g1K,X2M,e0s)) && (T$n=!g1K),void g1K === o2o && (o2o={}),c2G)){if(s2l == V2X || e0s == V2X)if(j$p || e0s != V2X || b8x != typeof JSZip){if(void g1K !== R$q)return !X2M;if(C0Q == V6e){if(j$p)return !g1K;this.exportData(o2o);}else k3z == V6e && (-X2M == o2o.fileName.indexOf(s45) && -X2M == o2o.fileName.indexOf(w5m) && (o2o.fileName=o2o.fileName.concat(s45)),this.exportData(o2o));}else L.BIEA && !L.BIEA10?T$n=!g1K:C0Q == V6e?this.exportData(o2o):k3z == V6e && (-X2M == o2o.fileName.indexOf(s45) && -X2M == o2o.fileName.indexOf(w5m) && (o2o.fileName=o2o.fileName.concat(s45)),this.exportData(o2o));}else (N9A != (c2G=o2o.fileExt) && void g1K !== c2G || (C0Q == V6e?o2o.fileExt=i4h:k3z == V6e?o2o.fileExt=a7y:T_W == V6e && (o2o.fileExt=j7x)),s2l != V2X && e0s != V2X || (e0s == V2X && b8x == typeof JSZip?L.BIEA && !L.BIEA10?T$n=!g1K:this.importData(o2o):j$p || C0Q != V6e && k3z != V6e && T_W != V6e || this.importData(o2o)));return T$n;},A._boolFormatter=function(R0b,z7s,P3Z,y9r){return (X2M == y9r?(n5R == P3Z?P3Z=X2M:p12 == P3Z && (P3Z=g1K),P3Z=this._getBooleanValue(P3Z,g1K)):g1K == y9r && (P3Z + N9A == n5R?P3Z=n5R:P3Z + N9A == p12 && (P3Z=p12)),P3Z);},A._checkCrossDomain=function(V29){var M3m="localhost";var f5e="http://";var C2n="https://";var A9P=!X2M,U37=M3m,c0y=W.location;return (V29 && (g1K != V29.toLowerCase().indexOf(f5e) && g1K != V29.toLowerCase().indexOf(C2n) || (c0y && (U37=c0y.protocol + N7A + c0y.host),((c0y=V29.split(n5F))[g1K] + N7A + c0y[s2l]).toLowerCase() != U37.toLowerCase() && (A9P=!g1K))),A9P);},A._encodeBase64=function(Q4k){var G9i=N9A;return G9i=void g1K !== Q4k?btoa(encodeURIComponent(Q4k).replace(/%([0-9A-F]{2})/g,function(x4m,i$E){var W_E="0x";return String.fromCharCode(W_E + i$E);})):G9i;},A._exportJson=function(C2Y,F9p,x3a,G$Y){var G4W="#FontColor";var R0k="FontItalic";var Y3o="Edit";var n91="FontStrike";var r2q="#BackColor";var G1v="#Edit";var s4U="FontUnderline";var o$V="FontBold";for(var G2h,y17,b9n,A3x={data:[]},a2p=T9S,N$q=g1K,q5e={},P1C=N9A,E2e=X2M < this.DataRows,O2V=[o$V,R0k,s4U,n91],R0Q=g1K,e0G=O2V.length,a2p=this.getFirstRow(T9S,y3x);a2p;a2p=this.getNextRow(a2p))if(!a2p || Z3$ !== a2p.id && L7U !== a2p.Name && m5p !== a2p.Name){for((N$q=g1K,G2h=C2Y.length);N$q < G2h;N$q++){if((y17=C2Y[N$q],!E2e || a2p.UnitPos == y17.UnitPos)){if((b9n=y17.Name,P1C=F9p?this._getCellText(a2p,b9n):this._getCellValue(a2p,b9n),y17.Name === G$Y && X2M != P1C))break;if((q5e[b9n]=P1C,x3a))for((this._getBooleanValue(a2p[b9n + Y3o],X2M) || (q5e[b9n + G1v]=g1K),a2p[b9n + Q1_] && (q5e[b9n + r2q]=a2p[b9n + Q1_]),a2p[b9n + t2v] && (q5e[b9n + G4W]=a2p[b9n + t2v]),R0Q=g1K);R0Q < e0G;R0Q++)a2p[b9n + O2V[R0Q]] && (q5e[b9n + H$P + O2V[R0Q]]=X2M);}x3a && (this._getBooleanValue(a2p.RowEdit,X2M) || (q5e.Edit=g1K),a2p.Background && (q5e.BackColor=a2p.Background),a2p.Color && (q5e.FontColor=a2p.Color));}E2e && a2p.UnitPos != this.DataRows - X2M || g1K < Object.keys(q5e).length && (A3x.data.push(q5e),q5e={});}return A3x;},A._exportXml=function(A6N,i8m,t9b){var m1n="<row>";var n0v="</row>";var v6u="]]>";var j4w="<data>";var R2H='<?xml version="1.0" encoding="UTF-8" ?>\r\n';var l$1="<![CDATA[";var g_i="</data>";var j$f,o9x,u$9=[],o$c=T9S,T4w=g1K,D5u=N9A,z7_=X2M < this.DataRows;for((u$9.push(j4w),o$c=this.getFirstRow(T9S,y3x));o$c;o$c=this.getNext(Rowr))if(!o$c || Z3$ !== o$c.id && L7U !== o$c.Name && m5p !== o$c.Name){for((z7_ && g1K != o$c.UnitPos || u$9.push(m1n),T4w=g1K,j$f=A6N.length);T4w < j$f;T4w++)if((o9x=A6N[T4w],!z7_ || o$c.UnitPos == o9x.UnitPos)){if((D5u=i8m?this._getCellText(o$c,o9x.Name):this._getCellValue(o$c,o9x.Name),o9x.Name === t9b && X2M != D5u))break;(u$9.push(E4o + o9x.Name + X_b),_ibsUtil.isEmpty(D5u) || u$9.push(l$1 + D5u + v6u),u$9.push(O0r + o9x.Name + X_b));}z7_ && o$c.UnitPos != this.DataRows - X2M || n0v != u$9[u$9.length - X2M] && u$9.push(n0v);}return (u$9.push(g_i),u$9=R2H + u$9.join(N9A));},A._finishDownload=function(O9_){var Q6i="fileDownloadToken=; expires=";var E22="; path=/";if((O9_=O9_ || C0Q,F.clearInterval(L.fileDownloadCheckTimer),L.fileDownloadCheckTimer=T9S,L.g_down2ExcelSheetID.length)){for(var L7r=g1K;L7r < L.g_down2ExcelSheetID.length;L7r++)L[L.g_down2ExcelSheetID[L7r]].hideMessage();L.g_down2ExcelSheetID=[];}else this.hideMessage();(IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,O9_,!g1K),(O9_=new Date()).setDate(O9_.getDate() - X2M),W.cookie=Q6i + O9_.toGMTString() + E22);},A._getAlignByType=function(Q92){var a7H="right";return this._isBooleanType(Q92)?m$4:this._isNumberType(Q92)?a7H:N$H;},A._getBodyData=function(y3D){var g8F="isNull";var X4d="Spanned";var P5d="Align";var s7Q,D$v,z8Q,M5D,J2v,j5W,n_O,h_4,u6p,Q7t,N0t,w7a,U7j=[],c_i=[],c0B=N9A,H3a=N9A,b4n=N9A,Y2x=y3D.from,z8I=y3D.cfg,x_A=y3D.sheetDesign,i21=y3D.isTreeLevel,y$v=y3D.isDownRows,r71=y3D.isDownRowVisible,E$k=y3D.rowHeights,p1T=y3D.downColNames,h9i=y3D.downColNamesLength,p1n=y3D.data,e8P=y3D.p,D08=y3D.headerRows,Z3R=[],l1K=[],P2Q=[],r6I=[],w3e=g1K,n3_=[],e7R=[],D2U=g1K,b3E=g1K,H0a=[],t5G=N9A,l6s={},J_t=y3D.isSameDownColAndVisible,K5i=this.getCols(),g1l=this.GetFnLib(w_F),y3D=this.GetFnLib(g8F),n9n=this.Cols[this.RowIndex || L1l],L1L=this.MergeAllRanges?E6L:a2f,p8Z=this.MergeAllRanges?Y1D:I5p;if(!n9n.Visible && n9n.Def && h_i === n9n.Def)for(var z3E=g1K;z3E < K5i.length;z3E++)if(K5i[z3E] === (this.RowIndex || L1l)){K5i.splice(z3E,X2M);break;}for((s7Q=g1K,u6p=p1T.length);s7Q < u6p;s7Q++)l6s[p1T[s7Q]]=s7Q;if(z8I.downSum){if(this.Rows.FormulaRow){for((z8Q=this.Rows.FormulaRow,s7Q=g1K);s7Q < this.DataRows && (z8Q && z8Q.Visible);s7Q++){for((g1K == this.FormulaRowPosition && (D08++,Z3R.push(w3e++)),c_i.push(this._getExcelRowHeight(z8Q,s7Q)),C0Q == Y2x && this._setRowProperty(j5W={},z8Q),n_O=[],D$v=g1K);D$v < h9i;D$v++)(w7a=(this.MultiRecord && X2M & this.MultiRecordShape?this._DownMultiMap[s7Q]:p1T)[D$v]) && P31 != w7a && (M5D=void g1K === z8Q[w7a]?N9A:this._getStringExcel(z8Q,w7a,!X2M,z8I,Y2x),H3a=this._addCellColor(x_A,z8Q,w7a),b8x !== (M5D=k3z == Y2x?(M5D + N9A).replace(/\r\n|\n|\r/g,N9A):M5D) && void g1K !== M5D || (M5D=N9A),this.MultiRecord && X2M & this.MultiRecordShape?n_O[D$v]=M5D + H3a:n_O.push(M5D + H3a),C0Q == Y2x && (h_4=d0Q + ((this.MultiRecord && X2M & this.MultiRecordShape?D$v:l6s[w7a]) + X2M),c0B=this.Cols[w7a].Type,void g1K === this._getNumberValue(M5D) && (c0B=o2H),this._setRowData(j5W,h_4,w7a,M5D,c0B),b4n=J_t?z8Q[w7a + I5p]:X2M,j5W[h_4 + a2f]=this.MultiRecord && X2M & this.MultiRecordShape && T9S != this.Cols[w7a].RecordRowSpan?this.Cols[w7a].RecordRowSpan:z8Q[w7a + a2f],j5W[h_4 + I5p]=this.MultiRecord && X2M & this.MultiRecordShape && T9S != this.Cols[w7a].RecordColSpan?this.Cols[w7a].RecordColSpan:b4n,j5W[w7a + a2f]=this.MultiRecord && X2M & this.MultiRecordShape && T9S != this.Cols[w7a].RecordRowSpan?this.Cols[w7a].RecordRowSpan:z8Q[w7a + a2f],j5W[w7a + I5p]=this.MultiRecord && X2M & this.MultiRecordShape && T9S != this.Cols[w7a].RecordColSpan?this.Cols[w7a].RecordColSpan:b4n));(U7j.push(n_O.join(this.IB_DELIMITER_COL)),C0Q == Y2x && this.ExcelXF.push(j5W));}z8Q=this.getNextRow(z8Q);}g1K < U7j.length && g1K == this.FormulaRowPosition && (p1n[e8P++]=U7j.join(this.IB_DELIMITER_ROW),p1n[e8P++]=this.IB_DELIMITER_ROW,E$k=c_i.concat(E$k));}if((void g1K !== z8I.ExcludeFooterRow && (z8I.excludeFooterRow=z8I.ExcludeFooterRow),!z8I.excludeFooterRow))for((y3D(this.ExLoadSEQ) || delete this.ExLoadSEQ,n3_=this.XF.firstChild);n3_;n3_=n3_.nextSibling)if(Z3$ != n3_.id){for((c_i.push(this._getExcelRowHeight(n3_)),footerRowData=[],D$v=g1K);D$v < h9i;D$v++)P31 != (w7a=p1T[D$v]) && (D2U=N0t=this._getStringExcel(n3_,w7a,!X2M,z8I,Y2x),k3z == Y2x && (N0t=(N0t + N9A).replace(/\r\n|\n|\r/g,N9A)),C0Q == Y2x && (c0B=n3_[w7a + W0D] || this.Cols[w7a].Type,void g1K === this._getNumberValue(N0t) && (c0B=o2H),D2U=(D2U+=X2M == x_A && N9A != (N0t=this._addCellColor(x_A,n3_,w7a))?N0t:this.IB_DELIMITER_COLOR) + (N9A != c0B?c0B=this.IB_DELIMITER_COLOR + c0B:this.IB_DELIMITER_COLOR),D2U+=(N0t=n3_[w7a + P5d] || n3_.Def.Align || this.Cols[w7a].Align) && b8x != N0t?this.IB_DELIMITER_COLOR + N0t:this.IB_DELIMITER_COLOR,void g1K !== n3_[w7a + a2f] && (N9A == z8I.downCols || U1$ == z8I.downCols) && this.getAttribute(T9S,w7a,X4d) && g1K < n3_[w7a + I5p]?D2U+=this.IB_DELIMITER_COLOR + n3_[w7a + a2f]:D2U+=this.IB_DELIMITER_COLOR,void g1K === (N0t=n3_[w7a + I5p] || n3_.Def[w7a + I5p] || this.Cols[w7a].Span) || N9A != z8I.downCols && U1$ != z8I.downCols || !this.getAttribute(n3_,T9S,X4d)?D2U+=this.IB_DELIMITER_COLOR + X2M:D2U+=b4n=this.IB_DELIMITER_COLOR + N0t,N0t=n3_[w7a + v$b] || this.Cols[w7a].LegacyFormat || this.Cols[w7a].Format,void g1K !== (N0t=V1N != c0B || N0t?N0t:this.Cols[w7a].DateFormat || this.Cols[w7a].DataFormat) && N9A != N0t && s38 != typeof N0t?(g1K <= c0B.indexOf(R1F) && (X2M < (Q7t=N0t.split(c4D)).length && H$P == Q7t[X2M].charAt(g1K) && (Q7t[X2M]=p12 + Q7t[X2M].slice(X2M),N0t=Q7t.join(c4D))),D2U+=this.IB_DELIMITER_COLOR + N0t):D2U+=this.IB_DELIMITER_COLOR),footerRowData.push(D2U));(e7R.push(footerRowData.join(this.IB_DELIMITER_COL)),b3E++);}var S$Q=g1K,N7f=z8I.downRows && z8I.downRows.split(x2V);for((this.ExLoadSEQ=g1K,z8Q=this.getFirstRow(T9S,y3x));z8Q;z8Q=this.getNextRow(z8Q))if((z8I.downTreeHide || g1K == z8I.downTreeHide && this._getTreeVisible(z8Q)) && (S$Q++,!y$v || -X2M < N7f.indexOf(N9A + S$Q) || r71 && z8Q.Visible))for(var A3i=g1K;A3i < this.DataRows;A3i++)if(!(X2M == z8I.excludeSubSum && L7U === z8Q.Name || s2l == z8I.excludeSubSum && z8Q.CumulateRow || e0s == z8I.excludeSubSum && (L7U === z8Q.Name || z8Q.CumulateRow))){for((C0Q != Y2x && V7R != Y2x || E$k.push(this._getExcelRowHeight(z8Q,A3i)),C0Q == Y2x && (this._setRowProperty(j5W={},z8Q,this.GetStatusValue(z8Q)),L7U === z8Q.Name?l1K.push(w3e++):z8Q.CumulateRow?P2Q.push(w3e++):w3e++),n_O=new Array(h9i),D$v=g1K);D$v < K5i.length;D$v++){var F9A=l6s[K5i[D$v]];if(!(C0Q != Y2x || this.MultiRecord && X2M & this.MultiRecordShape || this.MergeAllRanges && (g1K != this.SearchMode || L7U != z8Q.Name) || K5i.length == h9i)){var g5X=z8Q[K5i[D$v] + (g1K == this.SearchMode && L7U == z8Q.Name?I5p:p8Z)],j3T=g5X;if(!g1l(F9A)){if(X2M < g5X){for(var S88=T9S,A3i=g1K;A3i < g5X;A3i++)this.Cols[K5i[D$v + A3i]].Visible?(S88=S88 || A3i,this.ExLoad && !z8Q[w7a + E6L] && (j5W[K5i[D$v + A3i] + a2f]=z8Q[K5i[D$v] + a2f])):--j3T;j5W[K5i[D$v + S88] + I5p]=j3T;}continue;}if(g1l(F9A))if(!J_t && z8I.downCols && U1$ != z8I.downCols)j5W[K5i[D$v] + I5p]=X2M;else if(X2M < g5X){for(A3i=D$v;A3i < D$v + g5X;A3i++)void g1K === l6s[K5i[A3i]] && --j3T;j5W[K5i[D$v] + I5p]=j3T;}}(F9A=l6s[K5i[D$v]],M5D=N9A,(w7a=this.MultiRecord && X2M & this.MultiRecordShape?this._DownMultiMap[A3i][D$v]:p1T[F9A]) && P31 != w7a && (M5D=this._getStringExcel(z8Q,w7a,!g1K,z8I,Y2x),H3a=this._addCellColor(x_A,z8Q,w7a),L7U !== !z8Q.Name || z8Q.CumulateRow || void g1K !== (J2v=L.OnExportEncryption?L.OnExportEncryption(this,z8Q,w7a,M5D):J2v) && (M5D=J2v),b8x !== M5D && void g1K !== M5D || (M5D=N9A),n_O[this.MultiRecord && X2M & this.MultiRecordShape?D$v:l6s[w7a]]=M5D + H3a,C0Q == Y2x && (h_4=d0Q + ((this.MultiRecord && X2M & this.MultiRecordShape?D$v:l6s[w7a]) + X2M),this._setRowData(j5W,h_4,w7a,M5D,w7a && this.Cols[w7a]?this.Cols[w7a].Type:o2H),T9S != z8Q[w7a + (this.MainTag.offsetHeight && this.MainTag.offsetWidth && z8Q.Name && L7U == z8Q.Name?a2f:L1L)] && (j5W[h_4 + a2f]=j5W[w7a + a2f] || z8Q[w7a + (this.MainTag.offsetHeight && this.MainTag.offsetWidth && z8Q.Name && L7U == z8Q.Name?a2f:L1L)],X2M < j5W[h_4 + a2f] && T9S == j5W[h_4 + I5p] && (j5W[h_4 + I5p]=X2M),this.MergeVisibleDom && delete z8Q[w7a + E6L]),T9S != z8Q[w7a + (this.MainTag.offsetHeight && this.MainTag.offsetWidth && z8Q.Name && L7U == z8Q.Name?I5p:p8Z)] && (j5W[h_4 + I5p]=j5W[w7a + I5p] || z8Q[w7a + (this.MainTag.offsetHeight && this.MainTag.offsetWidth && z8Q.Name && L7U == z8Q.Name?I5p:p8Z)],X2M < j5W[h_4 + I5p] && T9S == j5W[h_4 + a2f] && (j5W[h_4 + a2f]=X2M),this.MergeVisibleDom && delete z8Q[w7a + Y1D]),w7a && this.MultiRecord && X2M & this.MultiRecordShape && T9S != this.Cols[w7a].RecordRowSpan && this._DownMultiMap[A3i][D$v] && (j5W[h_4 + a2f]=this.Cols[w7a].RecordRowSpan),w7a && this.MultiRecord && X2M & this.MultiRecordShape && T9S != this.Cols[w7a].RecordColSpan && this._DownMultiMap[A3i][D$v] && (j5W[h_4 + I5p]=this.Cols[w7a].RecordColSpan)),i21 && this.MainCol == w7a && (n_O[l6s[w7a]]=z8Q.Level + H3a)));}(p1n[e8P++]=n_O.join(this.IB_DELIMITER_COL),p1n[e8P++]=this.IB_DELIMITER_ROW,C0Q == Y2x && this.ExcelXB.push(j5W));}if((this.ExLoadSEQ && delete this.ExLoadSEQ,C0Q == Y2x && z8I.useFormula))for(D$v=g1K;D$v < h9i;D$v++)if((w7a=p1T[D$v],(t5G=this.Cols[w7a].Formula) && S$i == typeof t5G)){for(var v_0,H8h,o4S=this.getColIndex(this.getLastCol());g1K <= o4S;o4S--)if((v_0=this.getColByIndex(o4S)) && -X2M < (H8h=t5G.indexOf(v_0)) && x2V !== t5G.charAt(H8h - X2M)){if((H8h=p1T.indexOf(v_0)) < g1K){t5G=N9A;break;}t5G=t5G.replaceAll(v_0,x2V + v_0 + x2V);}t5G && H0a.push({SaveName:w7a,Formula:t5G});}if(g1K < U7j.length && z8I.downSum && g1K != this.FormulaRowPosition)for((p1n[e8P++]=U7j.join(this.IB_DELIMITER_ROW),p1n[e8P++]=this.IB_DELIMITER_ROW,E$k=E$k.concat(c_i),s7Q=g1K);s7Q < this.DataRows;s7Q++)Z3R.push(w3e++);if(g1K < e7R.length)for((p1n[e8P++]=e7R.join(this.IB_DELIMITER_ROW),p1n[e8P++]=this.IB_DELIMITER_ROW,E$k=E$k.concat(c_i),s7Q=g1K);s7Q < b3E;s7Q++)r6I.push(w3e++);return {p:e8P,data:p1n,headerRows:D08,rowHeights:E$k,footRow:r6I,sumRow:Z3R,subSumRow:l1K,cumulateRow:P2Q,formulas:H0a};},A._getBooleanValue=function(a3L,I3n){var Y7s=I3n,N3C={1:X2M,true:X2M,0:g1K,false:g1K};return (this.BooleanSettingMode?Y7s=void g1K === a3L?I3n:a3L && p12 != a3L?X2M:g1K:void g1K !== N3C[a3L=(a3L + N9A).toLowerCase()] && (Y7s=N3C[a3L]),Y7s);},A._getCCSStylesheetRuleStyle=function(z8v,S7p){var D6Y="initial";var y_p="rules";var h9v="cssRules";var e4B,t9F,m43,u0a,e9z,Y5N,z$r=N9A;for((S7p=S7p.toLowerCase(),m43=W.all?y_p:h9v,u0a=g1K);u0a < W.styleSheets.length;u0a++){try{t9F=W.styleSheets[u0a][m43];}catch(T6r){continue;}if(t9F)for(e9z=g1K;e9z < t9F.length;e9z++)if(t9F[e9z] && t9F[e9z].selectorText && -X2M != t9F[e9z].selectorText.indexOf(z8v) && t9F[e9z].cssText && -X2M != t9F[e9z].cssText.indexOf(S7p)){for(e4B=t9F[e9z].style;;){if(-X2M == (Y5N=S7p.indexOf(z9y)))break;S7p=S7p.substring(g1K,Y5N) + S7p[Y5N + X2M].toUpperCase() + S7p.substring(Y5N + s2l);}e4B[S7p] && D6Y != e4B[S7p] && (z$r=e4B[S7p]);}}return z$r;},A._getCellText=function(Z4p,f06){var l87="GroupSumType";var C_T="|| |";var A3u="Button";var F2W="FooterRow";var A4y,d5t=N9A,M_I=this.getType(Z4p,f06),G40=L.get(Z4p,f06) + N9A,A8n=this.GetFnLib(U4e);if(!Z4p || !f06)return d5t;if(Q1E !== Z4p.Kind && g3X === this.MainCol && this.GroupTreeCols && F2W !== Z4p.id && Z3$ !== Z4p.id){if(this.GroupTreeCols[f06] && !Z4p.Def.Group)return N9A;if(Z4p.Def.Group && !this.GroupTreeCols[f06] && !this.getAttribute(Z4p,f06,l87))return N9A;}return (Q1E == Z4p.Kind?d5t=L9d == M_I?this.getString(Z4p,f06):this._removeHTMLTag(this.getString(Z4p,f06)):m3N == M_I?d5t=this._getPasswordType(Z4p,f06,G40):this._isBooleanType(M_I)?(A4y=this.getAttribute(Z4p,f06,q3X),d5t=x4x == M_I && A4y?this.getString(Z4p,f06):this._getBooleanValue(G40,g1K)):A8n(G40) && a_X == M_I?d5t=(A4y=G40.split(G40.charAt(g1K))).length?(N9A == A4y[X2M] || N9A != A4y[s2l] && T9S != A4y[s2l]?(N9A == A4y[s2l] || T9S == A4y[s2l] || A4y.length < e0s) && (A4y[s2l]=l7A):A4y[s2l]=A4y[X2M],p1z != Z4p.Kind?A4y.join(G40.charAt(g1K)):A4y[s2l]):p1z != Z4p.Kind?C_T:N9A:A3u == M_I?d5t=G40?G40 + N9A:N9A:(d5t=n0f == M_I || R1F == M_I?G40:N9A == G40 && q3X != M_I?N9A:this.getString(Z4p,f06),Z3$ === Z4p.id?(g1K == G40 && void g1K !== this.SumZeroValue && (d5t=this.SumZeroValue),o2H == M_I && (d5t=G40)):p1z == Z4p.Kind && f06 == (this.RowIndex || L1l) && b8x == d5t && (d5t=N9A),this.DataAutoTrim && S$i == typeof d5t && o5Q == Z4p.Kind && (d5t=this._trim(d5t))),d5t);},A._getCellValue=function(O23,F1b){var B1S="AutoSum";var T$j="FormatFix";var f$a="CheckBox";var d$q="AutoAvg";var v7j="Popup";var l2h="ComboEdit";var m2d="PopupEdit";var h0n="(ALL)";var U3o="DummyCheck";this.Lang.Format;var V0J,f44=N9A,j$U=this.getAttribute(O23,F1b,k5H),N98=O23 && Z3$ == O23.id?this.getType(O23,F1b):this.getAttribute(O23,F1b,a9S) || this.getAttribute(O23,F1b,W0D);if(this.getAttribute(O23,F1b,T$j))return this._getCellText(O23,F1b);switch((f44=this.getValue(O23,F1b),S5o == O23.Kind && h0n === (f44 + N9A).toUpperCase() && (f44=N9A),Q1E == O23.Kind && L9d == this.Cols[F1b].Type && (f44=this.getString(O23,F1b)),N98=x4x == N98 && j$U?q3X:N98)){case N1D:f44=this._getStatusTypeCellValue(N98,O23,F1b,f44);break;case o2H:case v7j:case m2d:f44=this._getTextTypeCellValue(N98,O23,F1b,f44);break;case V1N:(V0J=this.getAttribute(O23,F1b,o1o) || this.getAttribute(O23,F1b,v$b) || this.getAttribute(O23,F1b,x6K) || this.getAttribute(O23,F1b,n1q) || this.DateFormat || this.DataFormat,S$i == typeof (f44=L.dateToString(this.getValue(O23,F1b),V0J)) && (f44=this._removeHTMLTag(f44)));break;case n0f:case R1F:case B1S:case d$q:f44=this._getNumberTypeCellValue(N98,O23,F1b,f44);break;case q41:case f$a:case I45:case x4x:case U3o:f44=this._getCheckBoxTypeCellValue(N98,O23,F1b,f44);break;case u3l:case q3X:f44=this._getComboTypeCellValue(N98,O23,F1b,f44);break;case l2h:f44=this._getComboEditTypeCellValue(N98,O23,F1b,f44);}return f44=this.DataAutoTrim && S$i == typeof f44 && o5Q == O23.Kind?IBSheet._ibsUtil.trim(f44):f44;},A._getCheckBoxTypeCellValue=function(H8K,M$t,s_3,i9J){(this.getAttribute(M$t,s_3,q3X),this.getAttribute(M$t,s_3,k5H),i9J=i9J?+i9J:g1K);return i9J=g1K === this.GetCellValueMode?this._boolFormatter(M$t,s_3,i9J,g1K):i9J;},A._getColInfo=function(t06,P6i,a30){var j4g="Lines";var y7i="IBTreeLevelCol|";var m8z="30|";var m$b=/Format/i;var P1c="[object Function]";var J4g="Text|";var s0A="Int|";for(var d4k,G43,K_z,d9m,t4f,N3w=N9A,n93=N9A,Z_K=N9A,x35=N9A,E14=N9A,r4J=N9A,Z6y=N9A,D2a=N9A,f1G=N9A,y_4=N9A,p58=N9A,D1g=t06.hiddenColumn,T8P=t06.numberTypeToText,r4L=t06.allTypeToText,u$F=P6i.length,U57=N9A,C3a=N9A,h9h=N9A,h0L={Int:X2M,Float:X2M,AutoSum:X2M,AutoAvg:X2M},V6$={Enum:X2M,Combo:X2M,ComboEdit:X2M},V_M={left:X2M,center:X2M,right:X2M},T2z=g1K;T2z < this.DataRows;T2z++){for((G43=this.Cols,d4k=g1K);d4k < u$F;d4k++){var c0L,T01=(this.MultiRecord && X2M & this.MultiRecordShape?this._DownMultiMap[T2z]:P6i)[d4k];(g1K == T2z && (N3w+=(T01 && void g1K !== G43[T01].Name?G43[T01].Name:N9A) + x2V,n93+=this._getNumberValue(!T01 && this.MultiRecord && X2M & this.MultiRecordShape?this.MultiHeaderColSpan[this.MultiHeaderMap[T2z][d4k]][d4k - this._DownMultiMap[T2z].indexOf(this.MultiHeaderMap[T2z][d4k]) - X2M] + G43[this.MultiHeaderMap[T2z][d4k]].WidthPad:g1K == G43[T01].Visible && G43[T01].RelWidth?g1K:G43[T01].Width || G43[T01].MinWidth || this.MinMidWidth,g1K) + x2V,Z_K+=(X2M == D1g?G43[T01].Visible:n5R) + x2V,a30 && this.MainCol == T01 && (N3w+=y7i,n93+=m8z,Z_K+=y2_)),x35+=(T01 && void g1K !== G43[T01].SaveName?G43[T01].SaveName:T01 && void g1K !== G43[T01].Name?G43[T01].Name:N9A) + x2V,K_z=T01?G43[T01].LegacyType || G43[T01].Type:N9A,U57=T01?G43[T01].LegacyFormat || G43[T01].Format:N9A,d9m=T01?G43[T01].FormulaRow:N9A,t06.downRowSpan && (t4f=T01 && !G43[T01].ColMerge?p12:n5R,h9h+=N9A === h9h?t4f:x2V + t4f),S$i != typeof (U57=V1N != K_z || U57?U57:G43[T01].DateFormat || this.DateFormat || G43[T01].DataFormat || this.DataFormat)?U57=(void g1K !== U57 && P1c !== Object.prototype.toString.call(U57) && m_7 !== Object.prototype.toString.call(U57) && M3J != typeof U57 && Object.prototype.toString.call(U57),N9A):o2H != K_z && j4g != K_z && m3N != K_z && a_X != K_z && g92 != K_z || (U57=N9A),E14+=V_M[r4J=this.Group && g1K < this.Group.length && (this.GroupMain?this.GroupMain == T01:this.Group.split(B4i)[g1K] == T01)?N$H:T01?(G43[T01].Align + N9A).toLowerCase():N9A]?r4J + x2V:this._getAlignByType(K_z) + x2V,h0L[K_z]?T8P?(Z6y+=J4g,D2a+=x2V,f1G+=x2V,y_4+=x2V):(Z6y+=K_z + x2V,D2a+=(U57 || N9A) + x2V,c0L=this._getDateFormatPattern(K_z,U57),f1G+=(G43[T01].OrgFormat || c0L.replace(m$b,N9A)) + x2V,y_4+=c0L + x2V):r4L && !V6$[K_z]?(Z6y+=J4g,D2a+=x2V,f1G+=x2V,y_4+=x2V):(Z6y+=(q3X == K_z || x4x == K_z && G43[T01].Enum?u3l:K_z) + x2V,D2a+=V1N === K_z?(U57 || N9A) + x2V:(U57?this.ConvertExcelFormat({type:K_z,format:U57}):N9A) + x2V,c0L=this._getDateFormatPattern(K_z,U57),f1G+=(T01 && G43[T01].OrgFormat?G43[T01].OrgFormat:c0L.replace(m$b,N9A)) + x2V,y_4+=c0L + x2V),C3a+=d9m?d9m + x2V:x2V,a30 && this.MainCol == T01 && (x35+=y7i,E14+=J0z,Z6y+=s0A,D2a+=x2V,f1G+=x2V,y_4+=x2V,C3a+=x2V),p58+=x2V + (G43[T01] && G43[T01].DataFormat?G43[T01].DataFormat:N9A));}(p58=p58.substring(X2M),x35=x35.substring(g1K,x35.length - X2M),E14=E14.substring(g1K,E14.length - X2M),Z6y=Z6y.substring(g1K,Z6y.length - X2M),D2a=D2a.substring(g1K,D2a.length - X2M),f1G=f1G.substring(g1K,f1G.length - X2M),y_4=y_4.substring(g1K,y_4.length - X2M),C3a=C3a.substring(g1K,C3a.length - X2M),X2M < this.DataRows && T2z < this.DataRows - X2M && (x35+=g_q,E14+=g_q,Z6y+=g_q,D2a+=g_q,f1G+=g_q,y_4+=g_q,p58+=g_q,C3a+=g_q));}return {name:N3w=N3w.substring(g1K,N3w.length - X2M),width:n93=n93.substring(g1K,n93.length - X2M),visible:Z_K=Z_K.substring(g1K,Z_K.length - X2M),saveName:x35,align:E14,type:Z6y,format:D2a,orgFormat:f1G,datePattern:y_4,dataFormat:p58,formulaRow:C3a,colMerge:h9h};},A._getComboEditTypeCellValue=function(E8Q,V$5,F1D,x8e){var T8s,x3c,c2Q,W2u=this.getAttribute(V$5,F1D,k5H),F1D=this.getAttribute(V$5,F1D,q3X),O6E=g1K,C48=x8e,W2u=W2u && (N9A + W2u).substring(X2M),F1D=F1D && (N9A + F1D).substring(X2M);if(Q1E != V$5.Kind && F1D)for((x3c=F1D.split(x2V),T8s=W2u.split(x2V),c2Q=x3c.length,O6E=g1K);O6E < c2Q;O6E++)if(x8e == x3c[O6E]){C48=T8s[O6E];break;}return C48;},A._getComboTypeCellValue=function(G7y,O1E,U4b,V0N){var F4o,A8i,l0q=g1K,Y7D=g1K,n7p=V0N,U4b=(U4b=this.getAttribute(O1E,U4b,k5H)) && (N9A + U4b).substring(X2M);if(Q1E != O1E.Kind){if(U4b)for((F4o=(A8i=U4b.split(x2V)).length,Y7D=g1K);Y7D < F4o;Y7D++)if(V0N == A8i[Y7D]){(l0q=X2M,n7p=V0N);break;}l0q || (n7p=N9A);}return n7p;},A._getCookie=function(H9v){var B74,V0W=g1K,G3c=g1K;H9v+=n6c;try{for(;V0W <= W.cookie.length;){if((B74=V0W + H9v.length,W.cookie.substring(V0W,B74) == H9v))return (-X2M == (G3c=W.cookie.indexOf(h_W,B74)) && (G3c=W.cookie.length),unescape(W.cookie.substring(B74,G3c)));if(g1K == (V0W=W.cookie.indexOf(l7A,V0W) + X2M))break;}}catch(I$8){}return N9A;},A._getDateFormat=function(Y8Y){var T1Y="HH:mm";var x6J="yyyy/MM/dd HH:mm";var t9a="MM/dd";var P2h="yyyy/MM";var X$h="yyyy/MM/dd HH:mm:ss";var g0W="yyyy/MM/dd";var k8m=g0W;return (Y8Y && (s2L == Y8Y?k8m=g0W:K9Y == Y8Y?k8m=P2h:U8L == Y8Y?k8m=t9a:u7v == Y8Y?k8m=X$h:F4u == Y8Y?k8m=x6J:W8Z == Y8Y?k8m=g2s:h$0 == Y8Y && (k8m=T1Y)),k8m);},A._getDateFormatPattern=function(c2L,x8f){var j2A="Hms";var f5$=/^y.*M.*d.*H.*m.*s$/i;var W5A=/^y.*M$/;var N7u=/^y.*d.*M$/;var i3Q=/^M.*y.*d.*H.*m.*s$/i;var G_D=/^H.*m$/i;var R7H="Ym";var b4s=/^d.*M$/;var f3J=/^M.*y$/;var V9b=/^M.*d.*y.*H.*m.*s$/i;var W9y=/^M.*y.*d.*H.*m$/i;var Y0z=/^y.*d.*M.*H.*m.*s$/i;var h0p=/^M.*d.*y.*H.*m$/i;var g5z=/^d.*M.*y.*H.*m.*s$/i;var d2u=/^y.*d.*M.*H.*m$/i;var X8F="Ymd";var N89="YmdHms";var Y_P=/^d.*M.*y$/;var D_H="Md";var R0r=/^y.*M.*d$/;var s$i=/^d.*y.*M$/;var z_v=/^d.*y.*M.*H.*m$/i;var I4R=/^M.*d$/;var W06=/^y.*M.*d.*H.*m$/i;var A7F="Hm";var J7k="YmdHm";var G0_=/^M.*d.*y$/;var n0g=/^H.*m.*s$/i;var n0N=/^d.*M.*y.*H.*m$/i;var k8L=/^M.*y.*d$/;var J3v=/^d.*y.*M.*H.*m.*s$/i;var x0g=N9A;return (c2L && (x8f=V1N !== c2L || x8f?x8f:X8F) && (X8F == x8f || g1K <= x8f.search(R0r) || g1K <= x8f.search(N7u) || g1K <= x8f.search(k8L) || g1K <= x8f.search(G0_) || g1K <= x8f.search(Y_P) || g1K <= x8f.search(s$i)?x0g=s2L:R7H == x8f || g1K <= x8f.search(W5A) || g1K <= x8f.search(f3J)?x0g=K9Y:D_H == x8f || g1K <= x8f.search(I4R) || g1K <= x8f.search(b4s)?x0g=U8L:N89 == x8f || g1K <= x8f.search(f5$) || g1K <= x8f.search(Y0z) || g1K <= x8f.search(i3Q) || g1K <= x8f.search(V9b) || g1K <= x8f.search(g5z) || g1K <= x8f.search(J3v)?x0g=u7v:J7k == x8f || g1K <= x8f.search(W06) || g1K <= x8f.search(d2u) || g1K <= x8f.search(W9y) || g1K <= x8f.search(h0p) || g1K <= x8f.search(n0N) || g1K <= x8f.search(z_v)?x0g=F4u:j2A == x8f || g1K <= x8f.search(n0g)?x0g=W8Z:(A7F == x8f || g1K <= x8f.search(G_D)) && (x0g=h$0)),x0g);},A._getDefault=function(f5Z,z1a,y2V){if(void g1K === f5Z || T9S == f5Z)return z1a;switch(y2V || typeof z1a){case M3J:return this._getNumberValue(f5Z,z1a);case i8B:return this._getNumberValue(f5Z,z1a,X2M);case S$i:return g1K == f5Z.length?z1a:f5Z + N9A;case m9a:return this._getBooleanValue(f5Z,z1a);default:return z1a;}},A._getDownColNames=function(z_U){var a57,x92,K4X,A8f,A6M,D$X=[],V40=[],E3W=[],o0s=[],l78=[];if(N9A != z_U.downCols)for((a57=g1K,x92=(D$X=U1$ === z_U.downCols?this.getCols(U1$):z_U.downCols.split(x2V)).length);a57 < x92;a57++){if(!this.Cols[D$X[a57]])return [];this.GetColName(D$X[a57]) && V40.push(this.GetColName(D$X[a57]));}else for(K4X=this.GetFirstColA(T9S,s2l);K4X;K4X=this.GetNextColA(K4X))g3X !== K4X && H_Q !== K4X && this.Cols[K4X].CanExport && V40.push(K4X);for((D$X=[],z_U.objReturn && (o0s=[],l78=[]),-X2M == z_U.mode?E3W={Status:X2M,DelCheck:X2M,Result:X2M}:X2M == z_U.mode && (E3W={Status:X2M,DelCheck:X2M}),a57=g1K,x92=V40.length);a57 < x92;a57++)(K4X=V40[a57]) && (A8f=this.Cols[K4X].LegacyType || this.Cols[K4X].Type,A6M=this.Cols[K4X].Hidden,E3W[A8f] || (-X2M == z_U.mode || s2l == z_U.mode) && A6M || (z_U.objReturn?(o0s[K4X]=this.Cols[K4X],l78.push(K4X)):D$X.push(K4X)));return (z_U.objReturn && (D$X[g1K]=o0s,D$X[X2M]=l78),D$X);},A._getHeaderData=function(K9n){var R6h="TreeLevel";var Y_L="RecordRowSpan";var f2r="RecordColSpan";var W43="HtmlPrefix";var B2T="Required";var H99="\0";var r3K="HtmlPostfix";var W9o="(*)";var X1c,s_L,i7N,V$Q,g2_,Z_v,d$h,B9R=K9n.from,K7s=K9n.cfg,v_Z=K9n.sheetDesign,j0O=K9n.isTreeLevel,K9H=(K9n.isDownRows,K9n.isDownRowVisible,K9n.rowHeights),k5E=K9n.downColNames,d_C=K9n.downColNamesLength,Y$B=K9n.data,w0G=K9n.p,F_S=K9n.headerRows,W45=K9n.isHeaderMerge,P9V={},I$a=this.getCols(),s8V=K9n.isSameDownColAndVisible,s4D=this.Style + B2T,K9n=this.Cols[this.RowIndex || L1l],a_g=this.GetFnLib(w_F),I_g={};if(!K9n.Visible && K9n.Def && h_i === K9n.Def)for(var k_h=g1K;k_h < I$a.length;k_h++)if(I$a[k_h] === (this.RowIndex || L1l)){I$a.splice(k_h,X2M);break;}for((g6i=g1K,m6H=k5E.length);g6i < m6H;g6i++)P9V[k5E[g6i]]=g6i;for(var C84=this.ExLoad || !s8V?E6L:a2f,m$O=this.ExLoad || !s8V?Y1D:I5p,g6i=g1K,m6H=this.XH.childNodes.length;g6i < m6H;g6i++)if(Q1E == (s_L=GetNode(this.XH,g6i)).Kind && s_L.Visible)for(var P7M=g1K;P7M < this.DataRows;P7M++){for((F_S++,C0Q != B9R && V7R != B9R || K9H.push(this._getExcelRowHeight(s_L,P7M)),C0Q == B9R && this._setRowProperty(g2_={},s_L),Z_v=new Array(k5E.length),X1c=g1K);X1c < (this.MultiRecord && X2M & this.MultiRecordShape?this.MultiHeaderMap[P7M]:I$a).length;X1c++){var Q8F,K60,H38;if(!(C0Q != B9R || this.MultiRecord && X2M & this.MultiRecordShape || this.MergeAllRanges || I$a.length == d_C)){var Y1x=s_L[I$a[X1c] + I5p];if(!a_g(P9V[I$a[X1c]])){if(s8V || d_C == I$a.length){if(g1K < Y1x){for(var Y0L=T9S,P7M=g1K;P7M < s_L[I$a[X1c] + I5p];P7M++)this.Cols[I$a[X1c + P7M]].Visible?Y0L=Y0L || P7M:--Y1x;g2_[I$a[X1c + Y0L] + I5p]=Y1x;}}else g2_[I$a[X1c] + I5p]=X2M;continue;}if(a_g(P9V[I$a[X1c]]) && g1K < Y1x)if(s8V || d_C == I$a.length){for(P7M=X1c;P7M < X1c + s_L[I$a[X1c] + I5p];P7M++)void g1K === P9V[I$a[P7M]] && --Y1x;g2_[I$a[X1c] + I5p]=Y1x;}else g2_[I$a[X1c] + I5p]=X2M;}(Q8F=P9V[I$a[X1c]],(Q8F=this.MultiRecord && X2M & this.MultiRecordShape?this.MultiHeaderMap[P7M][X1c]:k5E[Q8F]) && P31 != Q8F && (H38=N9A,K7s.RequiredMark && (K60=this.Cols,Q8F && X2M == K60[Q8F].Required && (W45?(g1K <= (s_L[Q8F + W43] + N9A || N9A).indexOf(s4D) || g1K <= (s_L[Q8F + r3K] + N9A || N9A).indexOf(s4D)) && (H38=W9o):(K60=X2M,this.Rows.Filter && (K60+=X2M),this.Rows.FormulaRow && g1K == this.GetAutoSumPosition() && (K60+=X2M),g6i == m6H - K60 && (H38=W9o)))),K60=N9A,Q8F && L9d == this.Cols[Q8F].Type?K60+=this._getCellValue(s_L,Q8F):K60=s_L[Q8F + H8F] || this._getCellText(s_L,Q8F),Q8F && this.MultiRecord && X2M & this.MultiRecordShape && this.MultiHColSpan && this.MultiHColSpan && M3J == typeof this.MultiHColSpanValue[g1K][Q8F] && g1K < this.MultiHColSpanValue[P7M][Q8F] && (K60=this.MultiHColSpanTitle[P7M][Q8F]),Q8F && this.MultiRecord && X2M & this.MultiRecordShape && this.MultiHeaderMerge && (i7N=this.MultiHeaderMergeMap[P7M][X1c],K60=this._getCellText(s_L,i7N)),k3z == B9R && (K60=(K60 + N9A).replace(/\r\n|\n|\r/g,N9A)),V$Q=this._addCellColor(v_Z,s_L,Q8F),d$h=this._addCellFontColor(v_Z,s_L,Q8F),H38=(K60=b8x != (K60=K60 && (K60 + N9A).replace(H99,N9A)) && T9S != K60?K60:N9A) + H38,N9A != V$Q?H38+=V$Q + d$h:N9A != d$h && (H38+=this.IB_DELIMITER_COLOR + d$h),Z_v[this.MultiRecord && X2M & this.MultiRecordShape?X1c:P9V[Q8F]]=H38,C0Q == B9R && (d$h=d0Q + ((this.MultiRecord && X2M & this.MultiRecordShape?X1c:P9V[Q8F]) + X2M),this.ExcelColsMap[Q8F]=d$h,this._setRowData(g2_,d$h,Q8F,K60,this.Cols[Q8F].Type),T9S != s_L[Q8F + C84] && (g2_[d$h + a2f]=g2_[Q8F + a2f] || s_L[Q8F + C84],X2M < g2_[d$h + a2f] && T9S == g2_[d$h + I5p] && (g2_[d$h + I5p]=X2M),delete s_L[Q8F + E6L]),T9S != s_L[Q8F + m$O] && (g2_[d$h + I5p]=g2_[Q8F + I5p] || s_L[Q8F + m$O],X2M < g2_[d$h + I5p] && T9S == g2_[d$h + a2f] && (g2_[d$h + a2f]=X2M),delete s_L[Q8F + Y1D]),Q8F && this.MultiRecord && X2M & this.MultiRecordShape && (this.MultiHColSpan && M3J == typeof this.MultiHColSpanValue[g1K][Q8F]?g1K < this.MultiHColSpanValue[P7M][Q8F]?(g2_[d$h + I5p]=this.MultiHColSpanValue[P7M][Q8F],g2_[d$h]=this.MultiHColSpanTitle[P7M][Q8F],I_g[Q8F]=!g1K):g1K === this.MultiHColSpanValue[P7M][Q8F] && g1K < this.Cols[Q8F].RecordRowSpan && I_g[Q8F]?(g2_[d$h + a2f]=this.Cols[Q8F].RecordRowSpan - P7M,I_g[Q8F]=!X2M):this.MultiHColSpanValue[P7M][Q8F] < g1K && (g2_[d$h + I5p]=g1K,I_g[Q8F]=!g1K):this.MultiHeaderMerge && (i7N != Q8F || s_L[Q8F + f2r] || s_L[Q8F + Y_L])?(i7N != Q8F && (g2_[d$h + I5p]=g1K,g2_[d$h + a2f]=g1K),s_L[Q8F + f2r] && (g2_[d$h + I5p]=s_L[Q8F + f2r]),s_L[Q8F + Y_L] && (g2_[d$h + a2f]=s_L[Q8F + Y_L])):(T9S != this.Cols[Q8F].RecordRowSpan && this._DownMultiMap[P7M][X1c] && (g2_[d$h + a2f]=this.Cols[Q8F].RecordRowSpan),T9S != this.Cols[Q8F].RecordColSpan && this._DownMultiMap[P7M][X1c] && (g2_[d$h + I5p]=this.Cols[Q8F].RecordColSpan)))),j0O && this.MainCol == Q8F && (Z_v[P9V[Q8F]]=R6h + V$Q)));}(Y$B[w0G++]=Z_v.join(this.IB_DELIMITER_COL),Y$B[w0G++]=this.IB_DELIMITER_ROW,C0Q == B9R && this.ExcelXH.push(g2_));}return {p:w0G,headerRows:F_S};},A._getHeaderText=function(W1w){var C7k,L_l,v2r,b1X,w7Y=N9A,g7I=W1w.length,W_s=[];if(this.MultiRecord && X2M & this.MultiRecordShape)for(var t7R=g1K;t7R < this.DataRows;t7R++)for(var G$j=g1K;G$j < this.MultiHeaderMap[g1K].length;G$j++)W_s.push(this.MultiHeaderMap[t7R][G$j]);for((t7R=g1K,C7k=this.XH.childNodes.length);t7R < C7k;t7R++)if(Q1E == (v2r=GetNode(this.XH,t7R)).Kind){for((G$j=g1K,L_l=g7I);G$j < L_l;G$j++)W1w[G$j]?(b1X=this.Cols[W1w[G$j]].Name,L9d == this.Cols[b1X].Type?w7Y+=this._getCellValue(v2r,b1X) + x2V:v2r[b1X + H8F]?w7Y+=v2r[b1X + H8F] + x2V:w7Y+=this._getCellText(v2r,b1X) + x2V):w7Y+=this._getCellText(v2r,W_s[G$j]) + x2V;(w7Y=w7Y.substring(g1K,w7Y.length - X2M),t7R < C7k - X2M && (w7Y+=g_q));}return w7Y;},A._getNumberTypeCellValue=function(u1r,J2r,Z45,k0J){var w73=parseFloat(k0J);return w73=isNaN(w73)?+k0J + N9A == k0J?+k0J:k0J:w73;},A._getNumberValue=function(p_2,A$A,b95,W0s,w6N){var K5l=A$A;return (void g1K === p_2 || isNaN(p_2) || (K5l=p_2=b95?parseFloat(p_2):parseInt(p_2,q$Y),isNaN(p_2)?K5l=A$A:(void g1K !== W0s && p_2 < W0s && (K5l=A$A),void g1K !== w6N && w6N < p_2 && (K5l=A$A))),K5l);},A._getPasswordType=function(K4N,D3$,o4h){var t2h="Password";var W_6="StaticPassword";var O7f,I5u=N9A,k9n=g1K;if(g1K == this.getAttribute(K4N,D3$,W_6))for((k9n=g1K,O7f=o4h.length);k9n < O7f;k9n++)I5u+=t1F;else I5u=this.getMessage(t2h);return I5u;},A._getStatusTypeCellValue=function(I2o,V1r,Q10,M9J){var x7k="R";var e6E=M9J;return e6E=({I:X2M,U:X2M,D:X2M})[M9J]?e6E:x7k;},A._getTextTypeCellValue=function(M4v,j9$,W9F,n_2){this.getAttribute(j9$,W9F,o1o) || this.getAttribute(j9$,W9F,v$b);return this.getString(j9$,W9F) + N9A;},A._getTitleConfig=function(k4r){var g_1="0|";for(var w83,G9M=k4r,X2Y=N9A,N4W=N9A,V0$=N9A,W1e={},U1s=N9A,G_t=N9A,Q7V=N9A,w5l=N9A,z3e=N9A,I$l=N9A,P1g=N9A,j04=g1K,y8Q={left:X2M,center:X2M,right:X2M},j04=g1K,D8a=G9M.length;j04 < D8a;j04++)(void g1K === G9M[j04].text && (G9M[j04].text=N9A),void g1K === G9M[j04].Text && (G9M[j04].Text=N9A),X2Y+=(G9M[j04].text || G9M[j04].Text) + this.IB_DELIMITER_TITLE_BACKSLASH,N4W+=y8Q[w83=((G9M[j04].align || G9M[j04].Align) + N9A).toLowerCase()]?w83 + x2V:J0z,V0$+=this._getNumberValue(G9M[j04].height || G9M[j04].Height,g1K) + x2V,(W1e=G9M[j04].style || G9M[j04].Style) && s38 == typeof W1e?(U1s+=this._getBooleanValue(W1e.fontBold || W1e.FontBold,g1K) + x2V,void g1K === W1e.fontName && (W1e.fontName=N9A),void g1K === W1e.FontName && (W1e.FontName=N9A),Q7V+=(W1e.fontName || W1e.FontName) + x2V,w5l+=this._getNumberValue(W1e.fontSize || W1e.FontSize,g1K) + x2V,z3e+=this._getBooleanValue(W1e.fontUnderline || W1e.FontUnderline,g1K) + x2V,G_t+=L._ibsUtil.getWebColor(W1e.fontColor || W1e.FontColor,X2M) + x2V,I$l+=L._ibsUtil.getWebColor(W1e.backColor || W1e.BackColor,X2M) + x2V,P1g+=this._getBooleanValue(W1e.border || W1e.Border,X2M) + x2V):(U1s+=g_1,Q7V+=x2V,w5l+=g_1,z3e+=g_1,G_t+=x2V,I$l+=x2V,P1g+=y2_));return {text:X2Y=X2Y.substring(g1K,X2Y.length - X2M),align:N4W=N4W.substring(g1K,N4W.length - X2M),height:V0$=V0$.substring(g1K,V0$.length - X2M),fontBold:U1s=U1s.substring(g1K,U1s.length - X2M),fontColor:G_t=G_t.substring(g1K,G_t.length - X2M),fontName:Q7V=Q7V.substring(g1K,Q7V.length - X2M),fontSize:w5l=w5l.substring(g1K,w5l.length - X2M),fontUnderline:z3e=z3e.substring(g1K,z3e.length - X2M),backColor:I$l=I$l.substring(g1K,I$l.length - X2M),border:P1g=P1g.substring(g1K,P1g.length - X2M)};},A._getTreeVisible=function(m8o){var X6D;return !this.MainCol || (g1K == m8o.Level || !!m8o.parentNode && (g1K != (X6D=m8o.parentNode).Expanded && g1K != X6D.Visible && this._getTreeVisible(m8o.parentNode)));},A._isBooleanType=function(r_9){return !!({CheckBox:X2M,DelCheck:X2M,DummyCheck:X2M,Radio:X2M})[r_9];},A._isNumberType=function(h5L){return !!({Int:X2M,Float:X2M,AutoSum:X2M,AutoAvg:X2M})[h5L];},A._makeColumnTag=function(D2F,B7f){return this.MarkupTagSS + D2F + this.MarkupTagSE + B7f + this.MarkupTagES + D2F + this.MarkupTagEE;},A._makeLoadForm=function(p9x,G$Z,U_s,t5Y,h9G,H3i,K74){var S6y="CrossDomain";var W5E="submit";var h5M="LoadExcelSheetID";var q0n='">';var r5r="50";var S9T='" id="';var f1T="-9999";var J0W="100";var v8h="FileExt";var b7o='<iframe name="';var F7c="IBSheetLoadExcelForm";var M9o="IBSheetLoadTextForm";var A7m,l$T=N9A,L3U=N9A,O6f=N9A,Y7w=T9S,o$k=T9S,h2P=this,A3V=N9A,K4Z=N9A,a3e=T9S,a5C=L.BIEA && !L.BIEA11,A6i=T9S;if((h9G=this._getNumberValue(h9G,g1K,X2M),this.Source.LoadExcel && this.Source.LoadText)){if((C0Q == p9x || T_W == p9x?(K4Z=X2M == L.g_isDirectLoadExcel?(A3V=D2H,this.Source.DirectLoadExcel.Url=this._getDefault(this.Source.DirectLoadExcel.Url,D2n),this.Source.DirectLoadExcel.Url):(A3V=w1l,this.Source.LoadExcel.Url=this._getDefault(this.Source.LoadExcel.Url,w$c),this.Source.LoadExcel.Url),l$T=F7c,L3U=I_E,O6f=U0T):k3z == p9x && (L.g_targetTextSheetID=this.id,A3V=b3j,this.Source.LoadText.Url=this._getDefault(this.Source.LoadText.Url,w4_),K4Z=this.Source.LoadText.Url,l$T=M9o,L3U=c9P,O6f=F3l),this._removeForm(l$T),A7m=K4Z,A7m+=(g1K <= K4Z.indexOf(y9e)?M3Y:y9e) + Q46 + A3V,(Y7w=W.createElement(I8E)).method=f3X,Y7w.name=l$T,Y7w.id=l$T,Y7w.encoding=N6F,Y7w.enctype=N6F,Y7w.target=L3U,Y7w.action=A7m,L.BChrome || L.BSafariMac || L.BSafariWin || L.BSafari || L.BOpera || L.BOpera8?(Y7w.style.position=p9I,Y7w.style.left=A2s,Y7w.style.top=A2s,Y7w.style.width=A2s,Y7w.style.height=A2s,Y7w.style.zIndex=f1T):Y7w.style.display=U4D,(o$k=W.createElement(S_$)).type=W5E,Y7w.appendChild(o$k),(o$k=W.createElement(S_$)).type=A1m,o$k.name=k$7,a5C && !H3i && (t5Y=(t5Y=(t5Y+=this._makeColumnTag(S6y,n5R)) + this._makeColumnTag(v8h,U_s)) + this._makeColumnTag(h5M,L.g_LoadExcelSheetID.join(g_q))),o$k.value=t5Y,Y7w.appendChild(o$k),G16 == typeof K74 || s38 == typeof K74 && K74))for(A6i in K74)((o$k=W.createElement(S_$)).type=A1m,o$k.name=A6i,o$k.value=K74[A6i],Y7w.appendChild(o$k));if(!a5C && !H3i){if(((o$k=W.createElement(S_$)).type=d3o,o$k.name=d3o,o$k.id=O6f,o$k.title=O6f,a3e=o$k,U_s)){for(var x2J=(U_s + N9A).split(x2V),T3s=N9A,Q7n=g1K;Q7n < x2J.length;Q7n++)(g1K < Q7n && (T3s+=Q9R),T3s+=c4D + x2J[Q7n].replace(c4D,N9A));o$k.accept=T3s;}(o$k.onchange=function(s74){var s74=s74.target.files[g1K].size,b1j=j$6 * h9G * j$6;if(N9A != this.value)return g1K < b1j && b1j < s74?(h2P.hideMessage(),void h2P.ShowAlert(h2P.getMessage(O2B,i9V).replace(/%d/g,h9G + q$J),u6T)):void h2P._selectFileAction(Y7w,p9x,G$Z,U_s,this.value);},Y7w.appendChild(o$k));}((o$k=L.BIEA && !L.BIEA9?W.createElement(b7o + L3U + S9T + L3U + q0n):W.createElement(n4n)).name=L3U,o$k.id=L3U,o$k.title=L3U,o$k.width=J0W,o$k.height=r5r,Y7w.appendChild(o$k),W.body.appendChild(Y7w),Y7w.style.visibility=A1m,F.frames[L3U].name=L3U,a5C || H3i?Y7w.submit():(a3e.focus(),a3e.click()));}},A._makeLoadXhr=function(K_w,R14,W7t,H87,n1d,b0G,t$j){var w1u="tempFile";var b2U="#tempFile";var v51="text";var p9B,h36=this,z93=N9A,m_$=N9A,L4s=N9A,g95={},R6G=new FormData();if((W7t=this._getNumberValue(W7t,g1K,X2M),this.Source.LoadExcel && this.Source.LoadText)){(C0Q == K_w?L4s=X2M == L.g_isDirectLoadExcel?(z93=D2H,this.Source.DirectLoadExcel.Url=this._getDefault(this.Source.DirectLoadExcel.Url,D2n),m_$=this.Source.DirectLoadExcel.Url,g95={".xls":X2M,".xlsx":X2M},C8M):(z93=w1l,this.Source.LoadExcel.Url=this._getDefault(this.Source.LoadExcel.Url,w$c),m_$=this.Source.LoadExcel.Url,g95={".":X2M,".txt":X2M,".csv":X2M},u_j):k3z == K_w?(L.g_targetTextSheetID=this.id,z93=b3j,this.Source.LoadText.Url=this._getDefault(this.Source.LoadText.Url,w4_),m_$=this.Source.LoadText.Url):T_W == K_w && (g95={".":X2M,".txt":X2M,".csv":X2M,".xls":X2M,".xlsx":X2M},L4s=u_j),actionUrl=m_$,actionUrl+=(g1K <= m_$.indexOf(y9e)?M3Y:y9e) + Q46 + z93,H87 && s38 == typeof H87 && Object.keys(H87).forEach(function(w9v,m5X){R6G.append(w9v,H87[w9v]);}),R6G.append(k$7,R14),W.querySelector(b2U) && W.querySelector(b2U).parentNode.removeChild(W.querySelector(b2U)));m_$=T9S;if(((m_$=W.createElement(S_$)).type=d3o,m_$.id=w1u,m_$.style.display=U4D,n1d)){for(var o2J=(n1d + N9A).split(x2V),N3f=N9A,t_F=g1K;t_F < o2J.length;t_F++)(g1K < t_F && (N3f+=Q9R),N3f+=c4D + o2J[t_F].replace(c4D,N9A));m_$.accept=N3f;}(m_$.onchange=function(X9u){var V54=this.value,x2p=X9u.target.files[g1K].size,P7u=j$6 * W7t * j$6;if(N9A != this.value){if(g1K < P7u && P7u < x2p)return (h36.hideMessage(),void h36.ShowAlert(h36.getMessage(O2B,i9V).replace(/%d/g,W7t + q$J),u6T));if(N9A != n1d)for((g95={},p9B=n1d.split(x2V),t_F=g1K,max=p9B.length);t_F < max;t_F++)g95[c4D + p9B[t_F]]=X2M;if(N9A != V54 && -X2M < V54.indexOf(c4D))if((n1d=V54.substring(V54.lastIndexOf(c4D),V54.length).toLowerCase(),g95[n1d])){(L.OnLoadFileSelect && L.OnLoadFileSelect(h36,K_w,this.value),R6G.append(d3o,X9u.target.files[g1K]));try{n5W.send(R6G);}catch(S_n){}}else h36.ShowAlert(h36.getMessage(L4s,i9V),u6T);}},W.body.appendChild(m_$));var n5W=new XMLHttpRequest();(n5W.open(f3X,actionUrl),b0G && s38 == typeof b0G && Object.keys(b0G).forEach(function(G1n,Z9x){n5W.setRequestHeader(G1n,b0G[G1n]);}),n5W.responseType=v51,n5W.onload=function(i4x){var l4T=20;var R8x="postMessage";var L5H="'";var u2B="n";var R3j="'*');";var j$A=13;var a7v=n5W.response;if(t$j)for(var y8H=g1K;g1K <= y8H;)(B({data:a7v.substring(a7v.indexOf(R8x,y8H) + j$A,a7v.indexOf(R3j,y8H) - e0s).replace(/\\'/g,L5H).replace(/\\n/g,u2B)}),y8H=a7v.indexOf(R3j,y8H) < g1K?-X2M:a7v.indexOf(R3j,y8H) + l4T);else B({data:a7v.substring(a7v.indexOf(R8x) + j$A,a7v.indexOf(R3j) - e0s).replace(/\\'/g,L5H).replace(/\\n/g,u2B)});},m_$.click());}},A._prepareExportSetting=function(){var K4L="";var r_8="";var A8N="";var Q0y="";var l$7="";var w13=".jsp";for(var W1c=N9A,H6G=w13,i29=(this.Source.Export && S$i == typeof this.Source.Export.Url?((W1c=this.Source.Export.Url.split(n5F))[W1c.length - X2M]=N9A,W1c=W1c.join(n5F)):this.Export && S$i == typeof this.Export.Url && ((W1c=this.Export.Url.split(n5F))[W1c.length - X2M]=N9A,W1c=W1c.join(n5F)),this.Source.Export.Ext && (H6G=c4D + this.Source.Export.Ext),[v1Z,w1l,J4s,b3j,H6s,p9d,y6n,D2H]),e2p=g1K;e2p < i29.length;e2p++)(this.Source[i29[e2p]] || (this.Source[i29[e2p]]={}),this.Source.Export[i29[e2p] + v11]?this.Source[i29[e2p]].Url=this.Source.Export[i29[e2p] + v11]:this.Source[i29[e2p]].Url?this.Source[i29[e2p]].Url=this.Source[i29[e2p]].Url:this.Source[i29[e2p]].Url=N9A == W1c?i29[e2p] + H6G:W1c + i29[e2p] + H6G);if((this.ImageList=[],this.Down2ExcelBufferInfo || (this.Down2ExcelBufferInfo={}),this.g_LoadExcelBufferCfg || (this.g_LoadExcelBufferCfg={}),this._eventFunctions={},this.MarkupTagDelimiter?(this.MarkupTagSS=this.MarkupTagDelimiter[g1K],this.MarkupTagSE=this.MarkupTagDelimiter[X2M],this.MarkupTagES=this.MarkupTagDelimiter[s2l],this.MarkupTagEE=this.MarkupTagDelimiter[e0s]):(this.MarkupTagSS=E4o,this.MarkupTagSE=X_b,this.MarkupTagES=O0r,this.MarkupTagEE=X_b),this.IB_DELIMITER_ROW=r_8,this.IB_DELIMITER_COL=A8N,this.IB_DELIMITER_SHEET=y6A,this.IB_DELIMITER_END=l$7,this.IB_DELIMITER_TITLE_NEWLINE=l$7,this.IB_DELIMITER_TITLE_BACKSLASH=A8N,this.IB_DELIMITER_COLOR=Q0y,this.IB_DELIMITER_TREE_INDENT=K4L,this.DataRows=this.MultiRecord && X2M & this.MultiRecordShape?this.MultiRecordMax:X2M,this.SearchSync=g1K,this.MultiRecord && X2M & this.MultiRecordShape)){this._DownMultiMap=[];for(var G0K=g1K;G0K < this.DataRows;G0K++){this._DownMultiMap.push([]);for(var z70=g1K;z70 < this.MultiHeaderMap[g1K].length;z70++)this._DownMultiMap[G0K][z70]=this.MultiHeaderMap[G0K][z70];}for(G0K=g1K;G0K < this.DataRows;G0K++)for(z70=g1K;z70 < this.MultiHeaderMap[g1K].length;z70++)if(this._DownMultiMap[G0K][z70] && X2M < this.Cols[this._DownMultiMap[G0K][z70]].RecordColSpan && X2M < this.Cols[this._DownMultiMap[G0K][z70]].RecordRowSpan)for(var g7$=g1K;g7$ < this.Cols[this._DownMultiMap[G0K][z70]].RecordRowSpan;g7$++){for(var W8g=X2M;W8g < this.Cols[this._DownMultiMap[G0K][z70]].RecordColSpan;W8g++)this._DownMultiMap[G0K + g7$][z70 + W8g]=void g1K;g1K < g7$ && (this._DownMultiMap[G0K + g7$][z70]=void g1K);}else if(this._DownMultiMap[G0K][z70] && X2M < this.Cols[this._DownMultiMap[G0K][z70]].RecordColSpan){for(g7$=X2M;g7$ < this.Cols[this._DownMultiMap[G0K][z70]].RecordColSpan;g7$++)this._DownMultiMap[G0K][z70 + g7$]=void g1K;z70+=this.Cols[this._DownMultiMap[G0K][z70]].RecordColSpan - X2M;}else if(this._DownMultiMap[G0K][z70] && X2M < this.Cols[this._DownMultiMap[G0K][z70]].RecordRowSpan)for(g7$=X2M;g7$ < this.Cols[this._DownMultiMap[G0K][z70]].RecordRowSpan;g7$++)this._DownMultiMap[G0K + g7$][z70]=void g1K;}},A._removeForm=function(q8d){q8d=W.getElementById(q8d);q8d && (q8d.innerHTML=T9S,W.body.removeChild(q8d));},A._removeHTMLTag=function(u49,J_s){if(T9S == u49 || S$i != typeof u49)return N9A;switch(J_s){case X2M:return u49.replace(/<([^>]*)>/gi,N9A);case s2l:return u49.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*[^>]*)?(\s)*(\/)?>/gi,N9A);default:return u49.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*=[^>]*)?(\s)*(\/)?>/gi,N9A);}},A._selectFileAction=function(b5f,F_1,s68,c1c,X8f){var n8t,S5n,X9o=N9A,G8n=N9A,Y4V=g1K,y4o={};if((C0Q == F_1?(y4o={".xls":X2M,".xlsx":X2M},X9o=I_E,G8n=C8M):k3z == F_1?(y4o={".":X2M,".txt":X2M,".csv":X2M},X9o=c9P,G8n=u_j,X8f.indexOf(c4D) < g1K && (X8f+=c4D)):T_W == F_1 && (y4o={".":X2M,".txt":X2M,".csv":X2M,".xls":X2M,".xlsx":X2M},X9o=I_E,G8n=u_j,X8f.indexOf(c4D) < g1K && (X8f+=c4D)),N9A != c1c))for((y4o={},Y4V=g1K,n8t=(S5n=c1c.split(x2V)).length);Y4V < n8t;Y4V++)y4o[c4D + S5n[Y4V]]=X2M;N9A != X8f && (-X2M < X8f.indexOf(c4D) && y4o[c1c=X8f.substring(X8f.lastIndexOf(c4D),X8f.length).toLowerCase()]?(k3z != F_1 && T_W != F_1 || c4D != c1c || (X8f=X8f.substring(g1K,X8f.lastIndexOf(c4D))),b5f.target=X9o,b5f.submit(),L.OnLoadFileSelect && L.OnLoadFileSelect(this,F_1,X8f)):this.ShowAlert(this.getMessage(G8n,i9V),u6T));},A._setRowData=function(K9I,X7F,b7S,k$w,k7S){(K9I[X7F]=k$w,K9I[X7F + W0D]=k7S,K9I[X7F + v9M]=b7S);},A._setRowProperty=function(M6A,T5d,q5K){(M6A.Kind=T5d.Kind,M6A.id=T5d.id,M6A.UnitPos=T5d.UnitPos,M6A.SubSumRow=L7U === T5d.Name,M6A.CumulateRow=T5d.CumulateRow,M6A.RowMerge=T5d.RowMerge,M6A.Status=q5K);},A._trim=function(I4w){return I4w=(I4w+=N9A).replace(Q6a,N9A).replace(g$4,N9A);},A._validInputRow=function(d7m,F7P){var D9G="S";var d4m="P";var E_X="D";var V4F="F";var K29,z5D,d$U=-X2M,o04=g1K,C_I={},M8d={NoDataRow:X2M,GroupRow:X2M,CountRow:X2M,FillRow:X2M,ToolBar:X2M},O1Q=g1K;if(F7P)for((o04=g1K,z5D=(F7P=F7P.split(x2V)).length);o04 < z5D;o04++)switch(F7P[o04]){case m4n:C_I.Header=X2M;break;case E_X:C_I.Data=X2M;break;case V4F:M8d.Filter=X2M;break;case D9G:break;case d4m:O1Q=X2M;}return (T9S != d7m && s38 == typeof d7m && void g1K !== d7m.Kind?K29=d7m:(d7m=this._getNumberValue(d7m),isNaN(d7m) || (K29=this.getRowByIndex(d7m))),K29 && (C_I[(d$U=K29).Kind] && (d$U=-X2M),M8d[K29.id] && (d$U=-X2M),O1Q && Z3$ === K29.id && (d$U=-X2M),O1Q && (L7U === K29.Name || K29.CumulateRow) && (d$U=-X2M)),d$U);},A.Down2Text=function(u9i){var o_H="Down2Text.jsp";var B_M="EUC-KR";var W3p,c1y,g_P,A56=this,u26=L._ibsUtil.cloneArray(u9i),j16=(void g1K === u26 && (u26=[]),this._prepareExportSetting(),!u26 || u26.DebugMode || u26.debugMode || this.showMessage(this.getMessage(E2O)),u9i=this.Down2TextConfig,u26.checkBoxOffValue=this._getDefault(void g1K !== u26.checkBoxOffValue?u26.checkBoxOffValue:u26.CheckBoxOffValue,this._getDefault((u9i=void g1K === u9i?{}:u9i).checkBoxOffValue,p12)),u26.checkBoxOnValue=this._getDefault(void g1K !== u26.checkBoxOnValue?u26.checkBoxOnValue:u26.CheckBoxOnValue,this._getDefault(u9i.checkBoxOnValue,n5R)),u26.debugMode=this._getDefault(void g1K !== u26.debugMode?u26.debugMode:u26.DebugMode,this._getDefault(u9i.debugMode,!X2M)),u26.downCols=this._getDefault(void g1K !== u26.downCols?u26.downCols:u26.DownCols,this._getDefault(u9i.downCols,N9A)),u26.downCombo=this._getDefault(void g1K !== u26.downCombo?u26.downCombo:u26.DownCombo,this._getDefault(u9i.downCombo,o2H)).toUpperCase(),u26.downHeader=this._getDefault(void g1K !== u26.downHeader?u26.downHeader:u26.DownHeader,this._getDefault(u9i.downHeader,!g1K)),u26.downRows=this._getDefault(void g1K !== u26.downRows?u26.downRows:u26.DownRows,this._getDefault(u9i.downRows,N9A)),u26.downSum=this._getDefault(void g1K !== u26.downSum?u26.downSum:u26.DownSum,this._getDefault(u9i.downSum,!g1K)),u26.downTreeHide=this._getDefault(void g1K !== u26.downTreeHide?u26.downTreeHide:u26.DownTreeHide,this._getDefault(u9i.downTreeHide,!!this.ExcelTreeMode)),u26.excludeSubSum=this._getDefault(void g1K !== u26.excludeSubSum?u26.excludeSubSum:u26.ExcludeSubSum,this._getDefault(u9i.excludeSubSum,g1K)),u26.extendParam=this._getDefault(void g1K !== u26.extendParam?u26.extendParam:u26.ExtendParam,this._getDefault(u9i.extendParam,N9A)),u26.extendParamMethod=this._getDefault(void g1K !== u26.extendParamMethod?u26.extendParamMethod:u26.ExtendParamMethod,this._getDefault(u9i.extendParamMethod,N9A)),u26.fileName=this._getDefault(void g1K !== u26.fileName?u26.fileName:u26.FileName,this._getDefault(u9i.fileName,o2H)),u26.RequiredMark=this._getDefault((u26.RequiredMark,u26.RequiredMark),this._getDefault(u9i.RequiredMark,!g1K)),u26.multipart=this._getDefault(void g1K !== u26.multipart?u26.multipart:u26.Multipart,this._getDefault(u9i.multipart,!g1K)),u26.rowDelim=this._getDefault(void g1K !== u26.rowDelim?u26.rowDelim:u26.RowDelim,this._getDefault(u9i.rowDelim,I2q)),u26.sheetName=this._getDefault(void g1K !== u26.sheetName?u26.sheetName:u26.SheetName,this._getDefault(u9i.sheetName,C4c)),u26.colLength=this._getDefault(void g1K !== u26.colLength?u26.colLength:u26.ColLength,this._getDefault(u9i.colLength,N9A)),u26.colLength2Byte=this._getDefault(void g1K !== u26.colLength2Byte?u26.colLength2Byte:u26.ColLength2Byte,this._getDefault(u9i.colLength2Byte,!g1K)),u26.emptyChar=this._getDefault(void g1K !== u26.emptyChar?u26.emptyChar:u26.EmptyChar,this._getDefault(u9i.emptyChar,l7A)),u26.fillRight=this._getDefault(void g1K !== u26.fillRight?u26.fillRight:u26.FillRight,this._getDefault(u9i.fillRight,!g1K)),u26.cutText=this._getDefault(void g1K !== u26.cutText?u26.cutText:u26.CutText,this._getDefault(u9i.cutText,!X2M)),u26.timeout=this._getDefault(void g1K !== u26.timeout?u26.timeout:u26.Timeout,this._getDefault(u9i.timeout,g1K)),u26.useXhr=this._getDefault((u26.useXhr,u26.useXhr),this._getDefault(u9i.useXhr,!X2M)),u26.reqHeader=u26.reqHeader || u9i.reqHeader,u26.sendParam=u26.sendParam || u9i.sendParam,u26.fileName.toLowerCase().split(c4D,-X2M));if((C65 == j16[j16.length - X2M]?(u26.colDelim=this._getDefault(void g1K !== u26.colDelim?u26.colDelim:u26.ColDelim,this._getDefault(u9i.colDelim,B4i)),u26.downloadEncoding=this._getDefault(void g1K !== u26.downloadEncoding?u26.downloadEncoding:u26.DownloadEncoding,this._getDefault(u9i.downloadEncoding,B_M))):(u26.colDelim=this._getDefault(void g1K !== u26.colDelim?u26.colDelim:u26.ColDelim,this._getDefault(u9i.colDelim,Q6G)),u26.downloadEncoding=this._getDefault(void g1K !== u26.downloadEncoding?u26.downloadEncoding:u26.DownloadEncoding,this._getDefault(u9i.downloadEncoding,N9A))),this._autoExcelModeCheck(u26,this.AutoExcelMode,k3z,!g1K,!X2M)))return (N9A != u26.downRows && u26.downTreeHide && (u26.downTreeHide=g1K),u26.downRows=x2V + u26.downRows + x2V,m51 != (j16=u26.downCols) && (x2V == (j16=x2V == j16.substring(g1K,X2M)?j16.substring(X2M):j16).substring(j16.length - X2M) && (j16=j16.substring(g1K,j16.length - X2M)),u26.downCols=j16),N9A != (u9i=u26.colLength) && m51 != u9i && (x2V == (u9i=x2V == u9i.substring(g1K,X2M)?u9i.substring(X2M):u9i).substring(u9i.length - X2M) && (u9i=u9i.substring(g1K,u9i.length - X2M)),u26.colLength=u9i),void g1K !== this.Source.Down2Text.Url && N9A != this.Source.Down2Text.Url || (this.Source.Down2Text.Url=o_H),W3p=this.Source.Down2Text.Url,c1y=u26.extendParam,g_P=u26.extendParamMethod,this._getDown2Text(u26,function(D6G){A56._sendDown(D6G,W3p,c1y,g_P,u26.multipart,k3z,u26.debugMode,u26.timeout,u26.useXhr,L._ibsUtil.getFileName(u26.fileName,t7X),u26.sendParam,u26.reqHeader);}));setTimeout(function(){A56.hideMessage();},q$Y);},A.GetDown2TextConfig=function(){return this.Down2TextConfig;},A.GetDown2TextUrl=function(){var E$q=N9A;return E$q=this.Source.Down2Text.Url?this.Source.Down2Text.Url:E$q;},A.GetLoadTextConfig=function(){return this.LoadTextConfig || ({});},A.GetLoadTextUrl=function(){var Q_l=N9A;return Q_l=this.Source.LoadText.Url?this.Source.LoadText.Url:Q_l;},A.LoadText=function(k_q){(this.HasLoadedExcelData && delete this.HasLoadedExcelData,this.LoadFileType=k3z);var E0k,J41,P$D,O5f,k_q=L._ibsUtil.cloneArray(k_q),X6O={},s5r=N9A,Y_O=[],X6O=(void g1K === k_q && (k_q=[]),void g1K !== this.LoadTextConfig && (X6O=this.LoadTextConfig),this._prepareExportSetting(),k_q.append=this._getDefault(void g1K !== k_q.append?k_q.append:k_q.Append,this._getDefault(X6O.append,!X2M)),k_q.fileExt=this._getDefault(void g1K !== k_q.fileExt?k_q.fileExt:k_q.FileExt,this._getDefault(X6O.fileExt,N9A)),k_q.maxFileSize=this._getDefault(void g1K !== k_q.maxFileSize?k_q.maxFileSize:k_q.MaxFileSize,this._getDefault(X6O.maxFileSize,g1K,i8B)),k_q.mode=this._getDefault(void g1K !== k_q.mode?k_q.mode:k_q.Mode,this._getDefault(X6O.mode,B$k)),k_q.encoding=this._getDefault(void g1K !== k_q.encoding?k_q.encoding:k_q.Encoding,this._getDefault(X6O.encoding,N9A)),k_q.deli=this._getDefault(void g1K !== k_q.deli?k_q.deli:k_q.Deli,this._getDefault(X6O.deli,Q6G)),k_q.colSeparator=this._getDefault(void g1K !== k_q.colSeparator?k_q.colSeparator:k_q.ColSeparator,this._getDefault(X6O.colSeparator,Q6G)),Q6G !== k_q.colSeparator && k_q.colSeparator !== k_q.deli && (k_q.deli=k_q.colSeparator),k_q.colLength=this._getDefault(void g1K !== k_q.colLength?k_q.colLength:k_q.ColLength,this._getDefault(X6O.colLength,N9A)),k_q.colLength2Byte=this._getDefault(void g1K !== k_q.colLength2Byte?k_q.colLength2Byte:k_q.ColLength2Byte,this._getDefault(X6O.colLength2Byte,!g1K)),k_q.emptyChar=this._getDefault(void g1K !== k_q.emptyChar?k_q.emptyChar:k_q.EmptyChar,this._getDefault(X6O.emptyChar,l7A)),k_q.fillRight=this._getDefault(void g1K !== k_q.fillRight?k_q.fillRight:k_q.FillRight,this._getDefault(X6O.fillRight,!g1K)),k_q.hideSeq=M3J == typeof k_q.hideSeq && g1K <= k_q.hideSeq && k_q.hideSeq <= s2l?k_q.hideSeq:s2l,k_q.useXhr=this._getDefault((k_q.useXhr,k_q.useXhr),this._getDefault(X6O.useXhr,!X2M)),k_q.reqHeader=k_q.reqHeader || X6O.reqHeader,k_q.sendParam=k_q.sendParam || X6O.sendParam,k_q.colLength);(N9A != X6O && m51 != X6O && (x2V == (X6O=x2V == X6O.substring(g1K,X2M)?X6O.substring(X2M):X6O).substring(X6O.length - X2M) && (X6O=X6O.substring(g1K,X6O.length - X2M)),k_q.colLength=X6O),void g1K !== k_q.DialogType && (k_q.dialogType=k_q.DialogType),this._uploadDialogDelim=k_q.deli,this._uploadDialogLoadType=k_q.dialogType,this._autoExcelModeCheck(k_q,this.AutoExcelMode,k3z,!X2M,!X2M) && (this.GetLoadColNames(Y_O,k_q),X6O=this._getHeaderText(Y_O),E0k=(Y_O=this._getColInfo(k_q,Y_O,!X2M)).name,Y_O.saveName,J41=Y_O.type,P$D=Y_O.format,O5f=Y_O.datePattern,dataFormat=Y_O.dataFormat,s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r=(s5r+=this._makeColumnTag(Y6D,k_q.DateStrictMode?X2M:g1K)) + this._makeColumnTag(i1J,k_q.mode.replace(/ /g,N9A).toUpperCase())) + this._makeColumnTag(L0K,k_q.deli)) + this._makeColumnTag(l7i,k_q.append?X2M:g1K)) + this._makeColumnTag(k12,this.SearchMode)) + this._makeColumnTag(J9T,k_q.extendParam)) + this._makeColumnTag(W2f,this.ColCount)) + this._makeColumnTag(n1q,dataFormat)) + this._makeColumnTag(o_F,this.getHeaderRows().length)) + this._makeColumnTag(A7c,void g1K !== this.StatusCol?this.StatusCol:N9A)) + this._makeColumnTag(X2L,E0k)) + this._makeColumnTag(M12,X6O)) + this._makeColumnTag(O1U,E0k)) + this._makeColumnTag(B5m,J41)) + this._makeColumnTag(N8F,P$D)) + this._makeColumnTag(H8v,O5f)) + this._makeColumnTag(W_e,k_q.encoding)) + this._makeColumnTag(H98,k_q.colLength)) + this._makeColumnTag(b50,k_q.colLength2Byte?X2M:g1K)) + this._makeColumnTag(h3t,k_q.emptyChar)) + this._makeColumnTag(B5N,k_q.fillRight?X2M:g1K),G16 != typeof F.postMessage && s38 != typeof F.postMessage || (s5r+=this._makeColumnTag(P_a,this.id)),k_q.useXhr || k_q.reqHeader && s38 == typeof k_q.reqHeader?this._makeLoadXhr(k3z,s5r,k_q.maxFileSize,k_q.sendParam,k_q.fileExt,k_q.reqHeader):this._makeLoadForm(k3z,!X2M,k_q.fileExt,s5r,k_q.maxFileSize,k_q.serverFile,k_q.sendParam)));},A.SetDown2TextConfig=function(x7q){(this.Down2TextConfig=L._ibsUtil.cloneArray(x7q),void g1K !== this.Down2TextConfig.downHeader && (n5R === this.Down2TextConfig.downHeader?this.Down2TextConfig.downHeader=!g1K:p12 === this.Down2TextConfig.downHeader && (this.Down2TextConfig.downHeader=!X2M)),void g1K !== this.Down2TextConfig.downSum && (n5R === this.Down2TextConfig.downSum?this.Down2TextConfig.downSum=!g1K:p12 === this.Down2TextConfig.downSum && (this.Down2TextConfig.downSum=!X2M)),void g1K !== this.Down2TextConfig.downTreeHide && (n5R === this.Down2TextConfig.downTreeHide?this.Down2TextConfig.downTreeHide=!g1K:p12 === this.Down2TextConfig.downTreeHide && (this.Down2TextConfig.downTreeHide=!X2M)),void g1K !== this.Down2TextConfig.RequiredMark && (n5R === this.Down2TextConfig.RequiredMark?this.Down2TextConfig.RequiredMark=!g1K:p12 === this.Down2TextConfig.RequiredMark && (this.Down2TextConfig.RequiredMark=!X2M)),void g1K !== this.Down2TextConfig.multipart && (n5R === this.Down2TextConfig.multipart?this.Down2TextConfig.multipart=!g1K:p12 === this.Down2TextConfig.multipart && (this.Down2TextConfig.multipart=!X2M)));},A.SetDown2TextUrl=function(y8C){(this.Source.Down2Text || (this.Source.Down2Text={}),this.Source.Down2Text.Url=y8C);},A.SetLoadTextConfig=function(i9m){(this.LoadTextConfig=L._ibsUtil.cloneArray(i9m),void g1K !== this.LoadTextConfig.append && (n5R === this.LoadTextConfig.append?this.LoadTextConfig.append=!g1K:p12 === this.LoadTextConfig.append && (this.LoadTextConfig.append=!X2M)));},A.SetLoadTextUrl=function(h9U){(this.Source.LoadText || (this.Source.LoadText={}),this.Source.LoadText.Url=h9U);},A._exportCsv=function(K$B,f_m,b$m,F5G,a5j,n5X,J7F){for(var s4Q,P4f,R9v=[],V6X=T9S,E8x=g1K,V$Y=[],W6b=N9A,I0e=X2M < this.DataRows,V6X=this.getFirstRow(T9S,y3x);V6X;V6X=this.getNextRow(V6X))if(!V6X || Z3$ !== V6X.id && L7U !== V6X.Name && m5p !== V6X.Name){for((E8x=g1K,s4Q=K$B.length);E8x < s4Q;E8x++)if((P4f=K$B[E8x],!I0e || V6X.UnitPos == P4f.UnitPos)){if((W6b=X2M == a5j && void g1K === P4f.Name?N9A:f_m?this._getCellText(V6X,P4f.Name):this._getCellValue(V6X,P4f.Name),P4f.Name === J7F && X2M != W6b))break;(void g1K !== n5X && (W6b=W6b.replace(/\r\n/g,n5X).replace(/\n/g,n5X)),V$Y.push(W6b));}I0e && V6X.UnitPos != this.DataRows - X2M || g1K < V$Y.length && (R9v.push(V$Y.join(b$m)),V$Y=[]);}return R9v=R9v.join(F5G);},A._getDown2Text=function(U$O,u2Y){var t1r="DownloadEncoding";var V8q="RowDelim";var k$p="ColDelim";var o$l,B0S,s6Y=[],D4l=this,j5g=N9A,K$o=m51 != U$O.downRows,w0a=[],U7C=(w0a=this.MultiRecord && X2M & this.MultiRecordShape?this._DownMultiMap[g1K]:this._getDownColNames(U$O)).length;return g1K == U7C?(this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,k3z,!X2M),-X2M):(K$o={from:k3z,cfg:U$O,sheetDesign:!X2M,isTreeLevel:g1K,isDownRows:K$o,isDownRowVisible:g1K,rowHeights:[],downColNames:w0a,downColNamesLength:U7C,data:s6Y,p:X2M,headerRows:g1K,isHeaderMerge:g1K},U$O.downHeader && (B0S=this._getHeaderData(K$o),K$o.p=B0S.p),X2M != L.g_isDirectDown2Excel && (B0S=this._getBodyData(K$o)).p,this.fileDownloadCheckToken=new Date().getTime(),L.fileDownloadCheckTimer=F.setInterval(function(){D4l._getCookie(m_z) == D4l.fileDownloadCheckToken && (D4l.fileDownloadCheckToken=T9S,D4l._finishDownload(k3z));},H08),j5g+=this._makeColumnTag(O_p,this.fileDownloadCheckToken),K$o=(U7C=this._getColInfo(U$O,w0a,g1K)).saveName,B0S=U7C.type,w0a=U7C.format,U7C=U7C.orgFormat,(o$l=location.href.substring(location.href.indexOf(N7A) + s2l).split(n5F))[g1K]=N9A,o$l[o$l.length - X2M]=N9A,j5g=(j5g=(j5g=(j5g=(j5g=(j5g=(j5g=(j5g=(j5g=(j5g=(j5g=(j5g=(j5g=(j5g=(j5g=(j5g=(j5g+=this._makeColumnTag(Q_u,o$l.join(n5F))) + this._makeColumnTag(d6w,L._ibsUtil.getFileName(U$O.fileName,t7X))) + this._makeColumnTag(V8q,U$O.rowDelim)) + this._makeColumnTag(k$p,U$O.colDelim)) + this._makeColumnTag(J9T,U$O.extendParam)) + this._makeColumnTag(X2L,K$o)) + this._makeColumnTag(k9f,B0S)) + this._makeColumnTag(j_h,w0a)) + this._makeColumnTag(z8c,U7C)) + this._makeColumnTag(O7H,U$O.downHeader?X2M:g1K)) + this._makeColumnTag(H98,U$O.colLength)) + this._makeColumnTag(b50,U$O.colLength2Byte?X2M:g1K)) + this._makeColumnTag(h3t,U$O.emptyChar)) + this._makeColumnTag(B5N,U$O.fillRight?X2M:g1K)) + this._makeColumnTag(r4q,U$O.cutText?X2M:g1K)) + this._makeColumnTag(t1r,U$O.downloadEncoding)) + this.IB_DELIMITER_ROW,s6Y[g1K]=j5g,U$O.debugMode?(this.hideMessage(),s6Y.join(N9A)):void (u2Y && u2Y(s6Y.join(N9A))));},M=A,(g1K,L.__.each)([{from:g7w,to:W_8},{from:T6f,to:L2s},{from:K9q,to:U_v},{from:J4P,to:p7C},{from:W8l,to:T85},{from:j9M,to:K2V},{from:W4i,to:X1O},{from:v8v,to:p_y},{from:J1T,to:b_q},{from:E0d,to:d9h},{from:v8G,to:i4N},{from:d_k,to:X0J},{from:S0H,to:S1L},{from:F0U,to:l6e},{from:d9K,to:X4q},{from:p0I,to:z6O},{from:u8D,to:u$L},{from:y6n,to:d3h},{from:v1Z,to:b2Z},{from:D2H,to:a2W},{from:u5Y,to:T83},{from:w1l,to:H8X},{from:J4s,to:e4z},{from:b3j,to:h_0},{from:R9M,to:C2Q},{from:H6s,to:S_A},{from:p9d,to:t1v},{from:i42,to:G41},{from:a1N,to:A9f},{from:Y94,to:o_5},{from:f$d,to:F_s},{from:p2C,to:G2Y},{from:l39,to:C7$},{from:s2_,to:x9t},{from:j7Q,to:R3U},{from:B_b,to:j9F},{from:J2s,to:D5v},{from:Y3Y,to:R2U},{from:Q7S,to:z8G},{from:T5k,to:F$s},{from:E$J,to:o44},{from:M4P,to:h5Q},{from:S2y,to:E74},{from:D7L,to:S9y},{from:f51,to:b$n},{from:G8D,to:S_V},{from:W7F,to:M$c},{from:b6K,to:Q3V}],function(Z8s){M[Z8s.to]=M[Z8s.from];}));})(window,document);